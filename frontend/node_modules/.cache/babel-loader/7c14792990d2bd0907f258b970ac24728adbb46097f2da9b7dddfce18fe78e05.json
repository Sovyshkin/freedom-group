{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport { useAuthStore } from '@/stores/auth.js';\n\n// Импорт страниц\nimport LoginPage from '@/views/auth/LoginPage.vue';\nimport EmailVerify from '@/views/auth/EmailVerify.vue';\nimport PartnerDashboard from '@/views/PartnerDashboard.vue';\nimport AdminDashboard from '@/views/AdminDashboard.vue';\nimport AccessDenied from '@/views/AccessDenied.vue';\nconst routes = [{\n  path: '/login',\n  name: 'login',\n  component: LoginPage,\n  meta: {\n    requiresAuth: false\n  }\n}, {\n  path: '/email-verify',\n  name: 'email_verify',\n  component: EmailVerify,\n  meta: {\n    requiresAuth: false\n  }\n}, {\n  path: '/partner',\n  name: 'partner',\n  component: PartnerDashboard,\n  meta: {\n    requiresAuth: true,\n    roles: ['partner']\n  }\n}, {\n  path: '/admin',\n  name: 'admin',\n  component: AdminDashboard,\n  meta: {\n    requiresAuth: true,\n    roles: ['admin']\n  }\n}, {\n  path: '/access-denied',\n  name: 'access-denied',\n  component: AccessDenied,\n  meta: {\n    requiresAuth: false\n  }\n}, {\n  path: '/',\n  redirect: '/partner'\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\n\n// Защита маршрутов\nrouter.beforeEach(async (to, from, next) => {\n  const authStore = useAuthStore();\n\n  // Если маршрут не требует авторизации\n  if (!to.meta.requiresAuth) {\n    return next();\n  }\n\n  // Проверяем авторизацию\n  if (!authStore.isAuthenticated) {\n    // Сохраняем URL для возврата после логина\n    localStorage.setItem('returnUrl', to.fullPath);\n    return next({\n      name: 'login'\n    });\n  }\n\n  // Проверяем роли если они указаны\n  if (to.meta.roles && to.meta.roles.length > 0) {\n    if (!authStore.user || !to.meta.roles.includes(authStore.user.role)) {\n      return next('/access-denied');\n    }\n  }\n  next();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","useAuthStore","LoginPage","EmailVerify","PartnerDashboard","AdminDashboard","AccessDenied","routes","path","name","component","meta","requiresAuth","roles","redirect","router","history","beforeEach","to","from","next","authStore","isAuthenticated","localStorage","setItem","fullPath","length","user","includes","role"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/router/router.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router';\nimport { useAuthStore } from '@/stores/auth.js';\n\n// Импорт страниц\nimport LoginPage from '@/views/auth/LoginPage.vue'\nimport EmailVerify from '@/views/auth/EmailVerify.vue'\nimport PartnerDashboard from '@/views/PartnerDashboard.vue'\nimport AdminDashboard from '@/views/AdminDashboard.vue'\nimport AccessDenied from '@/views/AccessDenied.vue'\n\nconst routes = [\n  {\n    path: '/login',\n    name: 'login',\n    component: LoginPage,\n    meta: { requiresAuth: false }\n  },\n  {\n    path: '/email-verify',\n    name: 'email_verify',\n    component: EmailVerify,\n    meta: { requiresAuth: false }\n  },\n  {\n    path: '/partner',\n    name: 'partner',\n    component: PartnerDashboard,\n    meta: { requiresAuth: true, roles: ['partner'] }\n  },\n  {\n    path: '/admin',\n    name: 'admin', \n    component: AdminDashboard,\n    meta: { requiresAuth: true, roles: ['admin'] }\n  },\n  {\n    path: '/access-denied',\n    name: 'access-denied',\n    component: AccessDenied,\n    meta: { requiresAuth: false }\n  },\n  {\n    path: '/',\n    redirect: '/partner'\n  }\n];\n\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\n\n// Защита маршрутов\nrouter.beforeEach(async (to, from, next) => {\n  const authStore = useAuthStore();\n  \n  // Если маршрут не требует авторизации\n  if (!to.meta.requiresAuth) {\n    return next();\n  }\n  \n  // Проверяем авторизацию\n  if (!authStore.isAuthenticated) {\n    // Сохраняем URL для возврата после логина\n    localStorage.setItem('returnUrl', to.fullPath);\n    return next({ name: 'login' });\n  }\n  \n  // Проверяем роли если они указаны\n  if (to.meta.roles && to.meta.roles.length > 0) {\n    if (!authStore.user || !to.meta.roles.includes(authStore.user.role)) {\n      return next('/access-denied');\n    }\n  }\n\n  next();\n});\n\nexport default router;"],"mappings":"AAAA,SAASA,YAAY,EAAEC,gBAAgB,QAAQ,YAAY;AAC3D,SAASC,YAAY,QAAQ,kBAAkB;;AAE/C;AACA,OAAOC,SAAS,MAAM,4BAA4B;AAClD,OAAOC,WAAW,MAAM,8BAA8B;AACtD,OAAOC,gBAAgB,MAAM,8BAA8B;AAC3D,OAAOC,cAAc,MAAM,4BAA4B;AACvD,OAAOC,YAAY,MAAM,0BAA0B;AAEnD,MAAMC,MAAM,GAAG,CACb;EACEC,IAAI,EAAE,QAAQ;EACdC,IAAI,EAAE,OAAO;EACbC,SAAS,EAAER,SAAS;EACpBS,IAAI,EAAE;IAAEC,YAAY,EAAE;EAAM;AAC9B,CAAC,EACD;EACEJ,IAAI,EAAE,eAAe;EACrBC,IAAI,EAAE,cAAc;EACpBC,SAAS,EAAEP,WAAW;EACtBQ,IAAI,EAAE;IAAEC,YAAY,EAAE;EAAM;AAC9B,CAAC,EACD;EACEJ,IAAI,EAAE,UAAU;EAChBC,IAAI,EAAE,SAAS;EACfC,SAAS,EAAEN,gBAAgB;EAC3BO,IAAI,EAAE;IAAEC,YAAY,EAAE,IAAI;IAAEC,KAAK,EAAE,CAAC,SAAS;EAAE;AACjD,CAAC,EACD;EACEL,IAAI,EAAE,QAAQ;EACdC,IAAI,EAAE,OAAO;EACbC,SAAS,EAAEL,cAAc;EACzBM,IAAI,EAAE;IAAEC,YAAY,EAAE,IAAI;IAAEC,KAAK,EAAE,CAAC,OAAO;EAAE;AAC/C,CAAC,EACD;EACEL,IAAI,EAAE,gBAAgB;EACtBC,IAAI,EAAE,eAAe;EACrBC,SAAS,EAAEJ,YAAY;EACvBK,IAAI,EAAE;IAAEC,YAAY,EAAE;EAAM;AAC9B,CAAC,EACD;EACEJ,IAAI,EAAE,GAAG;EACTM,QAAQ,EAAE;AACZ,CAAC,CACF;AAED,MAAMC,MAAM,GAAGhB,YAAY,CAAC;EAC1BiB,OAAO,EAAEhB,gBAAgB,CAAC,CAAC;EAC3BO;AACF,CAAC,CAAC;;AAEF;AACAQ,MAAM,CAACE,UAAU,CAAC,OAAOC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EAC1C,MAAMC,SAAS,GAAGpB,YAAY,CAAC,CAAC;;EAEhC;EACA,IAAI,CAACiB,EAAE,CAACP,IAAI,CAACC,YAAY,EAAE;IACzB,OAAOQ,IAAI,CAAC,CAAC;EACf;;EAEA;EACA,IAAI,CAACC,SAAS,CAACC,eAAe,EAAE;IAC9B;IACAC,YAAY,CAACC,OAAO,CAAC,WAAW,EAAEN,EAAE,CAACO,QAAQ,CAAC;IAC9C,OAAOL,IAAI,CAAC;MAAEX,IAAI,EAAE;IAAQ,CAAC,CAAC;EAChC;;EAEA;EACA,IAAIS,EAAE,CAACP,IAAI,CAACE,KAAK,IAAIK,EAAE,CAACP,IAAI,CAACE,KAAK,CAACa,MAAM,GAAG,CAAC,EAAE;IAC7C,IAAI,CAACL,SAAS,CAACM,IAAI,IAAI,CAACT,EAAE,CAACP,IAAI,CAACE,KAAK,CAACe,QAAQ,CAACP,SAAS,CAACM,IAAI,CAACE,IAAI,CAAC,EAAE;MACnE,OAAOT,IAAI,CAAC,gBAAgB,CAAC;IAC/B;EACF;EAEAA,IAAI,CAAC,CAAC;AACR,CAAC,CAAC;AAEF,eAAeL,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}