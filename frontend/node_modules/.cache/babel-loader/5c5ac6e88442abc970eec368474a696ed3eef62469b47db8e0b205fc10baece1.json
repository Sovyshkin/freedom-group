{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport AppNotifications from '@/components/AppNotifications.vue';\nimport { useAuthStore } from '@/stores/auth';\nimport { useNotificationStore } from '@/stores/notifications';\nexport default {\n  __name: 'LoginPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const authStore = useAuthStore();\n    const notificationStore = useNotificationStore();\n\n    // Reactive data\n    const loading = ref(false);\n    const showPassword = ref(false);\n    const loginType = ref('partner'); // 'partner' or 'admin'\n\n    const formData = reactive({\n      login: '',\n      password: ''\n    });\n    const errors = ref({});\n\n    // Methods\n    const validateForm = () => {\n      errors.value = {};\n      const trimmedLogin = formData.login.trim();\n      const trimmedPassword = formData.password.trim();\n      if (!trimmedLogin) {\n        errors.value.login = loginType.value === 'admin' ? 'Имя пользователя обязательно' : 'Логин или email обязателен';\n      }\n      if (!trimmedPassword) {\n        errors.value.password = 'Пароль обязателен';\n      }\n      return Object.keys(errors.value).length === 0;\n    };\n    const login = async () => {\n      if (!validateForm()) return;\n      loading.value = true;\n      try {\n        const endpoint = loginType.value === 'admin' ? '/auth/admin/login' : '/auth/login';\n        const loginData = loginType.value === 'admin' ? {\n          username: formData.login.trim(),\n          password: formData.password.trim()\n        } : {\n          login: formData.login.trim(),\n          password: formData.password.trim()\n        };\n        await authStore.login(endpoint, loginData);\n\n        // Redirect based on user role\n        if (authStore.user.role === 'admin') {\n          router.push('/admin');\n        } else {\n          router.push('/dashboard');\n        }\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Успешный вход в систему!'\n        });\n      } catch (error) {\n        console.error('Ошибка входа:', error);\n        let errorMessage = 'Ошибка входа в систему';\n        if (error.response?.status === 401) {\n          errorMessage = 'Неверные учетные данные';\n        } else if (error.response?.status === 403) {\n          errorMessage = error.response.data?.message || 'Доступ запрещен';\n        } else if (error.response?.status === 429) {\n          errorMessage = error.response.data?.message || 'Слишком много попыток входа';\n        } else if (error.response?.data?.message) {\n          errorMessage = error.response.data.message;\n        }\n        notificationStore.addNotification({\n          type: 'error',\n          message: errorMessage\n        });\n      } finally {\n        loading.value = false;\n      }\n    };\n    const __returned__ = {\n      router,\n      authStore,\n      notificationStore,\n      loading,\n      showPassword,\n      loginType,\n      formData,\n      errors,\n      validateForm,\n      login,\n      ref,\n      reactive,\n      get useRouter() {\n        return useRouter;\n      },\n      AppNotifications,\n      get useAuthStore() {\n        return useAuthStore;\n      },\n      get useNotificationStore() {\n        return useNotificationStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","useRouter","AppNotifications","useAuthStore","useNotificationStore","router","authStore","notificationStore","loading","showPassword","loginType","formData","login","password","errors","validateForm","value","trimmedLogin","trim","trimmedPassword","Object","keys","length","endpoint","loginData","username","user","role","push","addNotification","type","message","error","console","errorMessage","response","status","data"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/views/auth/LoginPage.vue"],"sourcesContent":["<template>\n  <div class=\"login-page\">\n    <div class=\"container\">\n      <div class=\"login-card\">\n        <div class=\"brand\">\n          <h1>FREEDOM GROUP</h1>\n          <p>Партнерская система</p>\n        </div>\n        \n        <form @submit.prevent=\"login\" class=\"login-form\">\n          <!-- Role selection -->\n          <div class=\"role-selector\">\n            <button \n              type=\"button\"\n              @click=\"loginType = 'partner'\"\n              :class=\"['role-option', { active: loginType === 'partner' }]\"\n            >\n              Партнер\n            </button>\n            <button \n              type=\"button\"\n              @click=\"loginType = 'admin'\"\n              :class=\"['role-option', { active: loginType === 'admin' }]\"\n            >\n              Администратор\n            </button>\n          </div>\n          \n          <div class=\"input-group\">\n            <input\n              v-model=\"formData.login\"\n              type=\"text\"\n              required\n              :placeholder=\"loginType === 'admin' ? 'Имя пользователя' : 'Логин или email'\"\n              :class=\"{ error: errors.login }\"\n              class=\"input-field\"\n            />\n            <div v-if=\"errors.login\" class=\"error-text\">{{ errors.login }}</div>\n          </div>\n          \n          <div class=\"input-group\">\n            <div class=\"password-field\">\n              <input\n                v-model=\"formData.password\"\n                :type=\"showPassword ? 'text' : 'password'\"\n                required\n                placeholder=\"Пароль\"\n                :class=\"{ error: errors.password }\"\n                class=\"input-field\"\n              />\n              <button \n                type=\"button\" \n                @click=\"showPassword = !showPassword\"\n                class=\"password-toggle\"\n              >\n                <svg v-if=\"showPassword\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24\"></path>\n                  <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\"></line>\n                </svg>\n                <svg v-else width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\"></path>\n                  <circle cx=\"12\" cy=\"12\" r=\"3\"></circle>\n                </svg>\n              </button>\n            </div>\n            <div v-if=\"errors.password\" class=\"error-text\">{{ errors.password }}</div>\n          </div>\n          \n          <button \n            type=\"submit\" \n            :disabled=\"loading\"\n            class=\"login-btn\"\n          >\n            <span v-if=\"loading\" class=\"loader\"></span>\n            {{ loading ? 'Вход...' : 'Войти' }}\n          </button>\n          \n          <div v-if=\"loginType === 'partner'\" class=\"forgot-link\">\n            <router-link to=\"/forgot-password\">Забыли пароль?</router-link>\n          </div>\n        </form>\n      </div>\n    </div>\n    \n    <AppNotifications />\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport AppNotifications from '@/components/AppNotifications.vue'\nimport { useAuthStore } from '@/stores/auth'\nimport { useNotificationStore } from '@/stores/notifications'\n\nconst router = useRouter()\nconst authStore = useAuthStore()\nconst notificationStore = useNotificationStore()\n\n// Reactive data\nconst loading = ref(false)\nconst showPassword = ref(false)\nconst loginType = ref('partner') // 'partner' or 'admin'\n\nconst formData = reactive({\n  login: '',\n  password: ''\n})\n\nconst errors = ref({})\n\n// Methods\nconst validateForm = () => {\n  errors.value = {}\n  \n  const trimmedLogin = formData.login.trim()\n  const trimmedPassword = formData.password.trim()\n  \n  if (!trimmedLogin) {\n    errors.value.login = loginType.value === 'admin' ? 'Имя пользователя обязательно' : 'Логин или email обязателен'\n  }\n  \n  if (!trimmedPassword) {\n    errors.value.password = 'Пароль обязателен'\n  }\n  \n  return Object.keys(errors.value).length === 0\n}\n\nconst login = async () => {\n  if (!validateForm()) return\n  \n  loading.value = true\n  \n  try {\n    const endpoint = loginType.value === 'admin' ? '/auth/admin/login' : '/auth/login'\n    const loginData = loginType.value === 'admin' \n      ? { username: formData.login.trim(), password: formData.password.trim() }\n      : { login: formData.login.trim(), password: formData.password.trim() }\n    \n    await authStore.login(endpoint, loginData)\n    \n    // Redirect based on user role\n    if (authStore.user.role === 'admin') {\n      router.push('/admin')\n    } else {\n      router.push('/dashboard')\n    }\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Успешный вход в систему!'\n    })\n    \n  } catch (error) {\n    console.error('Ошибка входа:', error)\n    \n    let errorMessage = 'Ошибка входа в систему'\n    \n    if (error.response?.status === 401) {\n      errorMessage = 'Неверные учетные данные'\n    } else if (error.response?.status === 403) {\n      errorMessage = error.response.data?.message || 'Доступ запрещен'\n    } else if (error.response?.status === 429) {\n      errorMessage = error.response.data?.message || 'Слишком много попыток входа'\n    } else if (error.response?.data?.message) {\n      errorMessage = error.response.data.message\n    }\n    \n    notificationStore.addNotification({\n      type: 'error',\n      message: errorMessage\n    })\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n<style scoped>\n.login-page {\n  min-height: 100vh;\n  background: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  font-family: 'Inter', sans-serif;\n}\n\n.container {\n  width: 100%;\n  max-width: 400px;\n}\n\n.login-card {\n  background: white;\n  border-radius: 16px;\n  border: 1px solid #f1f3f4;\n  overflow: hidden;\n  animation: fadeIn 0.6s ease-out;\n  box-shadow: \n    0 25px 50px rgba(0, 0, 0, 0.1),\n    0 15px 35px rgba(0, 0, 0, 0.05),\n    0 5px 15px rgba(0, 0, 0, 0.02);\n  transform: translateY(-5px);\n  transition: all 0.3s ease;\n}\n\n.login-card:hover {\n  transform: translateY(-10px);\n  box-shadow: \n    0 35px 60px rgba(0, 0, 0, 0.15),\n    0 20px 40px rgba(0, 0, 0, 0.1),\n    0 10px 20px rgba(0, 0, 0, 0.05);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.brand {\n  text-align: center;\n  padding: 48px 32px 32px;\n  border-bottom: 1px solid #f1f3f4;\n}\n\n.brand h1 {\n  margin: 0 0 8px;\n  font-size: 24px;\n  font-weight: 600;\n  color: #1a1a1a;\n  letter-spacing: -0.02em;\n}\n\n.brand p {\n  margin: 0;\n  color: #6b7280;\n  font-size: 14px;\n  font-weight: 400;\n}\n\n.login-form {\n  padding: 32px;\n}\n\n.role-selector {\n  display: flex;\n  background: #f9fafb;\n  border-radius: 12px;\n  padding: 4px;\n  margin-bottom: 24px;\n  border: 1px solid #f3f4f6;\n}\n\n.role-option {\n  flex: 1;\n  padding: 12px 16px;\n  border: none;\n  background: none;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: #6b7280;\n  transition: all 0.2s ease;\n}\n\n.role-option.active {\n  background: white;\n  color: #1a1a1a;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n\n.input-group {\n  margin-bottom: 20px;\n}\n\n.input-field {\n  width: 100%;\n  padding: 16px;\n  border: 1px solid #e5e7eb;\n  border-radius: 12px;\n  font-size: 16px;\n  font-weight: 400;\n  color: #1a1a1a;\n  background: white;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n}\n\n.input-field::placeholder {\n  color: #9ca3af;\n}\n\n.input-field:focus {\n  outline: none;\n  border-color: #1233EA;\n  box-shadow: 0 0 0 3px rgba(18, 51, 234, 0.1);\n}\n\n.input-field.error {\n  border-color: #ef4444;\n  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);\n}\n\n.password-field {\n  position: relative;\n}\n\n.password-field .input-field {\n  padding-right: 52px;\n}\n\n.password-toggle {\n  position: absolute;\n  right: 16px;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  cursor: pointer;\n  color: #9ca3af;\n  padding: 4px;\n  border-radius: 6px;\n  transition: color 0.2s ease;\n}\n\n.password-toggle:hover {\n  color: #6b7280;\n}\n\n.error-text {\n  color: #ef4444;\n  font-size: 14px;\n  margin-top: 8px;\n  font-weight: 400;\n}\n\n.login-btn {\n  width: 100%;\n  background: #1233EA;\n  color: white;\n  border: none;\n  padding: 16px 24px;\n  border-radius: 12px;\n  font-size: 16px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  margin-bottom: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  min-height: 52px;\n}\n\n.login-btn:hover:not(:disabled) {\n  background: #0f29d1;\n}\n\n.login-btn:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n\n.loader {\n  width: 16px;\n  height: 16px;\n  border: 2px solid transparent;\n  border-top: 2px solid white;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.forgot-link {\n  text-align: center;\n}\n\n.forgot-link a {\n  color: #1233EA;\n  text-decoration: none;\n  font-size: 14px;\n  font-weight: 500;\n  transition: color 0.2s ease;\n}\n\n.forgot-link a:hover {\n  color: #0f29d1;\n}\n\n@media (max-width: 480px) {\n  .login-page {\n    padding: 16px;\n  }\n  \n  .brand {\n    padding: 40px 24px 24px;\n  }\n  \n  .brand h1 {\n    font-size: 22px;\n  }\n  \n  .login-form {\n    padding: 24px;\n  }\n  \n  .input-field {\n    font-size: 16px; /* Prevent zoom on iOS */\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}