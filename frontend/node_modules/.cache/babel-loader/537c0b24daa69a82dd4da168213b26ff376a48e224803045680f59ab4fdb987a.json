{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, reactive } from 'vue';\nimport { useRouter } from 'vue-router';\nimport AppLoader from '@/components/AppLoader.vue';\nimport AppNotifications from '@/components/AppNotifications.vue';\nimport { useAuthStore } from '@/stores/auth';\nimport { useNotificationStore } from '@/stores/notifications';\nexport default {\n  __name: 'LoginPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const authStore = useAuthStore();\n    const notificationStore = useNotificationStore();\n\n    // Reactive data\n    const loading = ref(false);\n    const showPassword = ref(false);\n    const loginType = ref('partner'); // 'partner' or 'admin'\n\n    const formData = reactive({\n      login: '',\n      password: ''\n    });\n    const errors = ref({});\n\n    // Methods\n    const validateForm = () => {\n      errors.value = {};\n      if (!formData.login) {\n        errors.value.login = loginType.value === 'admin' ? 'Имя пользователя обязательно' : 'Логин обязателен';\n      }\n      if (!formData.password) {\n        errors.value.password = 'Пароль обязателен';\n      }\n      return Object.keys(errors.value).length === 0;\n    };\n    const login = async () => {\n      if (!validateForm()) return;\n      loading.value = true;\n      try {\n        const endpoint = loginType.value === 'admin' ? '/auth/admin/login' : '/auth/login';\n        const loginData = loginType.value === 'admin' ? {\n          username: formData.login,\n          password: formData.password\n        } : {\n          alias: formData.login,\n          password: formData.password\n        };\n        await authStore.login(endpoint, loginData);\n\n        // Redirect based on user role\n        if (authStore.user.role === 'admin') {\n          router.push('/admin');\n        } else {\n          router.push('/dashboard');\n        }\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Успешный вход в систему!'\n        });\n      } catch (error) {\n        console.error('Ошибка входа:', error);\n        let errorMessage = 'Ошибка входа в систему';\n        if (error.response?.status === 401) {\n          errorMessage = 'Неверные учетные данные';\n        } else if (error.response?.status === 403) {\n          errorMessage = error.response.data?.message || 'Доступ запрещен';\n        } else if (error.response?.status === 429) {\n          errorMessage = error.response.data?.message || 'Слишком много попыток входа';\n        } else if (error.response?.data?.message) {\n          errorMessage = error.response.data.message;\n        }\n        notificationStore.addNotification({\n          type: 'error',\n          message: errorMessage\n        });\n      } finally {\n        loading.value = false;\n      }\n    };\n    const __returned__ = {\n      router,\n      authStore,\n      notificationStore,\n      loading,\n      showPassword,\n      loginType,\n      formData,\n      errors,\n      validateForm,\n      login,\n      ref,\n      reactive,\n      get useRouter() {\n        return useRouter;\n      },\n      AppLoader,\n      AppNotifications,\n      get useAuthStore() {\n        return useAuthStore;\n      },\n      get useNotificationStore() {\n        return useNotificationStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","useRouter","AppLoader","AppNotifications","useAuthStore","useNotificationStore","router","authStore","notificationStore","loading","showPassword","loginType","formData","login","password","errors","validateForm","value","Object","keys","length","endpoint","loginData","username","alias","user","role","push","addNotification","type","message","error","console","errorMessage","response","status","data"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/views/auth/LoginPage.vue"],"sourcesContent":["<template>\n  <div class=\"login-page\">\n    <div class=\"container\">\n      <div class=\"login-card\">\n        <div class=\"brand\">\n          <h1>FREEDOM GROUP</h1>\n          <p>Партнерская система</p>\n        </div>\n        \n        <form @submit.prevent=\"login\" class=\"login-form\">\n          <!-- Role selection -->\n          <div class=\"role-selector\">\n            <button \n              type=\"button\"\n              @click=\"loginType = 'partner'\"\n              :class=\"['role-option', { active: loginType === 'partner' }]\"\n            >\n              Партнер\n            </button>\n            <button \n              type=\"button\"\n              @click=\"loginType = 'admin'\"\n              :class=\"['role-option', { active: loginType === 'admin' }]\"\n            >\n              Администратор\n            </button>\n          </div>\n          \n          <div class=\"input-group\">\n            <input\n              v-model=\"formData.login\"\n              type=\"text\"\n              required\n              :placeholder=\"loginType === 'admin' ? 'Имя пользователя' : 'Логин'\"\n              :class=\"{ error: errors.login }\"\n              class=\"input-field\"\n            />\n            <div v-if=\"errors.login\" class=\"error-text\">{{ errors.login }}</div>\n          </div>\n          \n          <div class=\"input-group\">\n            <div class=\"password-field\">\n              <input\n                v-model=\"formData.password\"\n                :type=\"showPassword ? 'text' : 'password'\"\n                required\n                placeholder=\"Пароль\"\n                :class=\"{ error: errors.password }\"\n                class=\"input-field\"\n              />\n              <button \n                type=\"button\" \n                @click=\"showPassword = !showPassword\"\n                class=\"password-toggle\"\n              >\n                <svg v-if=\"showPassword\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24\"></path>\n                  <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\"></line>\n                </svg>\n                <svg v-else width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\"></path>\n                  <circle cx=\"12\" cy=\"12\" r=\"3\"></circle>\n                </svg>\n              </button>\n            </div>\n            <div v-if=\"errors.password\" class=\"error-text\">{{ errors.password }}</div>\n          </div>\n          \n          <button \n            type=\"submit\" \n            :disabled=\"loading\"\n            class=\"login-btn\"\n          >\n            <span v-if=\"loading\" class=\"loader\"></span>\n            {{ loading ? 'Вход...' : 'Войти' }}\n          </button>\n          \n          <div v-if=\"loginType === 'partner'\" class=\"forgot-link\">\n            <router-link to=\"/forgot-password\">Забыли пароль?</router-link>\n          </div>\n        </form>\n      </div>\n    </div>\n    \n    <AppNotifications />\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport AppLoader from '@/components/AppLoader.vue'\nimport AppNotifications from '@/components/AppNotifications.vue'\nimport { useAuthStore } from '@/stores/auth'\nimport { useNotificationStore } from '@/stores/notifications'\n\nconst router = useRouter()\nconst authStore = useAuthStore()\nconst notificationStore = useNotificationStore()\n\n// Reactive data\nconst loading = ref(false)\nconst showPassword = ref(false)\nconst loginType = ref('partner') // 'partner' or 'admin'\n\nconst formData = reactive({\n  login: '',\n  password: ''\n})\n\nconst errors = ref({})\n\n// Methods\nconst validateForm = () => {\n  errors.value = {}\n  \n  if (!formData.login) {\n    errors.value.login = loginType.value === 'admin' ? 'Имя пользователя обязательно' : 'Логин обязателен'\n  }\n  \n  if (!formData.password) {\n    errors.value.password = 'Пароль обязателен'\n  }\n  \n  return Object.keys(errors.value).length === 0\n}\n\nconst login = async () => {\n  if (!validateForm()) return\n  \n  loading.value = true\n  \n  try {\n    const endpoint = loginType.value === 'admin' ? '/auth/admin/login' : '/auth/login'\n    const loginData = loginType.value === 'admin' \n      ? { username: formData.login, password: formData.password }\n      : { alias: formData.login, password: formData.password }\n    \n    await authStore.login(endpoint, loginData)\n    \n    // Redirect based on user role\n    if (authStore.user.role === 'admin') {\n      router.push('/admin')\n    } else {\n      router.push('/dashboard')\n    }\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Успешный вход в систему!'\n    })\n    \n  } catch (error) {\n    console.error('Ошибка входа:', error)\n    \n    let errorMessage = 'Ошибка входа в систему'\n    \n    if (error.response?.status === 401) {\n      errorMessage = 'Неверные учетные данные'\n    } else if (error.response?.status === 403) {\n      errorMessage = error.response.data?.message || 'Доступ запрещен'\n    } else if (error.response?.status === 429) {\n      errorMessage = error.response.data?.message || 'Слишком много попыток входа'\n    } else if (error.response?.data?.message) {\n      errorMessage = error.response.data.message\n    }\n    \n    notificationStore.addNotification({\n      type: 'error',\n      message: errorMessage\n    })\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n<style scoped>\n.login-page {\n  min-height: 100vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  font-family: 'Inter', sans-serif;\n  font-weight: 500;\n  position: relative;\n  overflow: hidden;\n}\n\n.login-page::before {\n  content: '';\n  position: absolute;\n  top: -50%;\n  left: -50%;\n  width: 200%;\n  height: 200%;\n  background: radial-gradient(circle, rgba(18, 51, 234, 0.1) 0%, transparent 70%);\n  animation: float 20s ease-in-out infinite;\n}\n\n@keyframes float {\n  0%, 100% { transform: translate(0, 0) rotate(0deg); }\n  33% { transform: translate(30px, -30px) rotate(120deg); }\n  66% { transform: translate(-20px, 20px) rotate(240deg); }\n}\n\n.container {\n  width: 100%;\n  max-width: 400px;\n}\n\n.login-card {\n  background: white;\n  border-radius: 20px;\n  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n  position: relative;\n  z-index: 1;\n  backdrop-filter: blur(10px);\n  transition: all 0.3s ease;\n  animation: slideUp 0.6s ease-out;\n}\n\n.login-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 35px 70px rgba(0, 0, 0, 0.2);\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateY(30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.logo {\n  background-color: #1233EA;\n  color: white;\n  text-align: center;\n  padding: 40px 20px;\n}\n\n.logo h1 {\n  margin: 0 0 8px;\n  font-size: 2rem;\n  font-weight: 700;\n}\n\n.logo p {\n  margin: 0;\n  opacity: 0.9;\n  font-size: 1.1rem;\n}\n\n.login-form {\n  padding: 30px;\n}\n\n.login-form h2 {\n  margin: 0 0 24px;\n  color: #2c3e50;\n  font-size: 1.5rem;\n  text-align: center;\n}\n\n.role-tabs {\n  display: flex;\n  background: #f8f9fa;\n  border-radius: 8px;\n  padding: 4px;\n  margin-bottom: 24px;\n}\n\n.role-tab {\n  flex: 1;\n  padding: 8px 16px;\n  border: none;\n  background: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: #6c757d;\n  transition: all 0.2s;\n}\n\n.role-tab.active {\n  background: white;\n  color: #667eea;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 6px;\n  font-weight: 500;\n  color: #495057;\n}\n\n.form-group input {\n  width: 100%;\n  padding: 12px 16px;\n  border: 2px solid #e9ecef;\n  border-radius: 8px;\n  font-size: 16px;\n  transition: border-color 0.2s;\n  box-sizing: border-box;\n}\n\n.form-group input:focus {\n  outline: none;\n  border-color: #667eea;\n}\n\n.form-group input.error {\n  border-color: #dc3545;\n}\n\n.password-input {\n  position: relative;\n}\n\n.password-input input {\n  padding-right: 45px;\n}\n\n.password-toggle {\n  position: absolute;\n  right: 12px;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  cursor: pointer;\n  font-size: 16px;\n  padding: 4px;\n}\n\n.error-message {\n  color: #dc3545;\n  font-size: 14px;\n  margin-top: 4px;\n}\n\n.form-actions {\n  margin: 30px 0 20px;\n}\n\n.btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 14px 28px;\n  border: none;\n  border-radius: 12px;\n  font-size: 16px;\n  font-weight: 600;\n  text-decoration: none;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  position: relative;\n  overflow: hidden;\n}\n\n.btn::before {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n  transition: all 0.6s ease;\n  transform: translate(-50%, -50%);\n}\n\n.btn:active::before {\n  width: 300px;\n  height: 300px;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #1233EA 0%, #0f29d1 100%);\n  color: white;\n  font-family: 'Inter', sans-serif;\n  font-weight: 600;\n  box-shadow: 0 4px 15px rgba(18, 51, 234, 0.3);\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0f29d1 0%, #0a1f9e 100%);\n  transform: translateY(-3px);\n  box-shadow: 0 8px 25px rgba(18, 51, 234, 0.4);\n}\n\n.btn-primary:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n}\n\n.btn-full {\n  width: 100%;\n}\n\n.help-links {\n  text-align: center;\n  margin-top: 20px;\n}\n\n.help-links a {\n  color: #1233EA;\n  text-decoration: none;\n  font-size: 14px;\n}\n\n.help-links a:hover {\n  text-decoration: underline;\n}\n\n@media (max-width: 480px) {\n  .login-page {\n    padding: 16px;\n  }\n  \n  .logo {\n    padding: 30px 16px;\n  }\n  \n  .logo h1 {\n    font-size: 1.75rem;\n  }\n  \n  .login-form {\n    padding: 24px 20px;\n  }\n  \n  .form-group input {\n    font-size: 16px; /* Prevent zoom on iOS */\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}