{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"modal-overlay\"\n};\nconst _hoisted_2 = {\n  class: \"modal modal-excel\"\n};\nconst _hoisted_3 = {\n  class: \"modal-header\"\n};\nconst _hoisted_4 = {\n  class: \"excel-header-info\"\n};\nconst _hoisted_5 = {\n  class: \"excel-file-size\"\n};\nconst _hoisted_6 = {\n  class: \"modal-body excel-viewer-body\"\n};\nconst _hoisted_7 = {\n  key: 1,\n  class: \"excel-container\"\n};\nconst _hoisted_8 = {\n  class: \"excel-tabs\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  class: \"excel-table-wrapper\"\n};\nconst _hoisted_11 = {\n  class: \"excel-table-container\"\n};\nconst _hoisted_12 = {\n  key: 0,\n  class: \"excel-table\"\n};\nconst _hoisted_13 = {\n  class: \"excel-row-number\"\n};\nconst _hoisted_14 = {\n  key: 2,\n  class: \"excel-no-data\"\n};\nconst _hoisted_15 = {\n  class: \"modal-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $props.show ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"h3\", null, _toDisplayString($setup.getDisplayFileName($props.document)), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_5, _toDisplayString($setup.formatFileSize($props.document?.fileSize || $props.document?.FileSize || $props.document?.size)), 1 /* TEXT */)]), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit('close')),\n    class: \"close-btn\"\n  }, \"×\")]), _createElementVNode(\"div\", _hoisted_6, [$props.loading ? (_openBlock(), _createBlock($setup[\"AppLoader\"], {\n    key: 0\n  })) : $props.excelData && $props.excelData.sheets && $props.excelData.sheets.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createCommentVNode(\" Sheet tabs \"), _createElementVNode(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.excelData.sheets, (sheet, index) => {\n    return _openBlock(), _createElementBlock(\"button\", {\n      key: index,\n      onClick: $event => $setup.activeSheet = index,\n      class: _normalizeClass(['excel-tab', {\n        active: $setup.activeSheet === index\n      }])\n    }, _toDisplayString(sheet.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_9);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" Excel table \"), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [$props.excelData.sheets[$setup.activeSheet] ? (_openBlock(), _createElementBlock(\"table\", _hoisted_12, [_createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"th\", {\n    class: \"excel-row-number\"\n  }, null, -1 /* CACHED */)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.excelData.sheets[$setup.activeSheet].data[0], (cell, colIndex) => {\n    return _openBlock(), _createElementBlock(\"th\", {\n      key: colIndex,\n      class: \"excel-header-cell\"\n    }, _toDisplayString($setup.getColumnLabel(colIndex)), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.excelData.sheets[$setup.activeSheet].data, (row, rowIndex) => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: rowIndex\n    }, [_createElementVNode(\"td\", _hoisted_13, _toDisplayString(rowIndex + 1), 1 /* TEXT */), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(row, (cell, colIndex) => {\n      return _openBlock(), _createElementBlock(\"td\", {\n        key: colIndex,\n        class: _normalizeClass([\"excel-cell\", {\n          'excel-header-row': rowIndex === 0\n        }])\n      }, _toDisplayString(cell), 3 /* TEXT, CLASS */);\n    }), 128 /* KEYED_FRAGMENT */))]);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)])])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [...(_cache[4] || (_cache[4] = [_createElementVNode(\"p\", null, \"Не удалось загрузить данные из файла\", -1 /* CACHED */)]))]))]), _createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = $event => _ctx.$emit('close')),\n    class: \"btn btn-secondary\"\n  }, \" Закрыть \"), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = $event => _ctx.$emit('download')),\n    class: \"btn btn-primary\"\n  }, \" Скачать файл \")])])])) : _createCommentVNode(\"v-if\", true);\n}","map":{"version":3,"names":["class","$props","show","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","$setup","getDisplayFileName","document","_hoisted_5","formatFileSize","fileSize","FileSize","size","onClick","_cache","$event","_ctx","$emit","_hoisted_6","loading","_createBlock","key","excelData","sheets","length","_hoisted_7","_createCommentVNode","_hoisted_8","_Fragment","_renderList","sheet","index","activeSheet","_normalizeClass","active","name","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","data","cell","colIndex","getColumnLabel","row","rowIndex","_hoisted_13","_hoisted_14","_hoisted_15"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/components/ExcelViewer.vue"],"sourcesContent":["<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal modal-excel\">\n      <div class=\"modal-header\">\n        <div class=\"excel-header-info\">\n          <h3>{{ getDisplayFileName(document) }}</h3>\n          <span class=\"excel-file-size\">{{ formatFileSize(document?.fileSize || document?.FileSize || document?.size) }}</span>\n        </div>\n        <button @click=\"$emit('close')\" class=\"close-btn\">×</button>\n      </div>\n      \n      <div class=\"modal-body excel-viewer-body\">\n        <AppLoader v-if=\"loading\" />\n        \n        <div v-else-if=\"excelData && excelData.sheets && excelData.sheets.length > 0\" class=\"excel-container\">\n          <!-- Sheet tabs -->\n          <div class=\"excel-tabs\">\n            <button \n              v-for=\"(sheet, index) in excelData.sheets\" \n              :key=\"index\"\n              @click=\"activeSheet = index\"\n              :class=\"['excel-tab', { active: activeSheet === index }]\"\n            >\n              {{ sheet.name }}\n            </button>\n          </div>\n          \n          <!-- Excel table -->\n          <div class=\"excel-table-wrapper\">\n            <div class=\"excel-table-container\">\n              <table class=\"excel-table\" v-if=\"excelData.sheets[activeSheet]\">\n                <thead>\n                  <tr>\n                    <th class=\"excel-row-number\"></th>\n                    <th \n                      v-for=\"(cell, colIndex) in excelData.sheets[activeSheet].data[0]\" \n                      :key=\"colIndex\"\n                      class=\"excel-header-cell\"\n                    >\n                      {{ getColumnLabel(colIndex) }}\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"(row, rowIndex) in excelData.sheets[activeSheet].data\" :key=\"rowIndex\">\n                    <td class=\"excel-row-number\">{{ rowIndex + 1 }}</td>\n                    <td \n                      v-for=\"(cell, colIndex) in row\" \n                      :key=\"colIndex\"\n                      class=\"excel-cell\"\n                      :class=\"{ 'excel-header-row': rowIndex === 0 }\"\n                    >\n                      {{ cell }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n        \n        <div v-else class=\"excel-no-data\">\n          <p>Не удалось загрузить данные из файла</p>\n        </div>\n      </div>\n      \n      <div class=\"modal-footer\">\n        <button @click=\"$emit('close')\" class=\"btn btn-secondary\">\n          Закрыть\n        </button>\n        <button @click=\"$emit('download')\" class=\"btn btn-primary\">\n          Скачать файл\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\n/* global defineProps, defineEmits */\nimport { ref, watch } from 'vue'\nimport AppLoader from '@/components/AppLoader.vue'\n\nconst props = defineProps({\n  show: {\n    type: Boolean,\n    required: true\n  },\n  document: {\n    type: Object,\n    default: null\n  },\n  excelData: {\n    type: Object,\n    default: null\n  },\n  loading: {\n    type: Boolean,\n    default: false\n  }\n})\n\ndefineEmits(['close', 'download'])\n\nconst activeSheet = ref(0)\n\n// Reset to first sheet when new document is loaded\nwatch(() => props.document, () => {\n  activeSheet.value = 0\n})\n\nconst getDisplayFileName = (doc) => {\n  if (!doc) return ''\n  return doc.fileName || doc.FileName || doc.originalName || doc.OriginalName || 'document.xlsx'\n}\n\nconst formatFileSize = (bytes) => {\n  if (!bytes) return ''\n  const kb = bytes / 1024\n  if (kb < 1024) return `${kb.toFixed(1)} KB`\n  const mb = kb / 1024\n  return `${mb.toFixed(1)} MB`\n}\n\nconst getColumnLabel = (index) => {\n  let label = ''\n  let num = index\n  while (num >= 0) {\n    label = String.fromCharCode(65 + (num % 26)) + label\n    num = Math.floor(num / 26) - 1\n  }\n  return label\n}\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 20px;\n}\n\n.modal {\n  background: white;\n  border-radius: 12px;\n  max-width: 600px;\n  width: 100%;\n  max-height: 90vh;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n}\n\n.modal-excel {\n  max-width: 95vw;\n  max-height: 95vh;\n  width: 1400px;\n}\n\n.modal-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  color: white;\n  border-radius: 12px 12px 0 0;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.excel-header-info {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.excel-file-size {\n  background: rgba(255, 255, 255, 0.2);\n  padding: 4px 12px;\n  border-radius: 12px;\n  font-size: 13px;\n  font-weight: 500;\n}\n\n.close-btn {\n  background: rgba(255, 255, 255, 0.15);\n  border: none;\n  font-size: 28px;\n  cursor: pointer;\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  transition: background 0.2s;\n  line-height: 1;\n  padding: 0;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.25);\n}\n\n.modal-body {\n  padding: 24px;\n  overflow-y: auto;\n  flex: 1;\n}\n\n.excel-viewer-body {\n  padding: 0;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.modal-footer {\n  padding: 16px 24px;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  background: #f9fafb;\n  border-radius: 0 0 12px 12px;\n}\n\n.btn {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  transition: all 0.15s ease;\n}\n\n.btn-primary {\n  background: #2563eb;\n  color: white;\n}\n\n.btn-primary:hover {\n  background: #1d4ed8;\n}\n\n.btn-secondary {\n  background: #6c757d;\n  color: white;\n}\n\n.btn-secondary:hover {\n  background: #545b62;\n}\n\n/* Excel viewer styles */\n.excel-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  max-height: calc(95vh - 200px);\n}\n\n.excel-tabs {\n  display: flex;\n  gap: 2px;\n  padding: 12px 20px 0;\n  background: #f3f4f6;\n  border-bottom: 2px solid #e5e7eb;\n  overflow-x: auto;\n}\n\n.excel-tab {\n  padding: 10px 20px;\n  background: #e5e7eb;\n  border: none;\n  border-radius: 8px 8px 0 0;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: #6b7280;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n\n.excel-tab:hover {\n  background: #d1d5db;\n}\n\n.excel-tab.active {\n  background: white;\n  color: #111827;\n  font-weight: 600;\n  border-bottom: 2px solid white;\n  margin-bottom: -2px;\n}\n\n.excel-table-wrapper {\n  flex: 1;\n  overflow: auto;\n  background: #f9fafb;\n  padding: 20px;\n}\n\n.excel-table-container {\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n.excel-table {\n  width: 100%;\n  border-collapse: collapse;\n  font-size: 13px;\n}\n\n.excel-table th,\n.excel-table td {\n  border: 1px solid #e5e7eb;\n  padding: 10px 14px;\n  text-align: left;\n  min-width: 100px;\n}\n\n.excel-row-number {\n  background: #f3f4f6;\n  color: #6b7280;\n  font-weight: 600;\n  text-align: center;\n  min-width: 50px !important;\n  width: 50px;\n  font-size: 12px;\n  position: sticky;\n  left: 0;\n  z-index: 2;\n}\n\n.excel-header-cell {\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n  font-size: 12px;\n}\n\n.excel-header-row {\n  background: #f9fafb;\n  font-weight: 600;\n  color: #374151;\n}\n\n.excel-cell {\n  color: #1f2937;\n}\n\n.excel-no-data {\n  text-align: center;\n  padding: 60px 20px;\n  color: #9ca3af;\n  font-size: 15px;\n}\n\n@media (max-width: 768px) {\n  .modal {\n    max-width: 100%;\n    max-height: 100vh;\n    border-radius: 0;\n  }\n  \n  .modal-excel {\n    max-width: 100%;\n    width: 100%;\n  }\n  \n  .excel-table-wrapper {\n    padding: 12px;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}