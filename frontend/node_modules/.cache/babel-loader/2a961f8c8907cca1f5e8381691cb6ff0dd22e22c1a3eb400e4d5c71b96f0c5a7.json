{"ast":null,"code":"import { defineStore } from 'pinia';\nimport { ref } from 'vue';\nimport api from '@/plugins/axios';\nexport const useAuthStore = defineStore('auth', () => {\n  // State\n  const user = ref(null);\n  const token = ref(localStorage.getItem('authToken') || null);\n  const isAuthenticated = ref(!!token.value);\n\n  // Actions\n  const login = async (endpoint, credentials) => {\n    try {\n      const response = await api.post(endpoint, credentials);\n      if (response.data.success) {\n        token.value = response.data.token;\n        user.value = response.data.user;\n        isAuthenticated.value = true;\n\n        // Store token in localStorage\n        localStorage.setItem('authToken', token.value);\n\n        // Set default authorization header\n        api.defaults.headers.common['Authorization'] = `Bearer ${token.value}`;\n        return response.data;\n      } else {\n        throw new Error(response.data.message || 'Login failed');\n      }\n    } catch (error) {\n      console.error('Login error:', error);\n      throw error;\n    }\n  };\n  const logout = () => {\n    user.value = null;\n    token.value = null;\n    isAuthenticated.value = false;\n\n    // Remove token from localStorage\n    localStorage.removeItem('authToken');\n\n    // Remove authorization header\n    delete api.defaults.headers.common['Authorization'];\n  };\n  const initAuth = async () => {\n    if (token.value) {\n      try {\n        // Set authorization header\n        api.defaults.headers.common['Authorization'] = `Bearer ${token.value}`;\n\n        // Verify token\n        const response = await api.get('/auth/verify');\n        if (response.data.success) {\n          user.value = response.data.user;\n          isAuthenticated.value = true;\n        } else {\n          // Invalid token, logout\n          logout();\n        }\n      } catch (error) {\n        console.error('Token verification failed:', error);\n        logout();\n      }\n    }\n  };\n  const updateUser = userData => {\n    user.value = {\n      ...user.value,\n      ...userData\n    };\n  };\n  return {\n    // State\n    user,\n    token,\n    isAuthenticated,\n    // Actions\n    login,\n    logout,\n    initAuth,\n    updateUser\n  };\n});","map":{"version":3,"names":["defineStore","ref","api","useAuthStore","user","token","localStorage","getItem","isAuthenticated","value","login","endpoint","credentials","response","post","data","success","setItem","defaults","headers","common","Error","message","error","console","logout","removeItem","initAuth","get","updateUser","userData"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/stores/auth.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\nimport api from '@/plugins/axios'\n\nexport const useAuthStore = defineStore('auth', () => {\n  // State\n  const user = ref(null)\n  const token = ref(localStorage.getItem('authToken') || null)\n  const isAuthenticated = ref(!!token.value)\n\n  // Actions\n  const login = async (endpoint, credentials) => {\n    try {\n      const response = await api.post(endpoint, credentials)\n      \n      if (response.data.success) {\n        token.value = response.data.token\n        user.value = response.data.user\n        isAuthenticated.value = true\n        \n        // Store token in localStorage\n        localStorage.setItem('authToken', token.value)\n        \n        // Set default authorization header\n        api.defaults.headers.common['Authorization'] = `Bearer ${token.value}`\n        \n        return response.data\n      } else {\n        throw new Error(response.data.message || 'Login failed')\n      }\n    } catch (error) {\n      console.error('Login error:', error)\n      throw error\n    }\n  }\n\n  const logout = () => {\n    user.value = null\n    token.value = null\n    isAuthenticated.value = false\n    \n    // Remove token from localStorage\n    localStorage.removeItem('authToken')\n    \n    // Remove authorization header\n    delete api.defaults.headers.common['Authorization']\n  }\n\n  const initAuth = async () => {\n    if (token.value) {\n      try {\n        // Set authorization header\n        api.defaults.headers.common['Authorization'] = `Bearer ${token.value}`\n        \n        // Verify token\n        const response = await api.get('/auth/verify')\n        \n        if (response.data.success) {\n          user.value = response.data.user\n          isAuthenticated.value = true\n        } else {\n          // Invalid token, logout\n          logout()\n        }\n      } catch (error) {\n        console.error('Token verification failed:', error)\n        logout()\n      }\n    }\n  }\n\n  const updateUser = (userData) => {\n    user.value = { ...user.value, ...userData }\n  }\n\n  return {\n    // State\n    user,\n    token,\n    isAuthenticated,\n    \n    // Actions\n    login,\n    logout,\n    initAuth,\n    updateUser\n  }\n})"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}