{"ast":null,"code":"import { ref, watch } from 'vue';\nimport AppLoader from '@/components/AppLoader.vue';\nexport default {\n  __name: 'ExcelViewer',\n  props: {\n    show: {\n      type: Boolean,\n      required: true\n    },\n    document: {\n      type: Object,\n      default: null\n    },\n    excelData: {\n      type: Object,\n      default: null\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: ['close', 'download'],\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n\n    /* global defineProps, defineEmits */\n    const props = __props;\n    const activeSheet = ref(0);\n\n    // Reset to first sheet when new document is loaded\n    watch(() => props.document, () => {\n      activeSheet.value = 0;\n    });\n\n    // Log excelData to debug\n    watch(() => props.excelData, newData => {\n      if (newData) {\n        console.log('üìä ExcelViewer –ø–æ–ª—É—á–∏–ª –¥–∞–Ω–Ω—ã–µ:', {\n          –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–õ–∏—Å—Ç–æ–≤: newData.sheets?.length || 0,\n          –Ω–∞–∑–≤–∞–Ω–∏—è–õ–∏—Å—Ç–æ–≤: newData.sheets?.map(s => s.name) || []\n        });\n      }\n    }, {\n      immediate: true\n    });\n    const getDisplayFileName = doc => {\n      if (!doc) return '';\n      return doc.fileName || doc.FileName || doc.originalName || doc.OriginalName || 'document.xlsx';\n    };\n    const formatFileSize = bytes => {\n      if (!bytes) return '';\n      const kb = bytes / 1024;\n      if (kb < 1024) return `${kb.toFixed(1)} KB`;\n      const mb = kb / 1024;\n      return `${mb.toFixed(1)} MB`;\n    };\n    const getColumnLabel = index => {\n      let label = '';\n      let num = index;\n      while (num >= 0) {\n        label = String.fromCharCode(65 + num % 26) + label;\n        num = Math.floor(num / 26) - 1;\n      }\n      return label;\n    };\n    const __returned__ = {\n      props,\n      activeSheet,\n      getDisplayFileName,\n      formatFileSize,\n      getColumnLabel,\n      ref,\n      watch,\n      AppLoader\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watch","AppLoader","props","__props","activeSheet","document","value","excelData","newData","console","log","–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–õ–∏—Å—Ç–æ–≤","sheets","length","–Ω–∞–∑–≤–∞–Ω–∏—è–õ–∏—Å—Ç–æ–≤","map","s","name","immediate","getDisplayFileName","doc","fileName","FileName","originalName","OriginalName","formatFileSize","bytes","kb","toFixed","mb","getColumnLabel","index","label","num","String","fromCharCode","Math","floor"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/components/ExcelViewer.vue"],"sourcesContent":["<template>\n  <div v-if=\"show\" class=\"modal-overlay\">\n    <div class=\"modal modal-excel\">\n      <div class=\"modal-header\">\n        <div class=\"excel-header-info\">\n          <h3>{{ getDisplayFileName(document) }}</h3>\n          <span class=\"excel-file-size\">{{ formatFileSize(document?.fileSize || document?.FileSize || document?.size) }}</span>\n        </div>\n        <button @click=\"$emit('close')\" class=\"close-btn\">√ó</button>\n      </div>\n      \n      <div class=\"modal-body excel-viewer-body\">\n        <AppLoader v-if=\"loading\" />\n        \n        <div v-else-if=\"excelData && excelData.sheets && excelData.sheets.length > 0\" class=\"excel-container\">\n          <!-- Sheet tabs -->\n          <div v-if=\"excelData.sheets.length > 1\" class=\"excel-tabs\">\n            <button \n              v-for=\"(sheet, index) in excelData.sheets\" \n              :key=\"index\"\n              @click=\"activeSheet = index\"\n              :class=\"['excel-tab', { active: activeSheet === index }]\"\n            >\n              {{ sheet.name }}\n            </button>\n          </div>\n          \n          <!-- Sheet name header for single sheet -->\n          <div v-else class=\"excel-single-sheet-header\">\n            <span class=\"sheet-name\">{{ excelData.sheets[0]?.name || '–õ–∏—Å—Ç 1' }}</span>\n          </div>\n          \n          <!-- Excel table -->\n          <div class=\"excel-table-wrapper\">\n            <div class=\"excel-table-container\">\n              <table class=\"excel-table\" v-if=\"excelData.sheets[activeSheet]\">\n                <thead>\n                  <tr>\n                    <th class=\"excel-row-number\"></th>\n                    <th \n                      v-for=\"(cell, colIndex) in excelData.sheets[activeSheet].data[0]\" \n                      :key=\"colIndex\"\n                      class=\"excel-header-cell\"\n                    >\n                      {{ getColumnLabel(colIndex) }}\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"(row, rowIndex) in excelData.sheets[activeSheet].data\" :key=\"rowIndex\">\n                    <td class=\"excel-row-number\">{{ rowIndex + 1 }}</td>\n                    <td \n                      v-for=\"(cell, colIndex) in row\" \n                      :key=\"colIndex\"\n                      class=\"excel-cell\"\n                      :class=\"{ 'excel-header-row': rowIndex === 0 }\"\n                    >\n                      {{ cell }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n        \n        <div v-else class=\"excel-no-data\">\n          <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞</p>\n        </div>\n      </div>\n      \n      <div class=\"modal-footer\">\n        <button @click=\"$emit('close')\" class=\"btn btn-secondary\">\n          –ó–∞–∫—Ä—ã—Ç—å\n        </button>\n        <button @click=\"$emit('download')\" class=\"btn btn-primary\">\n          –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\n/* global defineProps, defineEmits */\nimport { ref, watch } from 'vue'\nimport AppLoader from '@/components/AppLoader.vue'\n\nconst props = defineProps({\n  show: {\n    type: Boolean,\n    required: true\n  },\n  document: {\n    type: Object,\n    default: null\n  },\n  excelData: {\n    type: Object,\n    default: null\n  },\n  loading: {\n    type: Boolean,\n    default: false\n  }\n})\n\ndefineEmits(['close', 'download'])\n\nconst activeSheet = ref(0)\n\n// Reset to first sheet when new document is loaded\nwatch(() => props.document, () => {\n  activeSheet.value = 0\n})\n\n// Log excelData to debug\nwatch(() => props.excelData, (newData) => {\n  if (newData) {\n    console.log('üìä ExcelViewer –ø–æ–ª—É—á–∏–ª –¥–∞–Ω–Ω—ã–µ:', {\n      –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–õ–∏—Å—Ç–æ–≤: newData.sheets?.length || 0,\n      –Ω–∞–∑–≤–∞–Ω–∏—è–õ–∏—Å—Ç–æ–≤: newData.sheets?.map(s => s.name) || []\n    })\n  }\n}, { immediate: true })\n\nconst getDisplayFileName = (doc) => {\n  if (!doc) return ''\n  return doc.fileName || doc.FileName || doc.originalName || doc.OriginalName || 'document.xlsx'\n}\n\nconst formatFileSize = (bytes) => {\n  if (!bytes) return ''\n  const kb = bytes / 1024\n  if (kb < 1024) return `${kb.toFixed(1)} KB`\n  const mb = kb / 1024\n  return `${mb.toFixed(1)} MB`\n}\n\nconst getColumnLabel = (index) => {\n  let label = ''\n  let num = index\n  while (num >= 0) {\n    label = String.fromCharCode(65 + (num % 26)) + label\n    num = Math.floor(num / 26) - 1\n  }\n  return label\n}\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 20px;\n}\n\n.modal {\n  background: white;\n  border-radius: 12px;\n  max-width: 600px;\n  width: 100%;\n  max-height: 90vh;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n}\n\n.modal-excel {\n  max-width: 95vw;\n  max-height: 95vh;\n  width: 1400px;\n}\n\n.modal-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  color: white;\n  border-radius: 12px 12px 0 0;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.excel-header-info {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.excel-file-size {\n  background: rgba(255, 255, 255, 0.2);\n  padding: 4px 12px;\n  border-radius: 12px;\n  font-size: 13px;\n  font-weight: 500;\n}\n\n.close-btn {\n  background: rgba(255, 255, 255, 0.15);\n  border: none;\n  font-size: 28px;\n  cursor: pointer;\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  transition: background 0.2s;\n  line-height: 1;\n  padding: 0;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.25);\n}\n\n.modal-body {\n  padding: 24px;\n  overflow-y: auto;\n  flex: 1;\n}\n\n.excel-viewer-body {\n  padding: 0;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.modal-footer {\n  padding: 16px 24px;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  background: #f9fafb;\n  border-radius: 0 0 12px 12px;\n}\n\n.btn {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  transition: all 0.15s ease;\n}\n\n.btn-primary {\n  background: #2563eb;\n  color: white;\n}\n\n.btn-primary:hover {\n  background: #1d4ed8;\n}\n\n.btn-secondary {\n  background: #6c757d;\n  color: white;\n}\n\n.btn-secondary:hover {\n  background: #545b62;\n}\n\n/* Excel viewer styles */\n.excel-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  max-height: calc(95vh - 200px);\n}\n\n.excel-tabs {\n  display: flex;\n  gap: 2px;\n  padding: 12px 20px 0;\n  background: #f3f4f6;\n  border-bottom: 2px solid #e5e7eb;\n  overflow-x: auto;\n}\n\n.excel-tab {\n  padding: 10px 20px;\n  background: #e5e7eb;\n  border: none;\n  border-radius: 8px 8px 0 0;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: #6b7280;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n\n.excel-tab:hover {\n  background: #d1d5db;\n}\n\n.excel-tab.active {\n  background: white;\n  color: #111827;\n  font-weight: 600;\n  border-bottom: 2px solid white;\n  margin-bottom: -2px;\n}\n\n.excel-table-wrapper {\n  flex: 1;\n  overflow: auto;\n  background: #f9fafb;\n  padding: 20px;\n}\n\n.excel-table-container {\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n.excel-table {\n  width: 100%;\n  border-collapse: collapse;\n  font-size: 13px;\n}\n\n.excel-table th,\n.excel-table td {\n  border: 1px solid #e5e7eb;\n  padding: 10px 14px;\n  text-align: left;\n  min-width: 100px;\n}\n\n.excel-row-number {\n  background: #f3f4f6;\n  color: #6b7280;\n  font-weight: 600;\n  text-align: center;\n  min-width: 50px !important;\n  width: 50px;\n  font-size: 12px;\n  position: sticky;\n  left: 0;\n  z-index: 2;\n}\n\n.excel-header-cell {\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n  font-size: 12px;\n}\n\n.excel-header-row {\n  background: #f9fafb;\n  font-weight: 600;\n  color: #374151;\n}\n\n.excel-cell {\n  color: #1f2937;\n}\n\n.excel-no-data {\n  text-align: center;\n  padding: 60px 20px;\n  color: #9ca3af;\n  font-size: 15px;\n}\n\n@media (max-width: 768px) {\n  .modal {\n    max-width: 100%;\n    max-height: 100vh;\n    border-radius: 0;\n  }\n  \n  .modal-excel {\n    max-width: 100%;\n    width: 100%;\n  }\n  \n  .excel-table-wrapper {\n    padding: 12px;\n  }\n}\n</style>\n"],"mappings":"AAqFA,SAASA,GAAG,EAAEC,KAAK,QAAQ,KAAI;AAC/B,OAAOC,SAAS,MAAM,4BAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;IAFjD;IAIA,MAAMC,KAAK,GAAGC,OAAA;IAqBd,MAAMC,WAAW,GAAGL,GAAG,CAAC,CAAC;;IAEzB;IACAC,KAAK,CAAC,MAAME,KAAK,CAACG,QAAQ,EAAE,MAAM;MAChCD,WAAW,CAACE,KAAK,GAAG;IACtB,CAAC;;IAED;IACAN,KAAK,CAAC,MAAME,KAAK,CAACK,SAAS,EAAGC,OAAO,IAAK;MACxC,IAAIA,OAAO,EAAE;QACXC,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAE;UAC5CC,gBAAgB,EAAEH,OAAO,CAACI,MAAM,EAAEC,MAAM,IAAI,CAAC;UAC7CC,cAAc,EAAEN,OAAO,CAACI,MAAM,EAAEG,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,IAAI;QACtD,CAAC;MACH;IACF,CAAC,EAAE;MAAEC,SAAS,EAAE;IAAK,CAAC;IAEtB,MAAMC,kBAAkB,GAAIC,GAAG,IAAK;MAClC,IAAI,CAACA,GAAG,EAAE,OAAO,EAAC;MAClB,OAAOA,GAAG,CAACC,QAAQ,IAAID,GAAG,CAACE,QAAQ,IAAIF,GAAG,CAACG,YAAY,IAAIH,GAAG,CAACI,YAAY,IAAI,eAAc;IAC/F;IAEA,MAAMC,cAAc,GAAIC,KAAK,IAAK;MAChC,IAAI,CAACA,KAAK,EAAE,OAAO,EAAC;MACpB,MAAMC,EAAE,GAAGD,KAAK,GAAG,IAAG;MACtB,IAAIC,EAAE,GAAG,IAAI,EAAE,OAAO,GAAGA,EAAE,CAACC,OAAO,CAAC,CAAC,CAAC,KAAI;MAC1C,MAAMC,EAAE,GAAGF,EAAE,GAAG,IAAG;MACnB,OAAO,GAAGE,EAAE,CAACD,OAAO,CAAC,CAAC,CAAC,KAAI;IAC7B;IAEA,MAAME,cAAc,GAAIC,KAAK,IAAK;MAChC,IAAIC,KAAK,GAAG,EAAC;MACb,IAAIC,GAAG,GAAGF,KAAI;MACd,OAAOE,GAAG,IAAI,CAAC,EAAE;QACfD,KAAK,GAAGE,MAAM,CAACC,YAAY,CAAC,EAAE,GAAIF,GAAG,GAAG,EAAG,CAAC,GAAGD,KAAI;QACnDC,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,GAAG,EAAE,CAAC,GAAG;MAC/B;MACA,OAAOD,KAAI;IACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}