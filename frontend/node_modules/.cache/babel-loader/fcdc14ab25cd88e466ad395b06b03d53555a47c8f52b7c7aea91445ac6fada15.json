{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelText as _vModelText, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, createVNode as _createVNode } from \"vue\";\nimport _imports_0 from '@/assets/email.svg';\nconst _hoisted_1 = {\n  class: \"wrap\"\n};\nconst _hoisted_2 = {\n  class: \"code-inputs\"\n};\nconst _hoisted_3 = [\"onUpdate:modelValue\", \"onInput\", \"onKeydown\"];\nconst _hoisted_4 = {\n  class: \"wrap-buttons\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"timer-section\"\n};\nconst _hoisted_6 = {\n  class: \"timer\"\n};\nconst _hoisted_7 = {\n  class: \"timer-digits\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n    class: \"wrap-image\"\n  }, [_createElementVNode(\"img\", {\n    src: _imports_0,\n    alt: \"Email Icon\"\n  })], -1 /* CACHED */)), _cache[2] || (_cache[2] = _createElementVNode(\"h1\", null, \"Авторизация\", -1 /* CACHED */)), _createElementVNode(\"p\", null, \"Мы отправили код для авторизации. На почту \" + _toDisplayString($setup.mainStore.email), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.digits, (digit, index) => {\n    return _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n      key: index,\n      \"onUpdate:modelValue\": $event => $setup.digits[index] = $event,\n      onInput: $event => $setup.handleInput(index, $event),\n      onKeydown: $event => $setup.handleKeydown(index, $event),\n      onPaste: $setup.handlePaste,\n      type: \"text\",\n      inputmode: \"numeric\",\n      pattern: \"[0-9]*\",\n      maxlength: \"1\",\n      class: \"code-input\",\n      ref_for: true,\n      ref: el => {\n        if (el) $setup.inputs[index] = el;\n      }\n    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_3)), [[_vModelText, $setup.digits[index]]]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_4, [_createCommentVNode(\" <LogInButton/> \"), _createVNode($setup[\"SendAgainButton\"], {\n    disabled: !$setup.canResend,\n    onClick: $setup.handleResend\n  }, null, 8 /* PROPS */, [\"disabled\"]), !$setup.canResend ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_cache[0] || (_cache[0] = _createElementVNode(\"p\", {\n    class: \"timer-text\"\n  }, \"Отправить код повторно можно через:\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"span\", _hoisted_7, _toDisplayString($setup.formattedTime), 1 /* TEXT */)])])) : _createCommentVNode(\"v-if\", true)])]);\n}","map":{"version":3,"names":["_imports_0","class","_createElementBlock","_hoisted_1","_createElementVNode","src","alt","_toDisplayString","$setup","mainStore","email","_hoisted_2","_Fragment","_renderList","digits","digit","index","key","$event","onInput","handleInput","onKeydown","handleKeydown","onPaste","handlePaste","type","inputmode","pattern","maxlength","ref","el","inputs","_hoisted_4","_createCommentVNode","_createVNode","disabled","canResend","onClick","handleResend","_hoisted_5","_hoisted_6","_hoisted_7","formattedTime"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/views/auth/EmailVerify.vue"],"sourcesContent":["<script setup>\nimport { ref, onMounted, onUnmounted, nextTick, computed } from 'vue'\n// import LogInButton from \"@/components/ui/buttons/LogInButton.vue\";\nimport SendAgainButton from \"@/components/ui/buttons/SendAgainButton.vue\";\nimport { useMainStore } from \"@/stores/main.ts\";\n\nconst mainStore = useMainStore();\n\nconst digits = ref(['', '', '', ''])\nconst inputs = ref([])\nconst canResend = ref(false)\nconst countdown = ref(60) // 60 секунд таймера\nconst timerInterval = ref(null) // Ссылка на интервал таймера\n\nconst handleInput = (index, event) => {\n  const value = event.target.value.replace(/\\D/g, '') // Оставляем только цифры\n  \n  digits.value[index] = value\n  \n  // Если введено число и есть следующий инпут, переходим к нему\n  if (value && index < digits.value.length - 1) {\n    nextTick(() => {\n      inputs.value[index + 1]?.focus()\n    })\n  }\n  \n  // Автоматическая отправка при заполнении всех полей\n  if (digits.value.every(digit => digit !== '')) {\n    handleLogin()\n  }\n}\n\nconst handleKeydown = (index, event) => {\n  // Обработка удаления и перемещения между полями\n  if (event.key === 'Backspace' && !digits.value[index] && index > 0) {\n    inputs.value[index - 1]?.focus()\n  }\n}\n\nconst handlePaste = (event) => {\n  event.preventDefault()\n  const pasteData = event.clipboardData.getData('text').replace(/\\D/g, '')\n  \n  // Вставляем только первые 4 цифры\n  const codes = pasteData.slice(0, 4).split('')\n  \n  codes.forEach((code, index) => {\n    if (index < digits.value.length) {\n      digits.value[index] = code\n    }\n  })\n  \n  // Переходим к последнему заполненному инпуту\n  const lastFilledIndex = Math.min(codes.length - 1, digits.value.length - 1)\n  nextTick(() => {\n    inputs.value[lastFilledIndex]?.focus()\n  })\n\n  handleLogin()\n}\n\nconst handleLogin = () => {\n  console.log('handleLogin called with code:', digits.value.join(''));\n  mainStore.code = digits.value.join('')\n  if (mainStore.code.length === 4) {\n    mainStore.verifyCode()\n  }\n}\n\n// Функция для запуска таймера\nconst startCountdown = () => {\n  console.log('startCountdown called, current countdown:', countdown.value, 'canResend:', canResend.value);\n  \n  // Не перезапускаем таймер если он уже идет\n  if (!canResend.value && countdown.value > 0 && timerInterval.value) {\n    console.log('Timer already running, not restarting');\n    return;\n  }\n  \n  // Очищаем предыдущий таймер если есть\n  if (timerInterval.value) {\n    clearInterval(timerInterval.value);\n  }\n  \n  canResend.value = false\n  countdown.value = 60\n  \n  timerInterval.value = setInterval(() => {\n    countdown.value -= 1\n    \n    if (countdown.value <= 0) {\n      clearInterval(timerInterval.value)\n      timerInterval.value = null\n      canResend.value = true\n      console.log('Timer finished, can resend now');\n    }\n  }, 1000)\n}\n\n// Обработчик повторной отправки\nconst handleResend = () => {\n  if (canResend.value) {\n    // Вызов метода отправки кода из store\n    mainStore.sendCodeAgain()\n    startCountdown()\n  }\n}\n\n// Форматирование времени для таймера\nconst formattedTime = computed(() => {\n  const seconds = countdown.value\n  return `00:${seconds.toString().padStart(2, '0')}`\n})\n\n// Фокус на первый инпут при монтировании\nonMounted(() => {\n  console.log('EmailVerify component mounted');\n  nextTick(() => {\n    inputs.value[0]?.focus()\n  })\n  \n  // Запускаем таймер при загрузке компонента только если он не запущен\n  console.log('About to start countdown, current state:', countdown.value, canResend.value);\n  startCountdown()\n})\n\n// Очищаем таймер при размонтировании\nonUnmounted(() => {\n  console.log('EmailVerify component unmounted, clearing timer');\n  if (timerInterval.value) {\n    clearInterval(timerInterval.value);\n    timerInterval.value = null;\n  }\n})\n</script>\n\n<template>\n  <div class=\"wrap\">\n    <div class=\"wrap-image\">\n      <img src=\"@/assets/email.svg\" alt=\"Email Icon\" />\n    </div>\n    <h1>Авторизация</h1>\n    <p>Мы отправили код для авторизации. На почту {{ mainStore.email }}</p>\n    \n    <div class=\"code-inputs\">\n      <input\n        v-for=\"(digit, index) in digits\"\n        :key=\"index\"\n        v-model=\"digits[index]\"\n        @input=\"handleInput(index, $event)\"\n        @keydown=\"handleKeydown(index, $event)\"\n        @paste=\"handlePaste\"\n        type=\"text\"\n        inputmode=\"numeric\"\n        pattern=\"[0-9]*\"\n        maxlength=\"1\"\n        class=\"code-input\"\n        :ref=\"el => { if (el) inputs[index] = el }\"\n      />\n    </div>\n    \n    <div class=\"wrap-buttons\">\n      <!-- <LogInButton/> -->\n      <SendAgainButton \n        :disabled=\"!canResend\" \n        @click=\"handleResend\"\n      />\n      \n      <div v-if=\"!canResend\" class=\"timer-section\">\n        <p class=\"timer-text\">Отправить код повторно можно через:</p>\n        <div class=\"timer\">\n          <span class=\"timer-digits\">{{ formattedTime }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.wrap {\n  margin: 0 auto;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  justify-content: center;\n  height: 100vh;\n  gap: 24px;\n  width: 360px;\n}\n\n.wrap-image {\n  width: 64px;\n  height: 64px;\n  background-color: rgba(18, 51, 234, 0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 16px;\n  border-radius: 50%;\n}\n\n.wrap-image img {\n  width: 32px;\n  height: 32px;\n}\n\nh1 {\n  font-size: 24px;\n  font-weight: 600;\n  color: #333;\n  margin: 0;\n}\n\np {\n  text-align: center;\n  color: #666;\n  margin: 0;\n  line-height: 1.5;\n}\n\n.code-inputs {\n  display: flex;\n  gap: 12px;\n  margin: 16px 0;\n}\n\n.code-input {\n  width: 50px;\n  height: 50px;\n  text-align: center;\n  font-size: 24px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  transition: border-color 0.2s;\n}\n\n.code-input:focus {\n  border-color: #1233ea;\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(18, 51, 234, 0.2);\n}\n\n.wrap-buttons {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  width: 100%;\n  align-items: center;\n}\n\n.timer-section {\n  text-align: center;\n  margin-top: 8px;\n}\n\n.timer-text {\n  font-size: 14px;\n  color: #666;\n  margin-bottom: 8px;\n}\n\n.timer {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  background: #1233EA;\n  color: white;\n  padding: 8px 16px;\n  border-radius: 20px;\n  font-family: 'Courier New', monospace;\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.timer-digits {\n  font-size: 18px;\n  font-weight: 600;\n  letter-spacing: 2px;\n  color: white;\n}\n\n/* Стили для disabled кнопки */\nbutton:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n/* Анимация для таймера */\n.timer {\n  animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n  0% {\n    transform: scale(1);\n    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n  }\n  50% {\n    transform: scale(1.05);\n    box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);\n  }\n  100% {\n    transform: scale(1);\n    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n  }\n}\n\n/* Responsive Design */\n@media (max-width: 480px) {\n  .wrap {\n    min-width: 100%;\n    max-width: 100%;\n    padding: 0 16px;\n    gap: 20px;\n  }\n  \n  h1 {\n    font-size: 24px;\n  }\n  \n  .code-input {\n    width: 45px;\n    height: 45px;\n    font-size: 20px;\n  }\n  \n  .code-inputs {\n    gap: 8px;\n  }\n  \n  .text-info {\n    font-size: 14px;\n  }\n}\n</style>"],"mappings":";OA2IWA,UAAwB;;EAF5BC,KAAK,EAAC;AAAM;;EAOVA,KAAK,EAAC;AAAa;;;EAiBnBA,KAAK,EAAC;AAAc;;;EAOAA,KAAK,EAAC;;;EAEtBA,KAAK,EAAC;AAAO;;EACVA,KAAK,EAAC;AAAc;;uBAlClCC,mBAAA,CAsCM,OAtCNC,UAsCM,G,0BArCJC,mBAAA,CAEM;IAFDH,KAAK,EAAC;EAAY,IACrBG,mBAAA,CAAiD;IAA5CC,GAAwB,EAAxBL,UAAwB;IAACM,GAAG,EAAC;oDAEpCF,mBAAA,CAAoB,YAAhB,aAAW,qBACfA,mBAAA,CAAuE,WAApE,6CAA2C,GAAAG,gBAAA,CAAGC,MAAA,CAAAC,SAAS,CAACC,KAAK,kBAEhEN,mBAAA,CAeM,OAfNO,UAeM,I,kBAdJT,mBAAA,CAaEU,SAAA,QAAAC,WAAA,CAZyBL,MAAA,CAAAM,MAAM,GAAvBC,KAAK,EAAEC,KAAK;0CADtBd,mBAAA,CAaE;MAXCe,GAAG,EAAED,KAAK;uCACFR,MAAA,CAAAM,MAAM,CAACE,KAAK,IAAAE,MAAA;MACpBC,OAAK,EAAAD,MAAA,IAAEV,MAAA,CAAAY,WAAW,CAACJ,KAAK,EAAEE,MAAM;MAChCG,SAAO,EAAAH,MAAA,IAAEV,MAAA,CAAAc,aAAa,CAACN,KAAK,EAAEE,MAAM;MACpCK,OAAK,EAAEf,MAAA,CAAAgB,WAAW;MACnBC,IAAI,EAAC,MAAM;MACXC,SAAS,EAAC,SAAS;MACnBC,OAAO,EAAC,QAAQ;MAChBC,SAAS,EAAC,GAAG;MACb3B,KAAK,EAAC,YAAY;;MACjB4B,GAAG,EAAEC,EAAE;QAAA,IAAUA,EAAE,EAAEtB,MAAA,CAAAuB,MAAM,CAACf,KAAK,IAAIc,EAAE;MAAA;0EAT/BtB,MAAA,CAAAM,MAAM,CAACE,KAAK,G;oCAazBZ,mBAAA,CAaM,OAbN4B,UAaM,GAZJC,mBAAA,oBAAuB,EACvBC,YAAA,CAGE1B,MAAA;IAFC2B,QAAQ,GAAG3B,MAAA,CAAA4B,SAAS;IACpBC,OAAK,EAAE7B,MAAA,CAAA8B;0CAGE9B,MAAA,CAAA4B,SAAS,I,cAArBlC,mBAAA,CAKM,OALNqC,UAKM,G,0BAJJnC,mBAAA,CAA6D;IAA1DH,KAAK,EAAC;EAAY,GAAC,qCAAmC,qBACzDG,mBAAA,CAEM,OAFNoC,UAEM,GADJpC,mBAAA,CAAqD,QAArDqC,UAAqD,EAAAlC,gBAAA,CAAvBC,MAAA,CAAAkC,aAAa,iB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}