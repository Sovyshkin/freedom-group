{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, onMounted, computed, watch } from 'vue';\nimport AppLoader from '@/components/AppLoader.vue';\nimport AppNotifications from '@/components/AppNotifications.vue';\nimport ExcelViewer from '@/components/ExcelViewer.vue';\nimport { useAuthStore } from '@/stores/auth';\nimport { useNotificationStore } from '@/stores/notifications';\nimport api from '@/plugins/axios';\nexport default {\n  __name: 'AdminDashboard',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const authStore = useAuthStore();\n    const notificationStore = useNotificationStore();\n\n    // Reactive data\n    const user = ref(null);\n    const stats = ref({});\n    const activeTab = ref('partners');\n\n    // Computed для проверки роли суперадмина\n    const isSuperAdmin = computed(() => {\n      return authStore.user?.adminRole === 'superadmin';\n    });\n\n    // Tabs\n    const tabs = computed(() => {\n      const baseTabs = [{\n        id: 'partners',\n        label: 'Партнеры'\n      }, {\n        id: 'upload',\n        label: 'Загрузка'\n      }, {\n        id: 'documents',\n        label: 'Документы'\n      }];\n\n      // Добавляем вкладки только для суперадмина\n      if (isSuperAdmin.value) {\n        baseTabs.push({\n          id: 'admins',\n          label: 'Администраторы'\n        });\n        baseTabs.push({\n          id: 'audit',\n          label: 'Журнал событий'\n        });\n      }\n      return baseTabs;\n    });\n\n    // File upload\n    const selectedFiles = ref([]);\n    const uploading = ref(false);\n    const uploadResults = ref([]);\n    const isDragover = ref(false);\n\n    // Auto upload (с определением партнёра из Excel)\n    const autoUploadFiles = ref([]);\n    const autoUploading = ref(false);\n    const autoUploadResults = ref([]);\n    const isAutoUploadDragover = ref(false);\n\n    // Documents\n    const unpublishedClaims = ref([]);\n    const selectedClaims = ref([]);\n    const loadingDocuments = ref(false);\n    const publishing = ref(false);\n    // Additional loaders\n    const loadingStats = ref(false);\n    const loadingPartnerDocuments = ref(false);\n    const documentsFilter = ref('unpublished'); // 'unpublished' or 'published'\n    const documentSearchQuery = ref(''); // поиск по названию файла\n    const documentPartnerFilter = ref(''); // фильтр по партнёру (partnerId)\n    const documentDateFrom = ref(''); // начало диапазона дат\n    const documentDateTo = ref(''); // конец диапазона дат\n\n    const setDocumentsFilter = value => {\n      documentsFilter.value = value;\n      refreshDocuments();\n    };\n\n    // File-Partner mapping\n    const currentUploadPartnerId = ref(null);\n    const currentUploadPartnerName = ref('');\n    const showUploadModal = ref(false);\n\n    // Partners\n    const partners = ref([]);\n    const loadingPartners = ref(false);\n    const partnerSearchQuery = ref('');\n    const partnerActiveFilter = ref('all'); // 'all' | 'active' | 'inactive'\n    const partnerBirthdayFilter = ref(false); // показывать только с ДР в этом месяце\n    const showCreatePartnerModal = ref(false);\n    const creatingPartner = ref(false);\n    const showEditPartnerModal = ref(false);\n    const editingPartner = ref(false);\n    const partnerToEdit = ref(null);\n    const showPartnerDocumentsModal = ref(false);\n    const partnerDocuments = ref([]);\n    const showViewDocumentModal = ref(false);\n    const currentDocument = ref(null);\n    const loadingCurrentDocument = ref(false);\n    const excelData = ref(null);\n    const newPartner = ref({\n      name: '',\n      email: '',\n      telegram: '',\n      alias: '',\n      password: '',\n      birthDate: '',\n      active: true\n    });\n\n    // Admins (только для superadmin)\n    const admins = ref([]);\n    const loadingAdmins = ref(false);\n    const showCreateAdminModal = ref(false);\n    const creatingAdmin = ref(false);\n    const showChangeAdminPasswordModal = ref(false);\n    const changingPassword = ref(false);\n    const adminToEdit = ref(null);\n    const newAdminPassword = ref('');\n    const newAdmin = ref({\n      username: '',\n      email: '',\n      password: ''\n    });\n\n    // Audit Logs (только для superadmin)\n    const auditLogs = ref([]);\n    const loadingAuditLogs = ref(false);\n    const auditSearchQuery = ref('');\n    const auditAdminFilter = ref('');\n    const auditEntityTypeFilter = ref('');\n    const auditDateFrom = ref('');\n    const auditDateTo = ref('');\n    const showAuditDetailsModal = ref(false);\n    const selectedAuditLog = ref(null);\n\n    // Confirmation modal state\n    const showConfirmModal = ref(false);\n    const confirmTitle = ref('');\n    const confirmMessage = ref('');\n    const confirmOkText = ref('Да');\n    const confirmCancelText = ref('Отмена');\n    const confirmLoading = ref(false);\n    let confirmCallback = null;\n    const openConfirm = ({\n      title = 'Подтверждение',\n      message = '',\n      okText = 'Да',\n      cancelText = 'Отмена',\n      onConfirm = null\n    }) => {\n      confirmTitle.value = title;\n      confirmMessage.value = message;\n      confirmOkText.value = okText;\n      confirmCancelText.value = cancelText;\n      confirmCallback = onConfirm;\n      confirmLoading.value = false;\n      showConfirmModal.value = true;\n    };\n    const handleConfirmYes = async () => {\n      if (!confirmCallback) {\n        showConfirmModal.value = false;\n        return;\n      }\n      try {\n        confirmLoading.value = true;\n        await confirmCallback();\n      } catch (e) {\n        console.error('Confirm action error', e);\n      } finally {\n        confirmLoading.value = false;\n        showConfirmModal.value = false;\n      }\n    };\n    const handleConfirmNo = () => {\n      showConfirmModal.value = false;\n      confirmCallback = null;\n    };\n\n    // Methods\n    const loadData = async () => {\n      loadingStats.value = true;\n      try {\n        const response = await api.get('/admin/stats');\n        stats.value = response.data.stats;\n        user.value = authStore.user;\n      } catch (error) {\n        console.error('Ошибка загрузки статистики:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки данных'\n        });\n      } finally {\n        loadingStats.value = false;\n      }\n    };\n    const handleFileSelect = event => {\n      const files = Array.from(event.target.files);\n      addFiles(files);\n    };\n    const handleDrop = event => {\n      isDragover.value = false;\n      const files = Array.from(event.dataTransfer.files);\n      addFiles(files);\n    };\n    const addFiles = files => {\n      const excelFiles = files.filter(file => file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' || file.type === 'application/vnd.ms-excel' || file.name.endsWith('.xlsx') || file.name.endsWith('.xls'));\n      if (excelFiles.length !== files.length) {\n        notificationStore.addNotification({\n          type: 'warning',\n          message: 'Некоторые файлы не являются Excel файлами и были проигнорированы'\n        });\n      }\n      selectedFiles.value = [...selectedFiles.value, ...excelFiles];\n    };\n    const removeFile = index => {\n      selectedFiles.value.splice(index, 1);\n    };\n\n    // clearFiles removed — upload modal uses closeUploadModal to reset state\n\n    const filteredPartners = computed(() => {\n      let filtered = partners.value;\n\n      // Фильтр по статусу активности\n      if (partnerActiveFilter.value === 'active') {\n        filtered = filtered.filter(p => p.Active === 1 || p.Active === true);\n      } else if (partnerActiveFilter.value === 'inactive') {\n        filtered = filtered.filter(p => p.Active === 0 || p.Active === false);\n      }\n\n      // Фильтр по дню рождения в этом месяце\n      if (partnerBirthdayFilter.value) {\n        const currentMonth = new Date().getMonth();\n        filtered = filtered.filter(p => {\n          if (!p.BirthDate) return false;\n          const birthDate = new Date(p.BirthDate);\n          return birthDate.getMonth() === currentMonth;\n        });\n      }\n\n      // Поисковый фильтр\n      if (partnerSearchQuery.value) {\n        const query = partnerSearchQuery.value.toLowerCase();\n        filtered = filtered.filter(p => {\n          const name = (p.Name || p.name || '').toLowerCase();\n          const email = (p.Email || p.email || '').toLowerCase();\n          const inc = String(p.Inc || p.partnerId || '');\n          const alias = (p.Alias || p.alias || '').toLowerCase();\n          return name.includes(query) || email.includes(query) || inc.includes(query) || alias.includes(query);\n        });\n      }\n      return filtered;\n    });\n\n    // Фильтрация документов\n    const filteredDocuments = computed(() => {\n      let filtered = unpublishedClaims.value;\n\n      // Фильтр по партнёру\n      if (documentPartnerFilter.value) {\n        filtered = filtered.filter(doc => String(doc.partnerId) === String(documentPartnerFilter.value));\n      }\n\n      // Фильтр по диапазону дат загрузки\n      if (documentDateFrom.value) {\n        const fromDate = new Date(documentDateFrom.value);\n        fromDate.setHours(0, 0, 0, 0);\n        filtered = filtered.filter(doc => {\n          const docDate = new Date(doc.uploadedAt || doc.Created);\n          docDate.setHours(0, 0, 0, 0);\n          return docDate >= fromDate;\n        });\n      }\n      if (documentDateTo.value) {\n        const toDate = new Date(documentDateTo.value);\n        toDate.setHours(23, 59, 59, 999);\n        filtered = filtered.filter(doc => {\n          const docDate = new Date(doc.uploadedAt || doc.Created);\n          return docDate <= toDate;\n        });\n      }\n\n      // Поисковый фильтр по названию файла\n      if (documentSearchQuery.value) {\n        const query = documentSearchQuery.value.toLowerCase();\n        filtered = filtered.filter(doc => {\n          const fileName = (doc.fileName || doc.originalName || '').toLowerCase();\n          return fileName.includes(query);\n        });\n      }\n      return filtered;\n    });\n    const openUploadForPartner = partner => {\n      currentUploadPartnerId.value = partner.Inc;\n      currentUploadPartnerName.value = partner.Name;\n      selectedFiles.value = [];\n      uploadResults.value = [];\n      showUploadModal.value = true;\n    };\n    const closeUploadModal = () => {\n      showUploadModal.value = false;\n      selectedFiles.value = [];\n      uploadResults.value = [];\n      currentUploadPartnerId.value = null;\n      currentUploadPartnerName.value = '';\n    };\n    const uploadFilesForPartner = async () => {\n      if (selectedFiles.value.length === 0 || !currentUploadPartnerId.value) return;\n      uploading.value = true;\n      const formData = new FormData();\n\n      // Собираем массив partner IDs - все файлы для одного партнера\n      const partnerIds = [];\n\n      // Add files and collect partner IDs\n      selectedFiles.value.forEach(file => {\n        formData.append('files', file);\n        partnerIds.push(currentUploadPartnerId.value);\n      });\n\n      // Отправляем массив партнеров как JSON\n      formData.append('partnerIds', JSON.stringify(partnerIds));\n      try {\n        const response = await api.post('/admin/upload-files', formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        uploadResults.value = [...response.data.results.map(r => ({\n          ...r,\n          success: true\n        })), ...response.data.errors.map(e => ({\n          ...e,\n          success: false\n        }))];\n        notificationStore.addNotification({\n          type: 'success',\n          message: response.data.message\n        });\n        selectedFiles.value = [];\n        refreshDocuments();\n\n        // Redirect to partner documents to publish\n        const uploadedPartner = {\n          Inc: currentUploadPartnerId.value,\n          Name: currentUploadPartnerName.value\n        };\n        closeUploadModal();\n        await viewPartnerDocuments(uploadedPartner);\n      } catch (error) {\n        console.error('Ошибка загрузки файлов:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки файлов: ' + (error.response?.data?.message || error.message)\n        });\n      } finally {\n        uploading.value = false;\n      }\n    };\n    const refreshDocuments = async () => {\n      loadingDocuments.value = true;\n      try {\n        const endpoint = documentsFilter.value === 'unpublished' ? '/admin/unpublished-claims' : '/admin/published-claims';\n        const response = await api.get(endpoint);\n        unpublishedClaims.value = response.data.data;\n        selectedClaims.value = [];\n      } catch (error) {\n        console.error('Ошибка загрузки документов:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки документов'\n        });\n      } finally {\n        loadingDocuments.value = false;\n      }\n    };\n\n    // Auto upload functions (с определением партнёра из Excel)\n    const handleAutoUploadDrop = e => {\n      isAutoUploadDragover.value = false;\n      const files = Array.from(e.dataTransfer.files).filter(f => f.name.endsWith('.xlsx') || f.name.endsWith('.xls'));\n      autoUploadFiles.value = [...autoUploadFiles.value, ...files];\n    };\n    const handleAutoUploadFileSelect = e => {\n      const files = Array.from(e.target.files);\n      autoUploadFiles.value = [...autoUploadFiles.value, ...files];\n      e.target.value = ''; // Reset input\n    };\n    const removeAutoUploadFile = index => {\n      autoUploadFiles.value.splice(index, 1);\n    };\n    const uploadAutoFiles = async () => {\n      if (autoUploadFiles.value.length === 0) return;\n      autoUploading.value = true;\n      const formData = new FormData();\n      autoUploadFiles.value.forEach(file => {\n        formData.append('files', file);\n      });\n      try {\n        const response = await api.post('/admin/auto-upload-files', formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        autoUploadResults.value = [...response.data.results.map(r => ({\n          ...r,\n          success: true,\n          fileName: r.fileName || r.filename,\n          partnerName: r.partnerName\n        })), ...response.data.errors.map(e => ({\n          ...e,\n          success: false,\n          fileName: e.fileName || e.filename\n        }))];\n        const successCount = response.data.results.length;\n        const errorCount = response.data.errors.length;\n        if (successCount > 0) {\n          notificationStore.addNotification({\n            type: 'success',\n            message: `Успешно загружено: ${successCount} файл(ов)`\n          });\n        }\n        if (errorCount > 0) {\n          notificationStore.addNotification({\n            type: 'error',\n            message: `Ошибок: ${errorCount} файл(ов)`\n          });\n        }\n        autoUploadFiles.value = [];\n        refreshDocuments();\n      } catch (error) {\n        console.error('Ошибка автоматической загрузки:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки: ' + (error.response?.data?.message || error.message)\n        });\n      } finally {\n        autoUploading.value = false;\n      }\n    };\n    const publishDocument = async claimId => {\n      try {\n        await api.post('/admin/publish-claims', {\n          claimIds: [claimId]\n        });\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Документ успешно опубликован'\n        });\n        refreshDocuments();\n        loadData();\n      } catch (error) {\n        console.error('Ошибка публикации:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка публикации документа'\n        });\n      }\n    };\n    const publishSelectedDocuments = async () => {\n      if (selectedClaims.value.length === 0) return;\n      publishing.value = true;\n      try {\n        const response = await api.post('/admin/publish-claims', {\n          claimIds: selectedClaims.value\n        });\n        notificationStore.addNotification({\n          type: 'success',\n          message: response.data.message\n        });\n        refreshDocuments();\n        loadData();\n      } catch (error) {\n        console.error('Ошибка публикации:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка публикации документов'\n        });\n      } finally {\n        publishing.value = false;\n      }\n    };\n    const publishAllDocuments = async () => {\n      const allClaimIds = unpublishedClaims.value.map(claim => getClaimId(claim));\n      selectedClaims.value = allClaimIds;\n      await publishSelectedDocuments();\n    };\n    const unpublishDocument = async claimId => {\n      if (!claimId) {\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Не удалось определить ID документа'\n        });\n        return;\n      }\n      openConfirm({\n        title: 'Снятие публикации',\n        message: 'Вы уверены, что хотите снять публикацию этого документа? Партнёр больше не сможет его видеть.',\n        okText: 'Снять публикацию',\n        cancelText: 'Отмена',\n        onConfirm: async () => {\n          try {\n            await api.post('/admin/unpublish-claims', {\n              claimIds: [claimId]\n            });\n            notificationStore.addNotification({\n              type: 'success',\n              message: 'Публикация документа снята'\n            });\n            refreshDocuments();\n            loadData();\n          } catch (error) {\n            console.error('Ошибка снятия публикации:', error);\n            notificationStore.addNotification({\n              type: 'error',\n              message: 'Ошибка снятия публикации: ' + (error.response?.data?.message || error.message)\n            });\n            throw error;\n          }\n        }\n      });\n    };\n    const deleteDocument = async claimId => {\n      if (!claimId) {\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Не удалось определить ID документа'\n        });\n        return;\n      }\n      openConfirm({\n        title: 'Удаление документа',\n        message: 'Вы уверены, что хотите удалить этот документ?',\n        okText: 'Удалить',\n        cancelText: 'Отмена',\n        onConfirm: async () => {\n          try {\n            await api.delete(`/admin/claims/${claimId}`);\n            notificationStore.addNotification({\n              type: 'success',\n              message: 'Документ успешно удален'\n            });\n            refreshDocuments();\n            loadData();\n          } catch (error) {\n            console.error('Ошибка удаления:', error);\n            notificationStore.addNotification({\n              type: 'error',\n              message: 'Ошибка удаления документа: ' + (error.response?.data?.message || error.message)\n            });\n            throw error;\n          }\n        }\n      });\n    };\n\n    // Partner management methods\n    const editPartner = partner => {\n      partnerToEdit.value = {\n        Inc: partner.Inc,\n        name: partner.Name,\n        email: partner.Email,\n        telegram: partner.Telegram,\n        alias: partner.Alias || '',\n        birthDate: partner.BirthDate ? partner.BirthDate.split('T')[0] : '',\n        active: partner.Active !== 0,\n        newPassword: ''\n      };\n      showEditPartnerModal.value = true;\n    };\n    const updatePartner = async () => {\n      editingPartner.value = true;\n      try {\n        const updateData = {\n          name: partnerToEdit.value.name,\n          email: partnerToEdit.value.email,\n          telegram: partnerToEdit.value.telegram,\n          alias: partnerToEdit.value.alias,\n          birthDate: partnerToEdit.value.birthDate || null,\n          active: partnerToEdit.value.active ? 1 : 0\n        };\n        if (partnerToEdit.value.newPassword) {\n          updateData.password = partnerToEdit.value.newPassword;\n        }\n        await api.put(`/admin/partners/${partnerToEdit.value.Inc}`, updateData);\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Партнер успешно обновлен'\n        });\n        showEditPartnerModal.value = false;\n        partnerToEdit.value = null;\n        loadPartners();\n      } catch (error) {\n        console.error('Ошибка обновления партнера:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка обновления партнера: ' + (error.response?.data?.message || error.message)\n        });\n      } finally {\n        editingPartner.value = false;\n      }\n    };\n    const deletePartner = async partner => {\n      openConfirm({\n        title: 'Удаление партнера',\n        message: `Вы уверены, что хотите удалить партнера \"${partner.Name}\"? Это действие нельзя отменить.`,\n        okText: 'Удалить',\n        cancelText: 'Отмена',\n        onConfirm: async () => {\n          try {\n            await api.delete(`/admin/partners/${partner.Inc}`);\n            notificationStore.addNotification({\n              type: 'success',\n              message: 'Партнер успешно удален'\n            });\n            loadPartners();\n            loadData();\n          } catch (error) {\n            console.error('Ошибка удаления партнера:', error);\n            notificationStore.addNotification({\n              type: 'error',\n              message: 'Ошибка удаления партнера: ' + (error.response?.data?.message || error.message)\n            });\n            throw error;\n          }\n        }\n      });\n    };\n    const viewPartnerDocuments = async partner => {\n      partnerToEdit.value = partner;\n      loadingPartnerDocuments.value = true;\n      try {\n        const response = await api.get(`/admin/partners/${partner.Inc}/documents`);\n        partnerDocuments.value = response.data.documents;\n        showPartnerDocumentsModal.value = true;\n      } catch (error) {\n        console.error('Ошибка загрузки документов:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки документов партнера'\n        });\n      } finally {\n        loadingPartnerDocuments.value = false;\n      }\n    };\n    const getDocDate = doc => {\n      // try multiple possible fields, prioritize created from Partner sheet\n      return doc.created ?? doc.Created ?? doc.uploadedAt ?? doc.uploaded_at ?? doc.uploadedAtRaw ?? doc.publishedAt ?? doc.PublishedAt ?? doc.dateBeg ?? doc.DateBeg ?? doc.CreatedAt ?? null;\n    };\n    const isPublished = doc => {\n      if (!doc) return false;\n      if (doc.publishedAt || doc.PublishedAt) return true;\n      if (typeof doc.Published !== 'undefined') return Boolean(doc.Published);\n      if (typeof doc.published !== 'undefined') return Boolean(doc.published);\n      if (doc.Status) {\n        try {\n          return String(doc.Status).toLowerCase().includes('pub');\n        } catch (e) {\n          // ignore\n        }\n      }\n      return false;\n    };\n    const publishPartnerDocument = async doc => {\n      const id = getClaimId(doc) || doc.claimId || doc.ClaimId || doc.DocumentId || doc.inc;\n      if (!id) return;\n      try {\n        await api.post('/admin/publish-claims', {\n          claimIds: [id]\n        });\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Документ опубликован'\n        });\n        // reload list\n        await viewPartnerDocuments(partnerToEdit.value);\n        loadData();\n      } catch (error) {\n        console.error('Ошибка публикации документа партнера:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка публикации документа'\n        });\n      }\n    };\n    const confirmDeletePartnerDocument = doc => {\n      const published = isPublished(doc);\n      openConfirm({\n        title: published ? 'Удалить опубликованный документ' : 'Удалить документ',\n        message: published ? 'Документ опубликован. Удаление приведет к удалению опубликованной версии. Вы уверены?' : 'Вы уверены, что хотите удалить документ?',\n        okText: 'Удалить',\n        cancelText: 'Отмена',\n        onConfirm: async () => {\n          await deletePartnerDocument(doc);\n        }\n      });\n    };\n    const deletePartnerDocument = async doc => {\n      const id = getClaimId(doc) || doc.claimId || doc.ClaimId || doc.DocumentId || doc.inc;\n      if (!id) return;\n      try {\n        // If document is published, pass force=true to allow deletion\n        const force = isPublished(doc);\n        const url = `/admin/claims/${id}` + (force ? '?force=true' : '');\n        await api.delete(url);\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Документ удалён'\n        });\n        await viewPartnerDocuments(partnerToEdit.value);\n        loadData();\n      } catch (error) {\n        console.error('Ошибка удаления документа партнера:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка удаления документа'\n        });\n      }\n    };\n    const toggleSelectAll = () => {\n      if (selectedClaims.value.length === filteredDocuments.value.length && filteredDocuments.value.length > 0) {\n        selectedClaims.value = [];\n      } else {\n        selectedClaims.value = filteredDocuments.value.map(claim => getClaimId(claim));\n      }\n    };\n    const viewDocument = async claimId => {\n      try {\n        loadingCurrentDocument.value = true;\n        showViewDocumentModal.value = true;\n        const response = await api.get(`/admin/claims/${claimId}`);\n        currentDocument.value = response.data.data;\n        excelData.value = response.data.excelData;\n      } catch (error) {\n        console.error('Ошибка загрузки документа:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки документа'\n        });\n        showViewDocumentModal.value = false;\n      } finally {\n        loadingCurrentDocument.value = false;\n      }\n    };\n    const downloadDocument = async claimId => {\n      try {\n        const response = await api.get(`/admin/claims/${claimId}/download`, {\n          responseType: 'blob'\n        });\n\n        // Получаем имя файла из заголовка или используем имя из currentDocument\n        const contentDisposition = response.headers['content-disposition'] || response.headers['Content-Disposition'];\n        let filename = getDisplayFileName(currentDocument.value) || 'document.xlsx';\n        if (contentDisposition) {\n          // Try RFC 5987 filename* first\n          const filenameStarMatch = contentDisposition.match(/filename\\*=(?:[\\w'']*)?([^;\\n]+)/i);\n          if (filenameStarMatch && filenameStarMatch[1]) {\n            try {\n              // filename*=UTF-8''%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80.xlsx\n              const v = filenameStarMatch[1].trim().replace(/^UTF-8''/i, '');\n              filename = decodeURIComponent(v.replace(/\"/g, ''));\n            } catch (e) {\n              // ignore\n            }\n          } else {\n            const filenameMatch = contentDisposition.match(/filename[^;=\\n]*=(['\"]?)([^'\"\\n]*?)\\1/);\n            if (filenameMatch && filenameMatch[2]) {\n              filename = filenameMatch[2];\n            }\n          }\n        }\n        // If filename still not usable, build fallback (ensures extension)\n        if (!filename || filename === '—') {\n          filename = buildFallbackFilename(currentDocument.value);\n        }\n\n        // Создаем ссылку для скачивания\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download', filename);\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n        window.URL.revokeObjectURL(url);\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Файл успешно скачан'\n        });\n      } catch (error) {\n        console.error('Ошибка скачивания:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка скачивания файла'\n        });\n      }\n    };\n    const loadPartners = async () => {\n      loadingPartners.value = true;\n      try {\n        const response = await api.get('/admin/partners');\n        partners.value = response.data.data;\n      } catch (error) {\n        console.error('Ошибка загрузки партнеров:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки партнеров'\n        });\n      } finally {\n        loadingPartners.value = false;\n      }\n    };\n    const createPartner = async () => {\n      creatingPartner.value = true;\n      try {\n        await api.post('/admin/partners', newPartner.value);\n        let message = 'Партнер успешно создан';\n        notificationStore.addNotification({\n          type: 'success',\n          message: message\n        });\n        showCreatePartnerModal.value = false;\n        newPartner.value = {\n          name: '',\n          email: '',\n          telegram: '',\n          alias: '',\n          password: '',\n          birthDate: '',\n          active: true\n        };\n        loadPartners();\n        loadData();\n      } catch (error) {\n        console.error('Ошибка создания партнера:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка создания партнера: ' + (error.response?.data?.message || error.message)\n        });\n      } finally {\n        creatingPartner.value = false;\n      }\n    };\n\n    // Utility functions\n    const formatFileSize = bytes => {\n      if (bytes === 0) return '0 Bytes';\n      if (bytes == null || isNaN(Number(bytes))) return '—';\n      const b = Number(bytes);\n      const k = 1024;\n      const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n      const i = Math.floor(Math.log(b) / Math.log(k));\n      const idx = Math.min(Math.max(i, 0), sizes.length - 1);\n      return parseFloat((b / Math.pow(k, idx)).toFixed(2)) + ' ' + sizes[idx];\n    };\n\n    // ============= МЕТОДЫ ДЛЯ УПРАВЛЕНИЯ АДМИНАМИ (только для superadmin) =============\n\n    const loadAdmins = async () => {\n      if (!isSuperAdmin.value) return;\n      loadingAdmins.value = true;\n      try {\n        const response = await api.get('/admin/admins');\n        admins.value = response.data.admins;\n      } catch (error) {\n        console.error('Ошибка загрузки админов:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка загрузки списка администраторов'\n        });\n      } finally {\n        loadingAdmins.value = false;\n      }\n    };\n    const createAdmin = async () => {\n      if (!newAdmin.value.username || !newAdmin.value.email || !newAdmin.value.password) {\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Заполните все обязательные поля'\n        });\n        return;\n      }\n      creatingAdmin.value = true;\n      try {\n        await api.post('/admin/admins', newAdmin.value);\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Администратор успешно создан'\n        });\n        showCreateAdminModal.value = false;\n        newAdmin.value = {\n          username: '',\n          email: '',\n          password: ''\n        };\n        await loadAdmins();\n      } catch (error) {\n        console.error('Ошибка создания админа:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: error.response?.data?.message || 'Ошибка создания администратора'\n        });\n      } finally {\n        creatingAdmin.value = false;\n      }\n    };\n    const openChangeAdminPasswordModal = admin => {\n      adminToEdit.value = admin;\n      newAdminPassword.value = '';\n      showChangeAdminPasswordModal.value = true;\n    };\n    const changeAdminPassword = async () => {\n      if (!newAdminPassword.value || newAdminPassword.value.length < 6) {\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Пароль должен быть минимум 6 символов'\n        });\n        return;\n      }\n      changingPassword.value = true;\n      try {\n        await api.put(`/admin/admins/${adminToEdit.value.inc}/password`, {\n          password: newAdminPassword.value\n        });\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Пароль администратора изменен'\n        });\n        showChangeAdminPasswordModal.value = false;\n        newAdminPassword.value = '';\n        adminToEdit.value = null;\n      } catch (error) {\n        console.error('Ошибка смены пароля:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка смены пароля'\n        });\n      } finally {\n        changingPassword.value = false;\n      }\n    };\n    const confirmDeleteAdmin = admin => {\n      openConfirm({\n        title: 'Удалить администратора',\n        message: `Вы уверены, что хотите удалить администратора \"${admin.username}\"?`,\n        confirmText: 'Удалить',\n        onConfirm: () => deleteAdmin(admin)\n      });\n    };\n    const deleteAdmin = async admin => {\n      try {\n        await api.delete(`/admin/admins/${admin.inc}`);\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Администратор удален'\n        });\n        await loadAdmins();\n      } catch (error) {\n        console.error('Ошибка удаления админа:', error);\n        notificationStore.addNotification({\n          type: 'error',\n          message: error.response?.data?.message || 'Ошибка удаления администратора'\n        });\n      }\n    };\n\n    // ============= УТИЛИТЫ =============\n\n    const toTimestampMs = value => {\n      if (value == null || value === '') return null;\n      // If numeric (seconds or milliseconds)\n      if (typeof value === 'number') {\n        // If looks like seconds (<= 10^11), convert to ms\n        return value < 1e12 ? value * 1000 : value;\n      }\n      // If string of digits\n      if (/^\\d+$/.test(String(value))) {\n        const n = parseInt(value, 10);\n        return n < 1e12 ? n * 1000 : n;\n      }\n      // If string looks like 'YYYY-MM-DD HH:mm:ss' or 'YYYY/MM/DD HH:mm:ss', treat as UTC\n      if (typeof value === 'string' && /^\\d{4}[-/]\\d{2}[-/]\\d{2}[ T]\\d{2}:\\d{2}:\\d{2}$/.test(value)) {\n        // normalize to ISO and append Z to force UTC\n        const iso = value.replace(' ', 'T').replace(/\\//g, '-') + 'Z';\n        const parsedIso = Date.parse(iso);\n        return isNaN(parsedIso) ? null : parsedIso;\n      }\n      // Otherwise let Date parse the string (ISO, etc.)\n      const parsed = Date.parse(value);\n      return isNaN(parsed) ? null : parsed;\n    };\n    const formatDate = date => {\n      const ts = toTimestampMs(date);\n      if (!ts) return '';\n      return new Date(ts).toLocaleDateString('ru-RU', {\n        timeZone: 'Europe/Moscow'\n      });\n    };\n    const formatDateTime = date => {\n      const ts = toTimestampMs(date);\n      if (!ts) return '';\n      return new Date(ts).toLocaleString('ru-RU', {\n        timeZone: 'Europe/Moscow',\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    };\n    const formatPeriod = (dateFrom, dateTo) => {\n      if (!dateFrom || !dateTo) return '—';\n      const from = new Date(dateFrom).toLocaleDateString('ru-RU');\n      const to = new Date(dateTo).toLocaleDateString('ru-RU');\n      return `${from} — ${to}`;\n    };\n\n    // Format currency helper (kept for reuse if needed elsewhere)\n    const formatCurrency = amount => {\n      if (amount === null || amount === undefined) return '—';\n      return new Intl.NumberFormat('ru-RU', {\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      }).format(amount);\n    };\n\n    // Helper to get claim id regardless of backend field naming\n    const getClaimId = claim => {\n      if (!claim) return null;\n      return claim.Inc ?? claim.inc ?? claim.id ?? claim.ClaimId ?? null;\n    };\n\n    // Friendly filename getter with fallbacks\n    const getDisplayFileName = doc => {\n      if (!doc) return '—';\n      const name = doc.fileName || doc.FileName || doc.originalName || doc.originalname || doc.filename || doc.FileNameDownload;\n      if (name && String(name).trim() !== '') return name;\n      return buildFallbackFilename(doc);\n    };\n\n    // Build a readable, filesystem-safe fallback filename when original name is missing\n    const buildFallbackFilename = doc => {\n      if (!doc) return 'document.xlsx';\n      const parts = [];\n      const type = doc.type || doc.Type || '';\n      const partner = doc.PartnerName || doc.partnerName || doc.Name || doc.name || '';\n      const inc = doc.inc ?? doc.Inc ?? doc.id ?? '';\n      if (type) parts.push(String(type));\n      if (partner) parts.push(String(partner));\n      if (inc) parts.push(`#${inc}`);\n\n      // Period: try dateBeg/dateEnd\n      const from = doc.dateBeg ?? doc.DateBeg ?? doc.dateBegRaw ?? null;\n      const to = doc.dateEnd ?? doc.DateEnd ?? doc.dateEndRaw ?? null;\n      if (from && to) {\n        const f = toTimestampMs(from);\n        const t = toTimestampMs(to);\n        if (f && t) {\n          const d1 = new Date(f);\n          const d2 = new Date(t);\n          const pf = `${d1.getFullYear()}${String(d1.getMonth() + 1).padStart(2, '0')}`;\n          const pt = `${d2.getFullYear()}${String(d2.getMonth() + 1).padStart(2, '0')}`;\n          parts.push(`${pf}-${pt}`);\n        }\n      }\n      let filename = parts.join(' - ');\n      if (!filename) filename = `document${inc ? `-${inc}` : ''}`;\n      // sanitize: remove slashes and quotes\n      filename = filename.replace(/[\\\\/:*?\"<>|]/g, '').trim();\n      // append default extension\n      if (!/\\.[a-z0-9]+$/i.test(filename)) filename += '.xlsx';\n      return filename;\n    };\n    const getStatusLabel = status => {\n      const labels = {\n        uploaded: 'Загружен',\n        published: 'Опубликован',\n        error: 'Ошибка'\n      };\n      return labels[status] || status;\n    };\n\n    // Watch activeTab to load data\n    const handleTabChange = () => {\n      if (activeTab.value === 'documents') {\n        refreshDocuments();\n      } else if (activeTab.value === 'partners') {\n        loadPartners();\n      } else if (activeTab.value === 'admins' && isSuperAdmin.value) {\n        loadAdmins();\n      }\n    };\n\n    // Lifecycle\n    onMounted(() => {\n      loadData();\n      handleTabChange();\n      // ensure helper is treated as used by linters\n      void formatCurrency(0);\n    });\n\n    // Watch activeTab\n    watch(activeTab, handleTabChange);\n    const __returned__ = {\n      authStore,\n      notificationStore,\n      user,\n      stats,\n      activeTab,\n      isSuperAdmin,\n      tabs,\n      selectedFiles,\n      uploading,\n      uploadResults,\n      isDragover,\n      autoUploadFiles,\n      autoUploading,\n      autoUploadResults,\n      isAutoUploadDragover,\n      unpublishedClaims,\n      selectedClaims,\n      loadingDocuments,\n      publishing,\n      loadingStats,\n      loadingPartnerDocuments,\n      documentsFilter,\n      documentSearchQuery,\n      documentPartnerFilter,\n      documentDateFrom,\n      documentDateTo,\n      setDocumentsFilter,\n      currentUploadPartnerId,\n      currentUploadPartnerName,\n      showUploadModal,\n      partners,\n      loadingPartners,\n      partnerSearchQuery,\n      partnerActiveFilter,\n      partnerBirthdayFilter,\n      showCreatePartnerModal,\n      creatingPartner,\n      showEditPartnerModal,\n      editingPartner,\n      partnerToEdit,\n      showPartnerDocumentsModal,\n      partnerDocuments,\n      showViewDocumentModal,\n      currentDocument,\n      loadingCurrentDocument,\n      excelData,\n      newPartner,\n      admins,\n      loadingAdmins,\n      showCreateAdminModal,\n      creatingAdmin,\n      showChangeAdminPasswordModal,\n      changingPassword,\n      adminToEdit,\n      newAdminPassword,\n      newAdmin,\n      auditLogs,\n      loadingAuditLogs,\n      auditSearchQuery,\n      auditAdminFilter,\n      auditEntityTypeFilter,\n      auditDateFrom,\n      auditDateTo,\n      showAuditDetailsModal,\n      selectedAuditLog,\n      showConfirmModal,\n      confirmTitle,\n      confirmMessage,\n      confirmOkText,\n      confirmCancelText,\n      confirmLoading,\n      get confirmCallback() {\n        return confirmCallback;\n      },\n      set confirmCallback(v) {\n        confirmCallback = v;\n      },\n      openConfirm,\n      handleConfirmYes,\n      handleConfirmNo,\n      loadData,\n      handleFileSelect,\n      handleDrop,\n      addFiles,\n      removeFile,\n      filteredPartners,\n      filteredDocuments,\n      openUploadForPartner,\n      closeUploadModal,\n      uploadFilesForPartner,\n      refreshDocuments,\n      handleAutoUploadDrop,\n      handleAutoUploadFileSelect,\n      removeAutoUploadFile,\n      uploadAutoFiles,\n      publishDocument,\n      publishSelectedDocuments,\n      publishAllDocuments,\n      unpublishDocument,\n      deleteDocument,\n      editPartner,\n      updatePartner,\n      deletePartner,\n      viewPartnerDocuments,\n      getDocDate,\n      isPublished,\n      publishPartnerDocument,\n      confirmDeletePartnerDocument,\n      deletePartnerDocument,\n      toggleSelectAll,\n      viewDocument,\n      downloadDocument,\n      loadPartners,\n      createPartner,\n      formatFileSize,\n      loadAdmins,\n      createAdmin,\n      openChangeAdminPasswordModal,\n      changeAdminPassword,\n      confirmDeleteAdmin,\n      deleteAdmin,\n      toTimestampMs,\n      formatDate,\n      formatDateTime,\n      formatPeriod,\n      formatCurrency,\n      getClaimId,\n      getDisplayFileName,\n      buildFallbackFilename,\n      getStatusLabel,\n      handleTabChange,\n      ref,\n      onMounted,\n      computed,\n      watch,\n      AppLoader,\n      AppNotifications,\n      ExcelViewer,\n      get useAuthStore() {\n        return useAuthStore;\n      },\n      get useNotificationStore() {\n        return useNotificationStore;\n      },\n      get api() {\n        return api;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","watch","AppLoader","AppNotifications","ExcelViewer","useAuthStore","useNotificationStore","api","authStore","notificationStore","user","stats","activeTab","isSuperAdmin","adminRole","tabs","baseTabs","id","label","value","push","selectedFiles","uploading","uploadResults","isDragover","autoUploadFiles","autoUploading","autoUploadResults","isAutoUploadDragover","unpublishedClaims","selectedClaims","loadingDocuments","publishing","loadingStats","loadingPartnerDocuments","documentsFilter","documentSearchQuery","documentPartnerFilter","documentDateFrom","documentDateTo","setDocumentsFilter","refreshDocuments","currentUploadPartnerId","currentUploadPartnerName","showUploadModal","partners","loadingPartners","partnerSearchQuery","partnerActiveFilter","partnerBirthdayFilter","showCreatePartnerModal","creatingPartner","showEditPartnerModal","editingPartner","partnerToEdit","showPartnerDocumentsModal","partnerDocuments","showViewDocumentModal","currentDocument","loadingCurrentDocument","excelData","newPartner","name","email","telegram","alias","password","birthDate","active","admins","loadingAdmins","showCreateAdminModal","creatingAdmin","showChangeAdminPasswordModal","changingPassword","adminToEdit","newAdminPassword","newAdmin","username","auditLogs","loadingAuditLogs","auditSearchQuery","auditAdminFilter","auditEntityTypeFilter","auditDateFrom","auditDateTo","showAuditDetailsModal","selectedAuditLog","showConfirmModal","confirmTitle","confirmMessage","confirmOkText","confirmCancelText","confirmLoading","confirmCallback","openConfirm","title","message","okText","cancelText","onConfirm","handleConfirmYes","e","console","error","handleConfirmNo","loadData","response","get","data","addNotification","type","handleFileSelect","event","files","Array","from","target","addFiles","handleDrop","dataTransfer","excelFiles","filter","file","endsWith","length","removeFile","index","splice","filteredPartners","filtered","p","Active","currentMonth","Date","getMonth","BirthDate","query","toLowerCase","Name","Email","inc","String","Inc","partnerId","Alias","includes","filteredDocuments","doc","fromDate","setHours","docDate","uploadedAt","Created","toDate","fileName","originalName","openUploadForPartner","partner","closeUploadModal","uploadFilesForPartner","formData","FormData","partnerIds","forEach","append","JSON","stringify","post","headers","results","map","r","success","errors","uploadedPartner","viewPartnerDocuments","endpoint","handleAutoUploadDrop","f","handleAutoUploadFileSelect","removeAutoUploadFile","uploadAutoFiles","filename","partnerName","successCount","errorCount","publishDocument","claimId","claimIds","publishSelectedDocuments","publishAllDocuments","allClaimIds","claim","getClaimId","unpublishDocument","deleteDocument","delete","editPartner","Telegram","split","newPassword","updatePartner","updateData","put","loadPartners","deletePartner","documents","getDocDate","created","uploaded_at","uploadedAtRaw","publishedAt","PublishedAt","dateBeg","DateBeg","CreatedAt","isPublished","Published","Boolean","published","Status","publishPartnerDocument","ClaimId","DocumentId","confirmDeletePartnerDocument","deletePartnerDocument","force","url","toggleSelectAll","viewDocument","downloadDocument","responseType","contentDisposition","getDisplayFileName","filenameStarMatch","match","v","trim","replace","decodeURIComponent","filenameMatch","buildFallbackFilename","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","remove","revokeObjectURL","createPartner","formatFileSize","bytes","isNaN","Number","b","k","sizes","i","Math","floor","log","idx","min","max","parseFloat","pow","toFixed","loadAdmins","createAdmin","openChangeAdminPasswordModal","admin","changeAdminPassword","confirmDeleteAdmin","confirmText","deleteAdmin","toTimestampMs","test","n","parseInt","iso","parsedIso","parse","parsed","formatDate","date","ts","toLocaleDateString","timeZone","formatDateTime","toLocaleString","year","month","day","hour","minute","formatPeriod","dateFrom","dateTo","to","formatCurrency","amount","undefined","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","FileName","originalname","FileNameDownload","parts","Type","PartnerName","dateBegRaw","dateEnd","DateEnd","dateEndRaw","t","d1","d2","pf","getFullYear","padStart","pt","join","getStatusLabel","status","labels","uploaded","handleTabChange"],"sources":["/Users/vadim/Desktop/freedom-group/frontend/src/views/AdminDashboard.vue"],"sourcesContent":["<template>\n  <div class=\"admin-dashboard\">\n    <!-- Main content -->\n    <div class=\"dashboard-container\">\n      <!-- Stats cards -->\n          <div v-if=\"loadingStats\">\n            <AppLoader />\n          </div>\n          <div v-else class=\"stats-grid\">\n        <div class=\"stat-card\">\n          <div class=\"stat-content\">\n            <div class=\"stat-value\">{{ stats.totalPartners || 0 }}</div>\n            <div class=\"stat-label\">Всего партнеров</div>\n          </div>\n        </div>\n        \n        \n        <div class=\"stat-card\">\n          <div class=\"stat-content\">\n            <div class=\"stat-value\">{{ stats.documentsThisMonth || 0 }}</div>\n            <div class=\"stat-label\">Документов за месяц</div>\n          </div>\n        </div>\n        \n        <div class=\"stat-card\">\n          <div class=\"stat-content\">\n            <div class=\"stat-value\">{{ stats.unpublishedDocuments || 0 }}</div>\n            <div class=\"stat-label\">К публикации</div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Navigation tabs -->\n      <div class=\"tabs\">\n        <button \n          v-for=\"tab in tabs\" \n          :key=\"tab.id\"\n          @click=\"activeTab = tab.id\"\n          :class=\"['tab', { active: activeTab === tab.id }]\"\n        >\n          {{ tab.label }}\n        </button>\n      </div>\n      \n      <!-- Documents Tab -->\n      <div v-if=\"activeTab === 'documents'\" class=\"tab-content\">\n        <div class=\"documents-section\">\n          <div class=\"section-header\">\n            <h3>Все документы</h3>\n                    <div class=\"actions\">\n                      <div class=\"doc-filter\">\n                        <button :class=\"['btn-small', { active: documentsFilter === 'unpublished' }]\" @click=\"setDocumentsFilter('unpublished')\">Загруженные</button>\n                        <button :class=\"['btn-small', { active: documentsFilter === 'published' }]\" @click=\"setDocumentsFilter('published')\">Опубликованные</button>\n                      </div>\n              <button @click=\"refreshDocuments\" class=\"btn btn-secondary\">\n                <img src=\"@/assets/refresh.png\" alt=\"refresh\" width=\"18\" height=\"18\" class=\"icon-img-invert\" />\n              </button>\n              <button \n                v-if=\"documentsFilter === 'unpublished'\"\n                @click=\"publishAllDocuments\" \n                :disabled=\"!unpublishedClaims.length || publishing\"\n                class=\"btn btn-primary\"\n              >\n                <i v-if=\"publishing\" class=\"fas fa-spinner fa-spin\"></i>\n                Опубликовать все ({{ unpublishedClaims.length }})\n              </button>\n            </div>\n          </div>\n          \n          <!-- Фильтры документов -->\n          <div class=\"filters-bar\">\n            <div class=\"filter-group\">\n              <label>Поиск:</label>\n              <input\n                v-model=\"documentSearchQuery\"\n                type=\"text\"\n                placeholder=\"Название файла...\"\n                class=\"filter-input\"\n              />\n            </div>\n            \n            <div class=\"filter-group\">\n              <label>Партнёр:</label>\n              <select v-model=\"documentPartnerFilter\" class=\"filter-select\">\n                <option value=\"\">Все партнёры</option>\n                <option v-for=\"partner in partners\" :key=\"partner.Inc\" :value=\"partner.Inc\">\n                  {{ partner.Name }}\n                </option>\n              </select>\n            </div>\n            \n            <div class=\"filter-group\">\n              <label>Дата от:</label>\n              <input\n                v-model=\"documentDateFrom\"\n                type=\"date\"\n                class=\"filter-input\"\n              />\n            </div>\n            \n            <div class=\"filter-group\">\n              <label>до:</label>\n              <input\n                v-model=\"documentDateTo\"\n                type=\"date\"\n                class=\"filter-input\"\n              />\n            </div>\n            \n            <div class=\"filter-stats\">\n              Показано: {{ filteredDocuments.length }} из {{ unpublishedClaims.length }}\n            </div>\n          </div>\n          \n          <AppLoader v-if=\"loadingDocuments\" />\n          \n          <div v-else-if=\"filteredDocuments.length === 0\" class=\"empty-state\">\n            <div class=\"empty-icon\">\n              <img src=\"@/assets/docs.png\" alt=\"docs\" width=\"32\" height=\"32\" />\n            </div>\n            <h3>{{ unpublishedClaims.length === 0 ? 'Нет документов для публикации' : 'Ничего не найдено' }}</h3>\n            <p>{{ unpublishedClaims.length === 0 ? 'Все загруженные документы уже опубликованы' : 'Попробуйте изменить параметры фильтрации' }}</p>\n          </div>\n          \n          <table v-else class=\"documents-table\">\n            <thead>\n              <tr>\n                <th>\n                  <input \n                    type=\"checkbox\" \n                    :checked=\"selectedClaims.length === filteredDocuments.length && filteredDocuments.length > 0\"\n                    @change=\"toggleSelectAll\"\n                  />\n                </th>\n                <th>Файл</th>\n                <th>Код партнера</th>\n                <th>Имя партнера</th>\n                <th>Дата создания</th>\n                <th>Период</th>\n                <th>Статус</th>\n                <th>Действия</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"claim in filteredDocuments\" :key=\"getClaimId(claim)\">\n                <td data-label=\"Выбрать\">\n                  <input \n                    type=\"checkbox\" \n                    :value=\"getClaimId(claim)\"\n                    v-model=\"selectedClaims\"\n                  />\n                </td>\n                <td data-label=\"Файл\">{{ claim.FileName || claim.fileName || claim.originalName || '—' }}</td>\n                <td data-label=\"Код партнера\">{{ claim.Partner ?? claim.partnerId ?? claim.Inc ?? claim.inc ?? '—' }}</td>\n                <td data-label=\"Имя партнера\">{{ claim.PartnerName ?? claim.PartnerName ?? claim.Name ?? claim.name ?? '—' }}</td>\n                <td data-label=\"Дата создания\">{{ formatDate(claim.Created || claim.created || claim.Cdate || claim.uploadedAt || claim.uploaded_at || claim.createdAt) }}</td>\n                <td data-label=\"Период\">{{ formatPeriod(claim.DateBeg || claim.dateBeg || claim.dateBegRaw, claim.DateEnd || claim.dateEnd || claim.dateEndRaw) }}</td>\n                <td data-label=\"Статус\">\n                  <span :class=\"['status', claim.Status || claim.status || (claim.publishedAt || claim.PublishedAt ? 'published' : 'uploaded')]\">\n                    {{ getStatusLabel(claim.Status ?? claim.status ?? (claim.publishedAt || claim.PublishedAt ? 'published' : 'uploaded')) }}\n                  </span>\n                </td>\n                <td data-label=\"Действия\">\n                  <div class=\"action-buttons\">\n                    <template v-if=\"documentsFilter === 'unpublished'\">\n                      <button @click=\"publishDocument(getClaimId(claim))\" class=\"btn btn-sm btn-primary\">\n                        Опубликовать\n                      </button>\n                      <button @click=\"deleteDocument(getClaimId(claim))\" class=\"btn btn-sm btn-outline-blue\">\n                        Удалить\n                      </button>\n                    </template>\n                    <template v-else>\n                      <button @click=\"viewDocument(getClaimId(claim))\" class=\"btn btn-sm btn-outline-blue\">\n                        Просмотр\n                      </button>\n                      <button @click=\"unpublishDocument(getClaimId(claim))\" class=\"btn btn-sm btn-secondary\">\n                        Снять публикацию\n                      </button>\n                      <button @click=\"deleteDocument(getClaimId(claim))\" class=\"btn btn-sm btn-danger\">\n                        Удалить\n                      </button>\n                    </template>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          \n          <!-- Bulk actions -->\n          <div v-if=\"selectedClaims.length > 0 && documentsFilter === 'unpublished'\" class=\"bulk-actions\">\n            <span>Выбрано: {{ selectedClaims.length }}</span>\n            <button @click=\"publishSelectedDocuments\" class=\"btn btn-primary\">\n              Опубликовать выбранные\n            </button>\n            <button @click=\"selectedClaims = []\" class=\"btn btn-outline-blue\">\n              Снять выделение\n            </button>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Partners Tab -->\n      <div v-if=\"activeTab === 'partners'\" class=\"tab-content\">\n        <div class=\"partners-section\">\n          <div class=\"section-header\">\n            <h3>Управление партнерами</h3>\n            <div class=\"header-actions\">\n              <input\n                v-model=\"partnerSearchQuery\"\n                type=\"text\"\n                placeholder=\"Поиск по имени, email, коду или логину...\"\n                class=\"search-input-header\"\n              />\n              <button @click=\"showCreatePartnerModal = true\" class=\"btn btn-primary\">\n                <img src=\"@/assets/add.png\" alt=\"add\" width=\"18\" height=\"18\" class=\"icon-img-invert\" />\n              </button>\n            </div>\n          </div>\n          \n          <!-- Фильтры партнёров -->\n          <div class=\"filters-bar\">\n            <div class=\"filter-group\">\n              <label>Статус:</label>\n              <select v-model=\"partnerActiveFilter\" class=\"filter-select\">\n                <option value=\"all\">Все</option>\n                <option value=\"active\">Активные</option>\n                <option value=\"inactive\">Неактивные</option>\n              </select>\n            </div>\n            \n            <div class=\"filter-group\">\n              <label class=\"checkbox-label\">\n                <input \n                  v-model=\"partnerBirthdayFilter\" \n                  type=\"checkbox\"\n                />\n                <span>День рождения в этом месяце</span>\n              </label>\n            </div>\n            \n            <div class=\"filter-stats\">\n              Показано: {{ filteredPartners.length }} из {{ partners.length }}\n            </div>\n          </div>\n          \n          <AppLoader v-if=\"loadingPartners\" />\n          \n          <table v-else class=\"partners-table\">\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Имя</th>\n                <th>Email</th>\n                <th>Chat ID</th>\n                <th>Логин</th>\n                <th>Последний вход</th>\n                <th>Создан</th>\n                <th>Действия</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"partner in filteredPartners\" :key=\"partner.Inc\">\n                <td data-label=\"ID\">{{ partner.Inc }}</td>\n                <td data-label=\"Имя\">{{ partner.Name }}</td>\n                <td data-label=\"Email\">{{ partner.Email }}</td>\n                <td data-label=\"Chat ID\">{{ partner.Telegram || '—' }}</td>\n                <td data-label=\"Логин\">{{ partner.Alias }}</td>\n                <td data-label=\"Последний вход\">{{ formatDateTime(partner.LastVisit) || '—' }}</td>\n                <td data-label=\"Создан\">{{ formatDate(partner.CreatedAt) }}</td>\n                <td data-label=\"Действия\">\n                  <div class=\"action-buttons\">\n                    <button @click=\"openUploadForPartner(partner)\" class=\"btn-icon btn-upload\" title=\"Загрузить файлы\">\n                      <img src=\"@/assets/upload.png\" alt=\"upload\" width=\"18\" height=\"18\" />\n                    </button>\n                    <button @click=\"editPartner(partner)\" class=\"btn-icon btn-edit\" title=\"Редактировать\">\n                      <img src=\"@/assets/edit.png\" alt=\"edit\" width=\"18\" height=\"18\" />\n                    </button>\n                    <button @click=\"viewPartnerDocuments(partner)\" class=\"btn-icon btn-docs\" title=\"Документы\">\n                      <img src=\"@/assets/docs.png\" alt=\"docs\" width=\"18\" height=\"18\" />\n                    </button>\n                    <button @click=\"deletePartner(partner)\" class=\"btn-icon btn-delete\" title=\"Удалить\">\n                      <img src=\"@/assets/delete.png\" alt=\"delete\" width=\"18\" height=\"18\" />\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Upload Tab -->\n      <div v-if=\"activeTab === 'upload'\" class=\"tab-content\">\n        <div class=\"upload-section\">        \n          <div \n            class=\"upload-area\"\n            :class=\"{ dragover: isAutoUploadDragover }\"\n            @drop.prevent=\"handleAutoUploadDrop\"\n            @dragover.prevent=\"isAutoUploadDragover = true\"\n            @dragleave=\"isAutoUploadDragover = false\"\n            @click=\"$refs.autoUploadInput.click()\"\n          >\n            <div class=\"upload-content\">\n              <img src=\"@/assets/upload.png\" alt=\"upload\" width=\"48\" height=\"48\" />\n              <p>Перетащите файлы сюда или нажмите для выбора</p>\n              <span class=\"upload-hint\">Можно загружать несколько файлов одновременно</span>\n            </div>\n            <input \n              type=\"file\" \n              ref=\"autoUploadInput\"\n              @change=\"handleAutoUploadFileSelect\" \n              accept=\".xlsx,.xls\"\n              multiple\n              style=\"display: none\"\n            />\n          </div>\n          \n          <!-- Selected files preview -->\n          <div v-if=\"autoUploadFiles.length > 0\" class=\"selected-files\">\n            <h4>Выбранные файлы ({{ autoUploadFiles.length }})</h4>\n            <div class=\"files-list\">\n              <div v-for=\"(file, index) in autoUploadFiles\" :key=\"index\" class=\"file-item\">\n                <img src=\"@/assets/docs.png\" alt=\"file\" width=\"24\" height=\"24\" />\n                <div class=\"file-info\">\n                  <span class=\"file-name\">{{ file.name }}</span>\n                  <span class=\"file-size\">{{ formatFileSize(file.size) }}</span>\n                </div>\n                <button @click=\"removeAutoUploadFile(index)\" class=\"btn-icon btn-delete\">\n                  <img src=\"@/assets/delete.png\" alt=\"delete\" width=\"18\" height=\"18\" />\n                </button>\n              </div>\n            </div>\n            <div class=\"upload-actions\">\n              <button @click=\"autoUploadFiles = []\" class=\"btn btn-secondary\">\n                Очистить\n              </button>\n              <button @click=\"uploadAutoFiles\" :disabled=\"autoUploading\" class=\"btn btn-primary\">\n                <i v-if=\"autoUploading\" class=\"fas fa-spinner fa-spin\"></i>\n                {{ autoUploading ? 'Загрузка...' : 'Загрузить файлы' }}\n              </button>\n            </div>\n          </div>\n          \n          <!-- Upload results -->\n          <div v-if=\"autoUploadResults.length > 0\" class=\"upload-results\">\n            <h4>Результаты загрузки</h4>\n            <div class=\"results-list\">\n              <div \n                v-for=\"(result, index) in autoUploadResults\" \n                :key=\"index\" \n                :class=\"['result-item', result.success ? 'success' : 'error']\"\n              >\n                <div class=\"result-icon\">\n                  {{ result.success ? '✅' : '❌' }}\n                </div>\n                <div class=\"result-info\">\n                  <span class=\"result-file\">{{ result.fileName }}</span>\n                  <span class=\"result-message\">{{ result.message }}</span>\n                  <span v-if=\"result.partnerName\" class=\"result-partner\">Партнёр: {{ result.partnerName }}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Admins Tab (только для superadmin) -->\n      <div v-if=\"activeTab === 'admins' && isSuperAdmin\" class=\"tab-content\">\n        <div class=\"admins-section\">\n          <div class=\"section-header\">\n            <h3>Управление администраторами</h3>\n            <button @click=\"showCreateAdminModal = true\" class=\"btn btn-primary\">\n              <img src=\"@/assets/add.png\" alt=\"add\" width=\"18\" height=\"18\" class=\"icon-img-invert\" />\n              Добавить администратора\n            </button>\n          </div>\n          \n          <AppLoader v-if=\"loadingAdmins\" />\n          \n          <table v-else-if=\"admins.length > 0\" class=\"admins-table\">\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Логин</th>\n                <th>Email</th>\n                <th>Роль</th>\n                <th>Последний вход</th>\n                <th>Создан</th>\n                <th>Действия</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"admin in admins\" :key=\"admin.inc\">\n                <td data-label=\"ID\">{{ admin.inc }}</td>\n                <td data-label=\"Логин\">{{ admin.username }}</td>\n                <td data-label=\"Email\">{{ admin.email }}</td>\n                <td data-label=\"Роль\">\n                  <span :class=\"['badge', admin.role === 'superadmin' ? 'badge-superadmin' : 'badge-admin']\">\n                    {{ admin.role === 'superadmin' ? 'Суперадмин' : 'Администратор' }}\n                  </span>\n                </td>\n                <td data-label=\"Последний вход\">{{ formatDateTime(admin.lastLogin) || '—' }}</td>\n                <td data-label=\"Создан\">{{ formatDate(admin.createdAt) }}</td>\n                <td data-label=\"Действия\">\n                  <div class=\"action-buttons\">\n                    <button \n                      v-if=\"admin.role !== 'superadmin'\"\n                      @click=\"openChangeAdminPasswordModal(admin)\" \n                      class=\"btn-icon btn-edit\" \n                      title=\"Сменить пароль\"\n                    >\n                      <img src=\"@/assets/edit.png\" alt=\"edit\" width=\"18\" height=\"18\" />\n                    </button>\n                    <button \n                      v-if=\"admin.role !== 'superadmin' && admin.inc !== authStore.user?.id\"\n                      @click=\"confirmDeleteAdmin(admin)\" \n                      class=\"btn-icon btn-delete\" \n                      title=\"Удалить\"\n                    >\n                      <img src=\"@/assets/delete.png\" alt=\"delete\" width=\"18\" height=\"18\" />\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          \n          <div v-else class=\"empty-state\">\n            <p>Администраторы не найдены</p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Audit Log Tab -->\n      <div v-if=\"activeTab === 'audit' && isSuperAdmin\" class=\"tab-content\">\n        <div class=\"audit-section\">\n          <div class=\"section-header\">\n            <h3>Журнал событий</h3>\n            <button @click=\"refreshAuditLogs\" class=\"btn btn-secondary\">\n              <img src=\"@/assets/refresh.png\" alt=\"refresh\" width=\"18\" height=\"18\" class=\"icon-img-invert\" />\n              Обновить\n            </button>\n          </div>\n\n          <!-- Фильтры -->\n          <div class=\"filters-bar\">\n            <div class=\"filter-group\">\n              <label>Поиск:</label>\n              <input\n                v-model=\"auditSearchQuery\"\n                type=\"text\"\n                placeholder=\"Администратор, действие, сущность...\"\n                class=\"filter-input\"\n              />\n            </div>\n\n            <div class=\"filter-group\">\n              <label>Администратор:</label>\n              <select v-model=\"auditAdminFilter\" class=\"filter-select\">\n                <option value=\"\">Все администраторы</option>\n                <option v-for=\"admin in admins\" :key=\"admin.inc\" :value=\"admin.inc\">\n                  {{ admin.username }}\n                </option>\n              </select>\n            </div>\n\n            <div class=\"filter-group\">\n              <label>Тип:</label>\n              <select v-model=\"auditEntityTypeFilter\" class=\"filter-select\">\n                <option value=\"\">Все типы</option>\n                <option value=\"partner\">Партнёр</option>\n                <option value=\"document\">Документ</option>\n                <option value=\"claim\">Претензия</option>\n                <option value=\"admin\">Администратор</option>\n              </select>\n            </div>\n\n            <div class=\"filter-group\">\n              <label>Дата от:</label>\n              <input\n                v-model=\"auditDateFrom\"\n                type=\"date\"\n                class=\"filter-input\"\n              />\n            </div>\n\n            <div class=\"filter-group\">\n              <label>Дата до:</label>\n              <input\n                v-model=\"auditDateTo\"\n                type=\"date\"\n                class=\"filter-input\"\n              />\n            </div>\n\n            <button @click=\"clearAuditFilters\" class=\"btn btn-secondary\">\n              Сбросить фильтры\n            </button>\n          </div>\n\n          <!-- Статистика -->\n          <div v-if=\"filteredAuditLogs.length > 0\" class=\"filters-stats\">\n            Показано: {{ filteredAuditLogs.length }} из {{ auditLogs.length }}\n          </div>\n\n          <AppLoader v-if=\"loadingAuditLogs\" />\n\n          <table v-else-if=\"filteredAuditLogs.length > 0\" class=\"audit-table\">\n            <thead>\n              <tr>\n                <th>Дата/Время</th>\n                <th>Администратор</th>\n                <th>Действие</th>\n                <th>Тип</th>\n                <th>Сущность</th>\n                <th>Детали</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"log in filteredAuditLogs\" :key=\"log.id\">\n                <td data-label=\"Дата/Время\">{{ formatDateTime(log.timestamp) }}</td>\n                <td data-label=\"Администратор\">{{ log.admin_username || '—' }}</td>\n                <td data-label=\"Действие\">\n                  <span :class=\"['badge', getActionBadgeClass(log.action)]\">\n                    {{ formatAction(log.action) }}\n                  </span>\n                </td>\n                <td data-label=\"Тип\">{{ formatEntityType(log.entity_type) }}</td>\n                <td data-label=\"Сущность\">{{ log.entity_name || '—' }}</td>\n                <td data-label=\"Детали\">\n                  <button \n                    v-if=\"log.details\"\n                    @click=\"showAuditDetails(log)\" \n                    class=\"btn-small\"\n                  >\n                    Подробнее\n                  </button>\n                  <span v-else>—</span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n\n          <div v-else class=\"empty-state\">\n            <p>События не найдены</p>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Create Admin Modal -->\n    <div v-if=\"showCreateAdminModal\" class=\"modal-overlay\">\n      <div class=\"modal\">\n        <div class=\"modal-header\">\n          <h3>Создать администратора</h3>\n          <button @click=\"showCreateAdminModal = false\" class=\"close-btn\">×</button>\n        </div>\n        \n        <form @submit.prevent=\"createAdmin\" class=\"modal-body\">\n          <div class=\"form-group\">\n            <label>Логин *</label>\n            <input v-model=\"newAdmin.username\" type=\"text\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Email *</label>\n            <input v-model=\"newAdmin.email\" type=\"email\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Пароль *</label>\n            <input v-model=\"newAdmin.password\" type=\"password\" required minlength=\"6\" />\n            <small>Минимум 6 символов</small>\n          </div>\n        </form>\n        \n        <div class=\"modal-footer\">\n          <button type=\"button\" @click=\"showCreateAdminModal = false\" class=\"btn btn-secondary\">\n            Отмена\n          </button>\n          <button type=\"submit\" @click=\"createAdmin\" class=\"btn btn-primary\" :disabled=\"creatingAdmin\">\n            {{ creatingAdmin ? 'Создание...' : 'Создать' }}\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Change Admin Password Modal -->\n    <div v-if=\"showChangeAdminPasswordModal\" class=\"modal-overlay\">\n      <div class=\"modal\">\n        <div class=\"modal-header\">\n          <h3>Сменить пароль: {{ adminToEdit?.username }}</h3>\n          <button @click=\"showChangeAdminPasswordModal = false\" class=\"close-btn\">×</button>\n        </div>\n        \n        <form @submit.prevent=\"changeAdminPassword\" class=\"modal-body\">\n          <div class=\"form-group\">\n            <label>Новый пароль *</label>\n            <input v-model=\"newAdminPassword\" type=\"password\" required minlength=\"6\" />\n            <small>Минимум 6 символов</small>\n          </div>\n        </form>\n        \n        <div class=\"modal-footer\">\n          <button type=\"button\" @click=\"showChangeAdminPasswordModal = false\" class=\"btn btn-secondary\">\n            Отмена\n          </button>\n          <button type=\"submit\" @click=\"changeAdminPassword\" class=\"btn btn-primary\" :disabled=\"changingPassword\">\n            {{ changingPassword ? 'Сохранение...' : 'Сохранить' }}\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Create Partner Modal -->\n    <div v-if=\"showCreatePartnerModal\" class=\"modal-overlay\">\n      <div class=\"modal\">\n        <div class=\"modal-header\">\n          <h3>Добавить партнера</h3>\n          <button @click=\"showCreatePartnerModal = false\" class=\"close-btn\">×</button>\n        </div>\n        \n        <form @submit.prevent=\"createPartner\" class=\"modal-body\">\n          <AppLoader v-if=\"creatingPartner\" />\n          <div class=\"form-group\">\n            <label>Имя партнера *</label>\n            <input v-model=\"newPartner.name\" type=\"text\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Email *</label>\n            <input v-model=\"newPartner.email\" type=\"email\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Telegram Chat ID (опционально)</label>\n            <input v-model=\"newPartner.telegram\" type=\"text\" placeholder=\"Например: 123456789\" />\n            <small style=\"color: #64748b; margin-top: 5px; display: block;\">\n              💡 Партнер должен отправить /start боту и сообщить вам свой Chat ID\n            </small>\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Логин *</label>\n            <input v-model=\"newPartner.alias\" type=\"text\" required placeholder=\"Уникальный логин для входа\" />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Пароль *</label>\n            <input v-model=\"newPartner.password\" type=\"password\" required placeholder=\"Пароль для входа\" />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Дата рождения (опционально)</label>\n            <input v-model=\"newPartner.birthDate\" type=\"date\" />\n          </div>\n          \n          <div class=\"form-group\" style=\"display: flex; align-items: center; gap: 10px;\">\n            <input v-model=\"newPartner.active\" type=\"checkbox\" id=\"newPartnerActive\" />\n            <label for=\"newPartnerActive\" style=\"margin: 0; cursor: pointer;\">Активный</label>\n          </div>\n        </form>\n        \n        <div class=\"modal-footer\">\n          <button type=\"button\" @click=\"showCreatePartnerModal = false\" class=\"btn btn-secondary\">\n            Отмена\n          </button>\n          <button @click=\"createPartner\" :disabled=\"creatingPartner\" class=\"btn btn-primary\">\n            <i v-if=\"creatingPartner\" class=\"fas fa-spinner fa-spin\"></i>\n            {{ creatingPartner ? 'Создание...' : 'Создать' }}\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Upload Files Modal -->\n    <div v-if=\"showUploadModal\" class=\"modal-overlay\">\n      <div class=\"modal modal-large\">\n        <div class=\"modal-header\">\n          <h3>Загрузка файлов для {{ currentUploadPartnerName }}</h3>\n          <button @click=\"closeUploadModal\" class=\"close-btn\">×</button>\n        </div>\n        \n        <div class=\"modal-body\">\n          <div v-if=\"!uploading\" class=\"upload-area\" :class=\"{ dragover: isDragover }\" \n            @dragover.prevent=\"isDragover = true\"\n            @dragleave.prevent=\"isDragover = false\"\n            @drop.prevent=\"handleDrop\">\n            <input \n              ref=\"partnerFileInput\"\n              type=\"file\" \n              multiple \n              accept=\".xlsx,.xls\"\n              @change=\"handleFileSelect\"\n              style=\"display: none\"\n            />\n            \n            <div class=\"upload-content\">\n              <div class=\"upload-icon\">\n                <i class=\"fas fa-cloud-upload-alt\"></i>\n              </div>\n              <p>Перетащите Excel файлы сюда или <button @click=\"$refs.partnerFileInput.click()\" class=\"link-btn\">выберите файлы</button></p>\n              <p class=\"upload-hint\">Поддерживаются файлы: .xlsx, .xls (максимум 50 файлов)</p>\n            </div>\n          </div>\n          \n          <!-- Selected files -->\n          <div v-if=\"selectedFiles.length > 0 && !uploading\" class=\"selected-files\">\n            <h4>Выбранные файлы ({{ selectedFiles.length }})</h4>\n            <div class=\"file-list\">\n              <div v-for=\"(file, index) in selectedFiles\" :key=\"index\" class=\"file-item\">\n                <div class=\"file-info\">\n                  <div class=\"file-name\">{{ file.name }}</div>\n                  <div class=\"file-size\">{{ formatFileSize(file.size) }}</div>\n                </div>\n                <button @click=\"removeFile(index)\" class=\"remove-btn\">\n                  <i class=\"fas fa-times\"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n          \n          <!-- Upload results -->\n          <div v-if=\"uploadResults.length > 0 && !uploading\" class=\"upload-results\">\n            <h4>Результаты загрузки</h4>\n            <div class=\"results-summary\">\n              <span class=\"success\"><i class=\"fas fa-check-circle\"></i> Успешно: {{ uploadResults.filter(r => r.success).length }}</span>\n              <span class=\"error\"><i class=\"fas fa-times-circle\"></i> Ошибки: {{ uploadResults.filter(r => !r.success).length }}</span>\n            </div>\n            \n            <div class=\"results-list\">\n              <div v-for=\"result in uploadResults\" :key=\"result.fileName\" class=\"result-item\" :class=\"{ error: !result.success }\">\n                <div class=\"result-file\">{{ result.fileName }}</div>\n                <div class=\"result-status\">\n                  {{ result.success ? 'Успешно загружен' : result.error }}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"modal-footer\">\n          <button type=\"button\" @click=\"closeUploadModal\" class=\"btn btn-secondary\">\n            Отмена\n          </button>\n          <button v-if=\"!uploading\" @click=\"uploadFilesForPartner\" :disabled=\"selectedFiles.length === 0\" class=\"btn btn-primary\">\n            <i class=\"fas fa-upload\"></i>\n            Загрузить файлы\n          </button>\n          <div v-else style=\"display:flex;align-items:center;gap:12px;\">\n            <AppLoader />\n            <span>Загрузка файлов...</span>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Edit Partner Modal -->\n    <div v-if=\"showEditPartnerModal\" class=\"modal-overlay\">\n      <div class=\"modal\">\n        <div class=\"modal-header\">\n          <h3>Редактировать партнера</h3>\n          <button @click=\"showEditPartnerModal = false\" class=\"close-btn\">×</button>\n        </div>\n        \n        <form @submit.prevent=\"updatePartner\" class=\"modal-body\">\n          <AppLoader v-if=\"editingPartner\" />\n          <div class=\"form-group\">\n            <label>Имя партнера *</label>\n            <input v-model=\"partnerToEdit.name\" type=\"text\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Email *</label>\n            <input v-model=\"partnerToEdit.email\" type=\"email\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Telegram Chat ID (опционально)</label>\n            <input v-model=\"partnerToEdit.telegram\" type=\"text\" placeholder=\"Например: 123456789\" />\n            <small style=\"color: #64748b; margin-top: 5px; display: block;\">\n              💡 Партнер должен отправить /start боту и сообщить вам свой Chat ID\n            </small>\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Логин</label>\n            <input v-model=\"partnerToEdit.alias\" type=\"text\" required />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Новый пароль (опционально)</label>\n            <input v-model=\"partnerToEdit.newPassword\" type=\"password\" placeholder=\"Оставьте пустым, чтобы не менять\" />\n          </div>\n          \n          <div class=\"form-group\">\n            <label>Дата рождения (опционально)</label>\n            <input v-model=\"partnerToEdit.birthDate\" type=\"date\" />\n          </div>\n          \n          <div class=\"form-group\" style=\"display: flex; align-items: center; gap: 10px;\">\n            <input v-model=\"partnerToEdit.active\" type=\"checkbox\" id=\"editPartnerActive\" />\n            <label for=\"editPartnerActive\" style=\"margin: 0; cursor: pointer;\">Активный</label>\n          </div>\n        </form>\n        \n        <div class=\"modal-footer\">\n          <button type=\"button\" @click=\"showEditPartnerModal = false\" class=\"btn btn-secondary\">\n            Отмена\n          </button>\n          <button @click=\"updatePartner\" :disabled=\"editingPartner\" class=\"btn btn-primary\">\n            <i v-if=\"editingPartner\" class=\"fas fa-spinner fa-spin\"></i>\n            {{ editingPartner ? 'Сохранение...' : 'Сохранить' }}\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Partner Documents Modal -->\n    <div v-if=\"showPartnerDocumentsModal\" class=\"modal-overlay\">\n      <div class=\"modal modal-large\">\n        <div class=\"modal-header\">\n          <h3>Документы партнера: {{ partnerToEdit?.name }}</h3>\n          <button @click=\"showPartnerDocumentsModal = false\" class=\"close-btn\">×</button>\n        </div>\n        \n        <div class=\"modal-body\">\n          <AppLoader v-if=\"loadingPartnerDocuments\" />\n          <table v-else-if=\"partnerDocuments.length > 0\" class=\"documents-table\">\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Дата</th>\n                <th>Файл</th>\n                <th>Размер</th>\n                <th>Статус</th>\n                <th>Действия</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"doc in partnerDocuments\" :key=\"doc.inc || doc.claimId || doc.DocumentId || doc.DocumentId\">\n                <td>{{ doc.inc ?? doc.claimId ?? doc.ClaimId ?? doc.DocumentId ?? '—' }}</td>\n                <td>{{ formatDate(getDocDate(doc)) }}</td>\n                <td>{{ doc.filename || doc.FileName || doc.fileName || doc.originalName || '—' }}</td>\n                <td>{{ formatFileSize(doc.size || doc.FileSize || doc.fileSize) }}</td>\n                <td>{{ isPublished(doc) ? 'Опубликован' : 'Не опубликован' }}</td>\n                <td>\n                  <div class=\"action-buttons\">\n                    <button v-if=\"!isPublished(doc)\" @click=\"publishPartnerDocument(doc)\" class=\"btn btn-sm btn-primary\">Опубликовать</button>\n                    <button @click=\"confirmDeletePartnerDocument(doc)\" class=\"btn btn-sm btn-danger\">Удалить</button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <p v-else-if=\"!loadingPartnerDocuments\">Документы не найдены</p>\n        </div>\n        \n        <div class=\"modal-footer\">\n          <button @click=\"showPartnerDocumentsModal = false\" class=\"btn btn-secondary\">\n            Закрыть\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- View Document Modal - Excel-like viewer -->\n    <ExcelViewer\n      :show=\"showViewDocumentModal\"\n      :document=\"currentDocument\"\n      :excelData=\"excelData\"\n      :loading=\"loadingCurrentDocument\"\n      @close=\"showViewDocumentModal = false\"\n      @download=\"downloadDocument(currentDocument.inc || currentDocument.Inc)\"\n    />\n\n    <!-- Confirmation Modal -->\n    <div v-if=\"showConfirmModal\" class=\"modal-overlay\">\n      <div class=\"modal\">\n        <div class=\"modal-header\">\n          <h3>{{ confirmTitle }}</h3>\n          <button @click=\"handleConfirmNo\" class=\"close-btn\">×</button>\n        </div>\n\n        <div class=\"modal-body\">\n          <p style=\"color:#374151; font-size:16px; line-height:1.4\">{{ confirmMessage }}</p>\n        </div>\n\n        <div class=\"modal-footer\">\n          <button @click=\"handleConfirmNo\" class=\"btn btn-outline-blue\" :disabled=\"confirmLoading\">{{ confirmCancelText }}</button>\n          <button @click=\"handleConfirmYes\" class=\"btn btn-primary\" :disabled=\"confirmLoading\">\n            <i v-if=\"confirmLoading\" class=\"fas fa-spinner fa-spin\"></i>\n            {{ confirmOkText }}\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Notifications -->\n    <AppNotifications />\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, watch } from 'vue'\nimport AppLoader from '@/components/AppLoader.vue'\nimport AppNotifications from '@/components/AppNotifications.vue'\nimport ExcelViewer from '@/components/ExcelViewer.vue'\nimport { useAuthStore } from '@/stores/auth'\nimport { useNotificationStore } from '@/stores/notifications'\nimport api from '@/plugins/axios'\n\nconst authStore = useAuthStore()\nconst notificationStore = useNotificationStore()\n\n// Reactive data\nconst user = ref(null)\nconst stats = ref({})\nconst activeTab = ref('partners')\n\n// Computed для проверки роли суперадмина\nconst isSuperAdmin = computed(() => {\n  return authStore.user?.adminRole === 'superadmin'\n})\n\n// Tabs\nconst tabs = computed(() => {\n  const baseTabs = [\n    { id: 'partners', label: 'Партнеры' },\n    { id: 'upload', label: 'Загрузка' },\n    { id: 'documents', label: 'Документы' }\n  ]\n  \n  // Добавляем вкладки только для суперадмина\n  if (isSuperAdmin.value) {\n    baseTabs.push({ id: 'admins', label: 'Администраторы' })\n    baseTabs.push({ id: 'audit', label: 'Журнал событий' })\n  }\n  \n  return baseTabs\n})\n\n// File upload\nconst selectedFiles = ref([])\nconst uploading = ref(false)\nconst uploadResults = ref([])\nconst isDragover = ref(false)\n\n// Auto upload (с определением партнёра из Excel)\nconst autoUploadFiles = ref([])\nconst autoUploading = ref(false)\nconst autoUploadResults = ref([])\nconst isAutoUploadDragover = ref(false)\n\n// Documents\nconst unpublishedClaims = ref([])\nconst selectedClaims = ref([])\nconst loadingDocuments = ref(false)\nconst publishing = ref(false)\n// Additional loaders\nconst loadingStats = ref(false)\nconst loadingPartnerDocuments = ref(false)\nconst documentsFilter = ref('unpublished') // 'unpublished' or 'published'\nconst documentSearchQuery = ref('') // поиск по названию файла\nconst documentPartnerFilter = ref('') // фильтр по партнёру (partnerId)\nconst documentDateFrom = ref('') // начало диапазона дат\nconst documentDateTo = ref('') // конец диапазона дат\n\nconst setDocumentsFilter = (value) => {\n  documentsFilter.value = value\n  refreshDocuments()\n}\n\n// File-Partner mapping\nconst currentUploadPartnerId = ref(null)\nconst currentUploadPartnerName = ref('')\nconst showUploadModal = ref(false)\n\n// Partners\nconst partners = ref([])\nconst loadingPartners = ref(false)\nconst partnerSearchQuery = ref('')\nconst partnerActiveFilter = ref('all') // 'all' | 'active' | 'inactive'\nconst partnerBirthdayFilter = ref(false) // показывать только с ДР в этом месяце\nconst showCreatePartnerModal = ref(false)\nconst creatingPartner = ref(false)\nconst showEditPartnerModal = ref(false)\nconst editingPartner = ref(false)\nconst partnerToEdit = ref(null)\nconst showPartnerDocumentsModal = ref(false)\nconst partnerDocuments = ref([])\nconst showViewDocumentModal = ref(false)\nconst currentDocument = ref(null)\nconst loadingCurrentDocument = ref(false)\nconst excelData = ref(null)\nconst newPartner = ref({\n  name: '',\n  email: '',\n  telegram: '',\n  alias: '',\n  password: '',\n  birthDate: '',\n  active: true\n})\n\n// Admins (только для superadmin)\nconst admins = ref([])\nconst loadingAdmins = ref(false)\nconst showCreateAdminModal = ref(false)\nconst creatingAdmin = ref(false)\nconst showChangeAdminPasswordModal = ref(false)\nconst changingPassword = ref(false)\nconst adminToEdit = ref(null)\nconst newAdminPassword = ref('')\nconst newAdmin = ref({\n  username: '',\n  email: '',\n  password: ''\n})\n\n// Audit Logs (только для superadmin)\nconst auditLogs = ref([])\nconst loadingAuditLogs = ref(false)\nconst auditSearchQuery = ref('')\nconst auditAdminFilter = ref('')\nconst auditEntityTypeFilter = ref('')\nconst auditDateFrom = ref('')\nconst auditDateTo = ref('')\nconst showAuditDetailsModal = ref(false)\nconst selectedAuditLog = ref(null)\n\n// Confirmation modal state\nconst showConfirmModal = ref(false)\nconst confirmTitle = ref('')\nconst confirmMessage = ref('')\nconst confirmOkText = ref('Да')\nconst confirmCancelText = ref('Отмена')\nconst confirmLoading = ref(false)\nlet confirmCallback = null\n\nconst openConfirm = ({ title = 'Подтверждение', message = '', okText = 'Да', cancelText = 'Отмена', onConfirm = null }) => {\n  confirmTitle.value = title\n  confirmMessage.value = message\n  confirmOkText.value = okText\n  confirmCancelText.value = cancelText\n  confirmCallback = onConfirm\n  confirmLoading.value = false\n  showConfirmModal.value = true\n}\n\nconst handleConfirmYes = async () => {\n  if (!confirmCallback) {\n    showConfirmModal.value = false\n    return\n  }\n  try {\n    confirmLoading.value = true\n    await confirmCallback()\n  } catch (e) {\n    console.error('Confirm action error', e)\n  } finally {\n    confirmLoading.value = false\n    showConfirmModal.value = false\n  }\n}\n\nconst handleConfirmNo = () => {\n  showConfirmModal.value = false\n  confirmCallback = null\n}\n\n// Methods\nconst loadData = async () => {\n  loadingStats.value = true\n  try {\n    const response = await api.get('/admin/stats')\n    stats.value = response.data.stats\n    user.value = authStore.user\n  } catch (error) {\n    console.error('Ошибка загрузки статистики:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки данных'\n    })\n  } finally {\n    loadingStats.value = false\n  }\n}\n\nconst handleFileSelect = (event) => {\n  const files = Array.from(event.target.files)\n  addFiles(files)\n}\n\nconst handleDrop = (event) => {\n  isDragover.value = false\n  const files = Array.from(event.dataTransfer.files)\n  addFiles(files)\n}\n\nconst addFiles = (files) => {\n  const excelFiles = files.filter(file => \n    file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ||\n    file.type === 'application/vnd.ms-excel' ||\n    file.name.endsWith('.xlsx') ||\n    file.name.endsWith('.xls')\n  )\n  \n  if (excelFiles.length !== files.length) {\n    notificationStore.addNotification({\n      type: 'warning',\n      message: 'Некоторые файлы не являются Excel файлами и были проигнорированы'\n    })\n  }\n  \n  selectedFiles.value = [...selectedFiles.value, ...excelFiles]\n}\n\nconst removeFile = (index) => {\n  selectedFiles.value.splice(index, 1)\n}\n\n// clearFiles removed — upload modal uses closeUploadModal to reset state\n\nconst filteredPartners = computed(() => {\n  let filtered = partners.value\n  \n  // Фильтр по статусу активности\n  if (partnerActiveFilter.value === 'active') {\n    filtered = filtered.filter(p => p.Active === 1 || p.Active === true)\n  } else if (partnerActiveFilter.value === 'inactive') {\n    filtered = filtered.filter(p => p.Active === 0 || p.Active === false)\n  }\n  \n  // Фильтр по дню рождения в этом месяце\n  if (partnerBirthdayFilter.value) {\n    const currentMonth = new Date().getMonth()\n    filtered = filtered.filter(p => {\n      if (!p.BirthDate) return false\n      const birthDate = new Date(p.BirthDate)\n      return birthDate.getMonth() === currentMonth\n    })\n  }\n  \n  // Поисковый фильтр\n  if (partnerSearchQuery.value) {\n    const query = partnerSearchQuery.value.toLowerCase()\n    filtered = filtered.filter(p => {\n      const name = (p.Name || p.name || '').toLowerCase()\n      const email = (p.Email || p.email || '').toLowerCase()\n      const inc = String(p.Inc || p.partnerId || '')\n      const alias = (p.Alias || p.alias || '').toLowerCase()\n      \n      return name.includes(query) || \n             email.includes(query) || \n             inc.includes(query) ||\n             alias.includes(query)\n    })\n  }\n  \n  return filtered\n})\n\n// Фильтрация документов\nconst filteredDocuments = computed(() => {\n  let filtered = unpublishedClaims.value\n  \n  // Фильтр по партнёру\n  if (documentPartnerFilter.value) {\n    filtered = filtered.filter(doc => String(doc.partnerId) === String(documentPartnerFilter.value))\n  }\n  \n  // Фильтр по диапазону дат загрузки\n  if (documentDateFrom.value) {\n    const fromDate = new Date(documentDateFrom.value)\n    fromDate.setHours(0, 0, 0, 0)\n    filtered = filtered.filter(doc => {\n      const docDate = new Date(doc.uploadedAt || doc.Created)\n      docDate.setHours(0, 0, 0, 0)\n      return docDate >= fromDate\n    })\n  }\n  \n  if (documentDateTo.value) {\n    const toDate = new Date(documentDateTo.value)\n    toDate.setHours(23, 59, 59, 999)\n    filtered = filtered.filter(doc => {\n      const docDate = new Date(doc.uploadedAt || doc.Created)\n      return docDate <= toDate\n    })\n  }\n  \n  // Поисковый фильтр по названию файла\n  if (documentSearchQuery.value) {\n    const query = documentSearchQuery.value.toLowerCase()\n    filtered = filtered.filter(doc => {\n      const fileName = (doc.fileName || doc.originalName || '').toLowerCase()\n      return fileName.includes(query)\n    })\n  }\n  \n  return filtered\n})\n\nconst openUploadForPartner = (partner) => {\n  currentUploadPartnerId.value = partner.Inc\n  currentUploadPartnerName.value = partner.Name\n  selectedFiles.value = []\n  uploadResults.value = []\n  showUploadModal.value = true\n}\n\nconst closeUploadModal = () => {\n  showUploadModal.value = false\n  selectedFiles.value = []\n  uploadResults.value = []\n  currentUploadPartnerId.value = null\n  currentUploadPartnerName.value = ''\n}\n\nconst uploadFilesForPartner = async () => {\n  if (selectedFiles.value.length === 0 || !currentUploadPartnerId.value) return\n  \n  uploading.value = true\n  const formData = new FormData()\n  \n  // Собираем массив partner IDs - все файлы для одного партнера\n  const partnerIds = []\n  \n  // Add files and collect partner IDs\n  selectedFiles.value.forEach((file) => {\n    formData.append('files', file)\n    partnerIds.push(currentUploadPartnerId.value)\n  })\n  \n  // Отправляем массив партнеров как JSON\n  formData.append('partnerIds', JSON.stringify(partnerIds))\n  \n  try {\n    const response = await api.post('/admin/upload-files', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n    \n    uploadResults.value = [\n      ...response.data.results.map(r => ({ ...r, success: true })),\n      ...response.data.errors.map(e => ({ ...e, success: false }))\n    ]\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: response.data.message\n    })\n    \n    selectedFiles.value = []\n    refreshDocuments()\n    \n    // Redirect to partner documents to publish\n    const uploadedPartner = {\n      Inc: currentUploadPartnerId.value,\n      Name: currentUploadPartnerName.value\n    }\n    closeUploadModal()\n    await viewPartnerDocuments(uploadedPartner)\n    \n  } catch (error) {\n    console.error('Ошибка загрузки файлов:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки файлов: ' + (error.response?.data?.message || error.message)\n    })\n  } finally {\n    uploading.value = false\n  }\n}\n\nconst refreshDocuments = async () => {\n  loadingDocuments.value = true\n  try {\n    const endpoint = documentsFilter.value === 'unpublished' ? '/admin/unpublished-claims' : '/admin/published-claims'\n    const response = await api.get(endpoint)\n    unpublishedClaims.value = response.data.data\n    selectedClaims.value = []\n  } catch (error) {\n    console.error('Ошибка загрузки документов:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки документов'\n    })\n  } finally {\n    loadingDocuments.value = false\n  }\n}\n\n// Auto upload functions (с определением партнёра из Excel)\nconst handleAutoUploadDrop = (e) => {\n  isAutoUploadDragover.value = false\n  const files = Array.from(e.dataTransfer.files).filter(f => \n    f.name.endsWith('.xlsx') || f.name.endsWith('.xls')\n  )\n  autoUploadFiles.value = [...autoUploadFiles.value, ...files]\n}\n\nconst handleAutoUploadFileSelect = (e) => {\n  const files = Array.from(e.target.files)\n  autoUploadFiles.value = [...autoUploadFiles.value, ...files]\n  e.target.value = '' // Reset input\n}\n\nconst removeAutoUploadFile = (index) => {\n  autoUploadFiles.value.splice(index, 1)\n}\n\nconst uploadAutoFiles = async () => {\n  if (autoUploadFiles.value.length === 0) return\n  \n  autoUploading.value = true\n  const formData = new FormData()\n  \n  autoUploadFiles.value.forEach(file => {\n    formData.append('files', file)\n  })\n  \n  try {\n    const response = await api.post('/admin/auto-upload-files', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n    \n    autoUploadResults.value = [\n      ...response.data.results.map(r => ({ \n        ...r, \n        success: true,\n        fileName: r.fileName || r.filename,\n        partnerName: r.partnerName\n      })),\n      ...response.data.errors.map(e => ({ \n        ...e, \n        success: false,\n        fileName: e.fileName || e.filename\n      }))\n    ]\n    \n    const successCount = response.data.results.length\n    const errorCount = response.data.errors.length\n    \n    if (successCount > 0) {\n      notificationStore.addNotification({\n        type: 'success',\n        message: `Успешно загружено: ${successCount} файл(ов)`\n      })\n    }\n    \n    if (errorCount > 0) {\n      notificationStore.addNotification({\n        type: 'error',\n        message: `Ошибок: ${errorCount} файл(ов)`\n      })\n    }\n    \n    autoUploadFiles.value = []\n    refreshDocuments()\n    \n  } catch (error) {\n    console.error('Ошибка автоматической загрузки:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки: ' + (error.response?.data?.message || error.message)\n    })\n  } finally {\n    autoUploading.value = false\n  }\n}\n\nconst publishDocument = async (claimId) => {\n  try {\n    await api.post('/admin/publish-claims', {\n      claimIds: [claimId]\n    })\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Документ успешно опубликован'\n    })\n    \n    refreshDocuments()\n    loadData()\n    \n  } catch (error) {\n    console.error('Ошибка публикации:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка публикации документа'\n    })\n  }\n}\n\nconst publishSelectedDocuments = async () => {\n  if (selectedClaims.value.length === 0) return\n  \n  publishing.value = true\n  try {\n    const response = await api.post('/admin/publish-claims', {\n      claimIds: selectedClaims.value\n    })\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: response.data.message\n    })\n    \n    refreshDocuments()\n    loadData()\n    \n  } catch (error) {\n    console.error('Ошибка публикации:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка публикации документов'\n    })\n  } finally {\n    publishing.value = false\n  }\n}\n\nconst publishAllDocuments = async () => {\n  const allClaimIds = unpublishedClaims.value.map(claim => getClaimId(claim))\n  selectedClaims.value = allClaimIds\n  await publishSelectedDocuments()\n}\n\nconst unpublishDocument = async (claimId) => {\n  if (!claimId) {\n    notificationStore.addNotification({ type: 'error', message: 'Не удалось определить ID документа' })\n    return\n  }\n\n  openConfirm({\n    title: 'Снятие публикации',\n    message: 'Вы уверены, что хотите снять публикацию этого документа? Партнёр больше не сможет его видеть.',\n    okText: 'Снять публикацию',\n    cancelText: 'Отмена',\n    onConfirm: async () => {\n      try {\n        await api.post('/admin/unpublish-claims', {\n          claimIds: [claimId]\n        })\n\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Публикация документа снята'\n        })\n\n        refreshDocuments()\n        loadData()\n\n      } catch (error) {\n        console.error('Ошибка снятия публикации:', error)\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка снятия публикации: ' + (error.response?.data?.message || error.message)\n        })\n        throw error\n      }\n    }\n  })\n}\n\nconst deleteDocument = async (claimId) => {\n  if (!claimId) {\n    notificationStore.addNotification({ type: 'error', message: 'Не удалось определить ID документа' })\n    return\n  }\n\n  openConfirm({\n    title: 'Удаление документа',\n    message: 'Вы уверены, что хотите удалить этот документ?',\n    okText: 'Удалить',\n    cancelText: 'Отмена',\n    onConfirm: async () => {\n      try {\n        await api.delete(`/admin/claims/${claimId}`)\n\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Документ успешно удален'\n        })\n\n        refreshDocuments()\n        loadData()\n\n      } catch (error) {\n        console.error('Ошибка удаления:', error)\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка удаления документа: ' + (error.response?.data?.message || error.message)\n        })\n        throw error\n      }\n    }\n  })\n}\n\n// Partner management methods\nconst editPartner = (partner) => {\n  partnerToEdit.value = {\n    Inc: partner.Inc,\n    name: partner.Name,\n    email: partner.Email,\n    telegram: partner.Telegram,\n    alias: partner.Alias || '',\n    birthDate: partner.BirthDate ? partner.BirthDate.split('T')[0] : '',\n    active: partner.Active !== 0,\n    newPassword: ''\n  }\n  showEditPartnerModal.value = true\n}\n\nconst updatePartner = async () => {\n  editingPartner.value = true\n  try {\n    const updateData = {\n      name: partnerToEdit.value.name,\n      email: partnerToEdit.value.email,\n      telegram: partnerToEdit.value.telegram,\n      alias: partnerToEdit.value.alias,\n      birthDate: partnerToEdit.value.birthDate || null,\n      active: partnerToEdit.value.active ? 1 : 0\n    }\n    \n    if (partnerToEdit.value.newPassword) {\n      updateData.password = partnerToEdit.value.newPassword\n    }\n    \n    await api.put(`/admin/partners/${partnerToEdit.value.Inc}`, updateData)\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Партнер успешно обновлен'\n    })\n    \n    showEditPartnerModal.value = false\n    partnerToEdit.value = null\n    loadPartners()\n    \n  } catch (error) {\n    console.error('Ошибка обновления партнера:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка обновления партнера: ' + (error.response?.data?.message || error.message)\n    })\n  } finally {\n    editingPartner.value = false\n  }\n}\n\nconst deletePartner = async (partner) => {\n  openConfirm({\n    title: 'Удаление партнера',\n    message: `Вы уверены, что хотите удалить партнера \"${partner.Name}\"? Это действие нельзя отменить.`,\n    okText: 'Удалить',\n    cancelText: 'Отмена',\n    onConfirm: async () => {\n      try {\n        await api.delete(`/admin/partners/${partner.Inc}`)\n\n        notificationStore.addNotification({\n          type: 'success',\n          message: 'Партнер успешно удален'\n        })\n\n        loadPartners()\n        loadData()\n\n      } catch (error) {\n        console.error('Ошибка удаления партнера:', error)\n        notificationStore.addNotification({\n          type: 'error',\n          message: 'Ошибка удаления партнера: ' + (error.response?.data?.message || error.message)\n        })\n        throw error\n      }\n    }\n  })\n}\n\nconst viewPartnerDocuments = async (partner) => {\n  partnerToEdit.value = partner\n  loadingPartnerDocuments.value = true\n  try {\n    const response = await api.get(`/admin/partners/${partner.Inc}/documents`)\n    partnerDocuments.value = response.data.documents\n    showPartnerDocumentsModal.value = true\n  } catch (error) {\n    console.error('Ошибка загрузки документов:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки документов партнера'\n    })\n  } finally {\n    loadingPartnerDocuments.value = false\n  }\n}\n\nconst getDocDate = (doc) => {\n  // try multiple possible fields, prioritize created from Partner sheet\n  return doc.created ?? doc.Created ?? doc.uploadedAt ?? doc.uploaded_at ?? doc.uploadedAtRaw ?? doc.publishedAt ?? doc.PublishedAt ?? doc.dateBeg ?? doc.DateBeg ?? doc.CreatedAt ?? null\n}\n\nconst isPublished = (doc) => {\n  if (!doc) return false\n  if (doc.publishedAt || doc.PublishedAt) return true\n  if (typeof doc.Published !== 'undefined') return Boolean(doc.Published)\n  if (typeof doc.published !== 'undefined') return Boolean(doc.published)\n  if (doc.Status) {\n    try {\n      return String(doc.Status).toLowerCase().includes('pub')\n    } catch (e) {\n      // ignore\n    }\n  }\n  return false\n}\n\nconst publishPartnerDocument = async (doc) => {\n  const id = getClaimId(doc) || doc.claimId || doc.ClaimId || doc.DocumentId || doc.inc\n  if (!id) return\n  try {\n    await api.post('/admin/publish-claims', { claimIds: [id] })\n    notificationStore.addNotification({ type: 'success', message: 'Документ опубликован' })\n    // reload list\n    await viewPartnerDocuments(partnerToEdit.value)\n    loadData()\n  } catch (error) {\n    console.error('Ошибка публикации документа партнера:', error)\n    notificationStore.addNotification({ type: 'error', message: 'Ошибка публикации документа' })\n  }\n}\n\nconst confirmDeletePartnerDocument = (doc) => {\n  const published = isPublished(doc)\n  openConfirm({\n    title: published ? 'Удалить опубликованный документ' : 'Удалить документ',\n    message: published\n      ? 'Документ опубликован. Удаление приведет к удалению опубликованной версии. Вы уверены?'\n      : 'Вы уверены, что хотите удалить документ?',\n    okText: 'Удалить',\n    cancelText: 'Отмена',\n    onConfirm: async () => {\n      await deletePartnerDocument(doc)\n    }\n  })\n}\n\nconst deletePartnerDocument = async (doc) => {\n  const id = getClaimId(doc) || doc.claimId || doc.ClaimId || doc.DocumentId || doc.inc\n  if (!id) return\n  try {\n    // If document is published, pass force=true to allow deletion\n    const force = isPublished(doc)\n    const url = `/admin/claims/${id}` + (force ? '?force=true' : '')\n    await api.delete(url)\n    notificationStore.addNotification({ type: 'success', message: 'Документ удалён' })\n    await viewPartnerDocuments(partnerToEdit.value)\n    loadData()\n  } catch (error) {\n    console.error('Ошибка удаления документа партнера:', error)\n    notificationStore.addNotification({ type: 'error', message: 'Ошибка удаления документа' })\n  }\n}\n\nconst toggleSelectAll = () => {\n  if (selectedClaims.value.length === filteredDocuments.value.length && filteredDocuments.value.length > 0) {\n    selectedClaims.value = []\n  } else {\n    selectedClaims.value = filteredDocuments.value.map(claim => getClaimId(claim))\n  }\n}\n\nconst viewDocument = async (claimId) => {\n  try {\n    loadingCurrentDocument.value = true\n    showViewDocumentModal.value = true\n    \n    const response = await api.get(`/admin/claims/${claimId}`)\n    currentDocument.value = response.data.data\n    excelData.value = response.data.excelData\n  } catch (error) {\n    console.error('Ошибка загрузки документа:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки документа'\n    })\n    showViewDocumentModal.value = false\n  } finally {\n    loadingCurrentDocument.value = false\n  }\n}\n\nconst downloadDocument = async (claimId) => {\n  try {\n    const response = await api.get(`/admin/claims/${claimId}/download`, {\n      responseType: 'blob'\n    })\n    \n    // Получаем имя файла из заголовка или используем имя из currentDocument\n    const contentDisposition = response.headers['content-disposition'] || response.headers['Content-Disposition']\n    let filename = getDisplayFileName(currentDocument.value) || 'document.xlsx'\n    if (contentDisposition) {\n      // Try RFC 5987 filename* first\n      const filenameStarMatch = contentDisposition.match(/filename\\*=(?:[\\w'']*)?([^;\\n]+)/i)\n      if (filenameStarMatch && filenameStarMatch[1]) {\n        try {\n          // filename*=UTF-8''%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80.xlsx\n          const v = filenameStarMatch[1].trim().replace(/^UTF-8''/i, '')\n          filename = decodeURIComponent(v.replace(/\"/g, ''))\n        } catch (e) {\n          // ignore\n        }\n      } else {\n        const filenameMatch = contentDisposition.match(/filename[^;=\\n]*=(['\"]?)([^'\"\\n]*?)\\1/)\n        if (filenameMatch && filenameMatch[2]) {\n          filename = filenameMatch[2]\n        }\n      }\n    }\n    // If filename still not usable, build fallback (ensures extension)\n    if (!filename || filename === '—') {\n      filename = buildFallbackFilename(currentDocument.value)\n    }\n    \n    // Создаем ссылку для скачивания\n    const url = window.URL.createObjectURL(new Blob([response.data]))\n    const link = document.createElement('a')\n    link.href = url\n    link.setAttribute('download', filename)\n    document.body.appendChild(link)\n    link.click()\n    link.remove()\n    window.URL.revokeObjectURL(url)\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Файл успешно скачан'\n    })\n  } catch (error) {\n    console.error('Ошибка скачивания:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка скачивания файла'\n    })\n  }\n}\n\nconst loadPartners = async () => {\n  loadingPartners.value = true\n  try {\n    const response = await api.get('/admin/partners')\n    partners.value = response.data.data\n  } catch (error) {\n    console.error('Ошибка загрузки партнеров:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки партнеров'\n    })\n  } finally {\n    loadingPartners.value = false\n  }\n}\n\nconst createPartner = async () => {\n  creatingPartner.value = true\n  try {\n    await api.post('/admin/partners', newPartner.value)\n    \n    let message = 'Партнер успешно создан'\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: message\n    })\n    \n    showCreatePartnerModal.value = false\n    newPartner.value = { name: '', email: '', telegram: '', alias: '', password: '', birthDate: '', active: true }\n    loadPartners()\n    loadData()\n    \n  } catch (error) {\n    console.error('Ошибка создания партнера:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка создания партнера: ' + (error.response?.data?.message || error.message)\n    })\n  } finally {\n    creatingPartner.value = false\n  }\n}\n\n// Utility functions\nconst formatFileSize = (bytes) => {\n  if (bytes === 0) return '0 Bytes'\n  if (bytes == null || isNaN(Number(bytes))) return '—'\n  const b = Number(bytes)\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(b) / Math.log(k))\n  const idx = Math.min(Math.max(i, 0), sizes.length - 1)\n  return parseFloat((b / Math.pow(k, idx)).toFixed(2)) + ' ' + sizes[idx]\n}\n\n// ============= МЕТОДЫ ДЛЯ УПРАВЛЕНИЯ АДМИНАМИ (только для superadmin) =============\n\nconst loadAdmins = async () => {\n  if (!isSuperAdmin.value) return\n  \n  loadingAdmins.value = true\n  try {\n    const response = await api.get('/admin/admins')\n    admins.value = response.data.admins\n  } catch (error) {\n    console.error('Ошибка загрузки админов:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка загрузки списка администраторов'\n    })\n  } finally {\n    loadingAdmins.value = false\n  }\n}\n\nconst createAdmin = async () => {\n  if (!newAdmin.value.username || !newAdmin.value.email || !newAdmin.value.password) {\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Заполните все обязательные поля'\n    })\n    return\n  }\n  \n  creatingAdmin.value = true\n  try {\n    await api.post('/admin/admins', newAdmin.value)\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Администратор успешно создан'\n    })\n    \n    showCreateAdminModal.value = false\n    newAdmin.value = { username: '', email: '', password: '' }\n    \n    await loadAdmins()\n  } catch (error) {\n    console.error('Ошибка создания админа:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: error.response?.data?.message || 'Ошибка создания администратора'\n    })\n  } finally {\n    creatingAdmin.value = false\n  }\n}\n\nconst openChangeAdminPasswordModal = (admin) => {\n  adminToEdit.value = admin\n  newAdminPassword.value = ''\n  showChangeAdminPasswordModal.value = true\n}\n\nconst changeAdminPassword = async () => {\n  if (!newAdminPassword.value || newAdminPassword.value.length < 6) {\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Пароль должен быть минимум 6 символов'\n    })\n    return\n  }\n  \n  changingPassword.value = true\n  try {\n    await api.put(`/admin/admins/${adminToEdit.value.inc}/password`, {\n      password: newAdminPassword.value\n    })\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Пароль администратора изменен'\n    })\n    \n    showChangeAdminPasswordModal.value = false\n    newAdminPassword.value = ''\n    adminToEdit.value = null\n  } catch (error) {\n    console.error('Ошибка смены пароля:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: 'Ошибка смены пароля'\n    })\n  } finally {\n    changingPassword.value = false\n  }\n}\n\nconst confirmDeleteAdmin = (admin) => {\n  openConfirm({\n    title: 'Удалить администратора',\n    message: `Вы уверены, что хотите удалить администратора \"${admin.username}\"?`,\n    confirmText: 'Удалить',\n    onConfirm: () => deleteAdmin(admin)\n  })\n}\n\nconst deleteAdmin = async (admin) => {\n  try {\n    await api.delete(`/admin/admins/${admin.inc}`)\n    \n    notificationStore.addNotification({\n      type: 'success',\n      message: 'Администратор удален'\n    })\n    \n    await loadAdmins()\n  } catch (error) {\n    console.error('Ошибка удаления админа:', error)\n    notificationStore.addNotification({\n      type: 'error',\n      message: error.response?.data?.message || 'Ошибка удаления администратора'\n    })\n  }\n}\n\n// ============= УТИЛИТЫ =============\n\nconst toTimestampMs = (value) => {\n  if (value == null || value === '') return null\n  // If numeric (seconds or milliseconds)\n  if (typeof value === 'number') {\n    // If looks like seconds (<= 10^11), convert to ms\n    return value < 1e12 ? value * 1000 : value\n  }\n  // If string of digits\n  if (/^\\d+$/.test(String(value))) {\n    const n = parseInt(value, 10)\n    return n < 1e12 ? n * 1000 : n\n  }\n  // If string looks like 'YYYY-MM-DD HH:mm:ss' or 'YYYY/MM/DD HH:mm:ss', treat as UTC\n  if (typeof value === 'string' && /^\\d{4}[-/]\\d{2}[-/]\\d{2}[ T]\\d{2}:\\d{2}:\\d{2}$/.test(value)) {\n    // normalize to ISO and append Z to force UTC\n    const iso = value.replace(' ', 'T').replace(/\\//g, '-') + 'Z'\n    const parsedIso = Date.parse(iso)\n    return isNaN(parsedIso) ? null : parsedIso\n  }\n  // Otherwise let Date parse the string (ISO, etc.)\n  const parsed = Date.parse(value)\n  return isNaN(parsed) ? null : parsed\n}\n\nconst formatDate = (date) => {\n  const ts = toTimestampMs(date)\n  if (!ts) return ''\n  return new Date(ts).toLocaleDateString('ru-RU', { timeZone: 'Europe/Moscow' })\n}\n\nconst formatDateTime = (date) => {\n  const ts = toTimestampMs(date)\n  if (!ts) return ''\n  return new Date(ts).toLocaleString('ru-RU', { \n    timeZone: 'Europe/Moscow',\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n\nconst formatPeriod = (dateFrom, dateTo) => {\n  if (!dateFrom || !dateTo) return '—'\n  const from = new Date(dateFrom).toLocaleDateString('ru-RU')\n  const to = new Date(dateTo).toLocaleDateString('ru-RU')\n  return `${from} — ${to}`\n}\n\n// Format currency helper (kept for reuse if needed elsewhere)\nconst formatCurrency = (amount) => {\n  if (amount === null || amount === undefined) return '—'\n  return new Intl.NumberFormat('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(amount)\n}\n\n// Helper to get claim id regardless of backend field naming\nconst getClaimId = (claim) => {\n  if (!claim) return null\n  return claim.Inc ?? claim.inc ?? claim.id ?? claim.ClaimId ?? null\n}\n\n// Friendly filename getter with fallbacks\nconst getDisplayFileName = (doc) => {\n  if (!doc) return '—'\n  const name = doc.fileName || doc.FileName || doc.originalName || doc.originalname || doc.filename || doc.FileNameDownload\n  if (name && String(name).trim() !== '') return name\n  return buildFallbackFilename(doc)\n}\n\n// Build a readable, filesystem-safe fallback filename when original name is missing\nconst buildFallbackFilename = (doc) => {\n  if (!doc) return 'document.xlsx'\n  const parts = []\n  const type = doc.type || doc.Type || ''\n  const partner = doc.PartnerName || doc.partnerName || doc.Name || doc.name || ''\n  const inc = doc.inc ?? doc.Inc ?? doc.id ?? ''\n\n  if (type) parts.push(String(type))\n  if (partner) parts.push(String(partner))\n  if (inc) parts.push(`#${inc}`)\n\n  // Period: try dateBeg/dateEnd\n  const from = doc.dateBeg ?? doc.DateBeg ?? doc.dateBegRaw ?? null\n  const to = doc.dateEnd ?? doc.DateEnd ?? doc.dateEndRaw ?? null\n  if (from && to) {\n    const f = toTimestampMs(from)\n    const t = toTimestampMs(to)\n    if (f && t) {\n      const d1 = new Date(f)\n      const d2 = new Date(t)\n      const pf = `${d1.getFullYear()}${String(d1.getMonth()+1).padStart(2,'0')}`\n      const pt = `${d2.getFullYear()}${String(d2.getMonth()+1).padStart(2,'0')}`\n      parts.push(`${pf}-${pt}`)\n    }\n  }\n\n  let filename = parts.join(' - ')\n  if (!filename) filename = `document${inc ? `-${inc}` : ''}`\n  // sanitize: remove slashes and quotes\n  filename = filename.replace(/[\\\\/:*?\"<>|]/g, '').trim()\n  // append default extension\n  if (!/\\.[a-z0-9]+$/i.test(filename)) filename += '.xlsx'\n  return filename\n}\n\nconst getStatusLabel = (status) => {\n  const labels = {\n    uploaded: 'Загружен',\n    published: 'Опубликован',\n    error: 'Ошибка'\n  }\n  return labels[status] || status\n}\n\n// Watch activeTab to load data\nconst handleTabChange = () => {\n  if (activeTab.value === 'documents') {\n    refreshDocuments()\n  } else if (activeTab.value === 'partners') {\n    loadPartners()\n  } else if (activeTab.value === 'admins' && isSuperAdmin.value) {\n    loadAdmins()\n  }\n}\n\n// Lifecycle\nonMounted(() => {\n  loadData()\n  handleTabChange()\n  // ensure helper is treated as used by linters\n  void formatCurrency(0)\n})\n\n// Watch activeTab\nwatch(activeTab, handleTabChange)\n</script>\n\n<style>\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\n\nhtml, body, #app {\n  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n  font-weight: 400;\n}\n</style>\n\n<style scoped>\n.admin-dashboard {\n  min-height: 100vh;\n  background: #f8fafc;\n  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n  font-weight: 400;\n  position: relative;\n}\n\n.dashboard-container {\n  max-width: 1400px;\n  margin: 0 auto;\n  padding: 24px;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n  margin-bottom: 30px;\n}\n\n.stat-card {\n  background: white;\n  border-radius: 16px;\n  padding: 24px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  transition: all 0.2s ease;\n  border: 1px solid #e5e7eb;\n  position: relative;\n}\n\n.stat-card::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 16px;\n  right: 16px;\n  height: 3px;\n  background: #2563eb;\n  border-radius: 2px;\n}\n\n.stat-card:hover {\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  border-color: #2563eb;\n}\n\n.stat-icon {\n  font-size: 2.5rem;\n  opacity: 0.9;\n  color: #2563eb;\n}\n\n.stat-content {\n  flex: 1;\n}\n\n.stat-value {\n  font-size: 1.8rem;\n  font-weight: 700;\n  color: #1e293b;\n  margin-bottom: 6px;\n}\n\n.stat-label {\n  color: #64748b;\n  font-size: 0.9rem;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.tabs {\n  display: flex;\n  background: white;\n  border-radius: 0;\n  margin-bottom: 0;\n  overflow: hidden;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);\n  border: 1px solid #e5e7eb;\n  border-bottom: 2px solid #e5e7eb;\n}\n\n.tab {\n  flex: 1;\n  padding: 16px 24px;\n  background: none;\n  border: none;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: #6b7280;\n  transition: all 0.2s ease;\n  position: relative;\n  text-align: center;\n  border-bottom: 2px solid transparent;\n  margin-bottom: -2px;\n}\n\n.tab:hover {\n  color: #2563eb;\n  background: #f9fafb;\n}\n\n.tab.active {\n  color: #2563eb;\n  background: white;\n  font-weight: 600;\n  border-bottom-color: #2563eb;\n}\n\n.tab {\n  flex: 1;\n  padding: 16px 24px;\n  border: none;\n  background: #f8f9fa;\n  color: #6c757d;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  border-bottom: 3px solid transparent;\n  transition: all 0.2s;\n}\n\n.tab:hover {\n  background: #e9ecef;\n  color: #495057;\n}\n\n.tab.active {\n  background: white;\n  color: #007bff;\n  border-bottom-color: #007bff;\n}\n\n.tab-content {\n  background: white;\n  border-radius: 0 0 12px 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  min-height: 500px;\n}\n\n.upload-section {\n  padding: 30px;\n}\n\n.upload-area {\n  border: 2px dashed #ddd;\n  border-radius: 12px;\n  padding: 60px 30px;\n  text-align: center;\n  margin-bottom: 30px;\n  transition: all 0.2s;\n  cursor: pointer;\n}\n\n.upload-area:hover,\n.upload-area.dragover {\n  border-color: #007bff;\n  background: #f8f9ff;\n}\n\n.upload-icon {\n  font-size: 3rem;\n  margin-bottom: 20px;\n  opacity: 0.6;\n}\n\n.upload-content p {\n  margin: 8px 0;\n  color: #6c757d;\n}\n\n.upload-hint {\n  font-size: 12px !important;\n  color: #adb5bd !important;\n}\n\n.link-btn {\n  color: #007bff;\n  text-decoration: underline;\n  border: none;\n  background: none;\n  cursor: pointer;\n}\n\n.upload-instructions {\n  background: #f8fafc;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  padding: 20px 24px;\n  margin-bottom: 24px;\n}\n\n.upload-instructions h4 {\n  margin: 0 0 12px 0;\n  color: #1e293b;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.upload-instructions p {\n  margin: 0 0 12px 0;\n  color: #475569;\n  line-height: 1.6;\n}\n\n.upload-instructions ul {\n  margin: 0;\n  padding-left: 20px;\n  color: #64748b;\n}\n\n.upload-instructions li {\n  margin: 6px 0;\n  line-height: 1.5;\n}\n\n.selected-files {\n  margin-bottom: 30px;\n}\n\n.files-list {\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  overflow: hidden;\n  margin: 16px 0;\n}\n\n.file-list {\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  overflow: hidden;\n  margin: 16px 0;\n}\n\n.file-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e9ecef;\n}\n\n.file-item:last-child {\n  border-bottom: none;\n}\n\n.file-info {\n  flex: 1;\n}\n\n.file-name {\n  font-weight: 500;\n  color: #2c3e50;\n}\n\n.file-size {\n  font-size: 12px;\n  color: #6c757d;\n}\n\n.remove-btn {\n  background: #b91c1c;\n  color: white;\n  border: none;\n  border-radius: 50%;\n  width: 26px;\n  height: 26px;\n  cursor: pointer;\n  font-size: 16px;\n  line-height: 1;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.remove-btn:hover {\n  background: #991b1b;\n}\n\n.upload-actions {\n  display: flex;\n  gap: 12px;\n}\n\n.upload-results {\n  margin-top: 30px;\n  padding-top: 30px;\n  border-top: 1px solid #e9ecef;\n}\n\n.results-summary {\n  display: flex;\n  gap: 20px;\n  margin-bottom: 16px;\n}\n\n.results-summary .success {\n  color: #16a34a;\n  font-weight: 500;\n}\n\n.results-summary .error {\n  color: #b91c1c;\n  font-weight: 500;\n}\n\n.results-list {\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.result-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e9ecef;\n}\n\n.result-item:last-child {\n  border-bottom: none;\n}\n\n.result-item.success {\n  background: #f0fdf4;\n}\n\n.result-item.error {\n  background: #fff5f5;\n  color: #b91c1c;\n}\n\n.result-icon {\n  font-size: 24px;\n  line-height: 1;\n}\n\n.result-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.result-file {\n  font-weight: 500;\n  color: #1e293b;\n}\n\n.result-message {\n  font-size: 13px;\n  color: #64748b;\n}\n\n.result-partner {\n  font-size: 13px;\n  color: #2563eb;\n  font-weight: 500;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  background: white;\n  flex-wrap: wrap;\n  gap: 16px;\n}\n\n.section-header h3 {\n  margin: 0;\n  color: #1e293b;\n  font-weight: 600;\n  font-size: 18px;\n}\n\n/* Панель фильтров */\n.filters-bar {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  padding: 16px 24px;\n  background: #f8fafc;\n  border-bottom: 1px solid #e5e7eb;\n  flex-wrap: wrap;\n}\n\n.filter-group {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.filter-group label {\n  font-size: 14px;\n  font-weight: 500;\n  color: #64748b;\n  white-space: nowrap;\n}\n\n.filter-buttons {\n  display: flex;\n  gap: 6px;\n}\n\n.filter-btn {\n  padding: 6px 14px;\n  border: 1px solid #cbd5e1;\n  background: white;\n  border-radius: 6px;\n  font-size: 13px;\n  color: #475569;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-weight: 500;\n}\n\n.filter-btn:hover {\n  background: #f1f5f9;\n  border-color: #94a3b8;\n}\n\n.filter-btn.active {\n  background: #2563eb;\n  border-color: #2563eb;\n  color: white;\n}\n\n.filter-input {\n  padding: 6px 12px;\n  border: 1px solid #cbd5e1;\n  border-radius: 6px;\n  font-size: 13px;\n  color: #1e293b;\n  min-width: 150px;\n  transition: all 0.2s ease;\n}\n\n.filter-input:focus {\n  outline: none;\n  border-color: #2563eb;\n  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n}\n\n.filter-select {\n  padding: 6px 12px;\n  border: 1px solid #cbd5e1;\n  border-radius: 6px;\n  font-size: 13px;\n  color: #1e293b;\n  min-width: 180px;\n  background: white;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.filter-select:focus {\n  outline: none;\n  border-color: #2563eb;\n  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n}\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.checkbox-label input[type=\"checkbox\"] {\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n}\n\n.checkbox-label span {\n  font-size: 13px;\n  color: #475569;\n  font-weight: 500;\n}\n\n.filter-stats {\n  margin-left: auto;\n  font-size: 13px;\n  color: #64748b;\n  font-weight: 500;\n  padding: 6px 14px;\n  background: white;\n  border: 1px solid #cbd5e1;\n  border-radius: 6px;\n}\n\n.actions {\n  display: flex;\n  gap: 10px;\n  flex-wrap: wrap;\n}\n\n.upload-area {\n  border: 2px dashed #cbd5e1;\n  border-radius: 8px;\n  padding: 60px 40px;\n  text-align: center;\n  background: #f9fafb;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  position: relative;\n}\n\n.upload-area:hover {\n  border-color: #2563eb;\n  background: #f1f5f9;\n}\n\n.upload-area.dragover {\n  border-color: #2563eb;\n  background: #e0e7ff;\n  border-style: solid;\n}\n\n.upload-content p {\n  color: #64748b;\n  margin: 16px 0;\n  font-size: 16px;\n}\n\n.upload-hint {\n  color: #94a3b8;\n  font-size: 14px;\n}\n\n.link-btn {\n  color: #2563eb;\n  text-decoration: none;\n  font-weight: 500;\n  border-bottom: 1px solid transparent;\n  transition: all 0.2s ease;\n}\n\n.link-btn:hover {\n  border-bottom-color: #2563eb;\n}\n\n.documents-table,\n.partners-table {\n  width: 100%;\n  border-collapse: collapse;\n  background: white;\n  border-radius: 0;\n  overflow: hidden;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);\n}\n\n.documents-table th,\n.documents-table td,\n.partners-table th,\n.partners-table td {\n  padding: 14px 16px;\n  text-align: left;\n  border-bottom: 1px solid #e5e7eb;\n  font-size: 14px;\n}\n\n.documents-table th,\n.partners-table th {\n  background: #f9fafb;\n  font-weight: 600;\n  color: #374151;\n  font-size: 13px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  white-space: nowrap;\n}\n\n.documents-table tbody tr,\n.partners-table tbody tr {\n  transition: background-color 0.2s ease;\n}\n\n.documents-table tbody tr:hover,\n.partners-table tbody tr:hover {\n  background: #f9fafb;\n}\n\n.documents-table tbody tr:last-child td,\n.partners-table tbody tr:last-child td {\n  border-bottom: none;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 8px;\n}\n\n.bulk-actions {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  background: #f9fafb;\n  border-top: 1px solid #e5e7eb;\n  flex-wrap: wrap;\n  gap: 12px;\n}\n\n.status {\n  padding: 4px 10px;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  display: inline-block;\n}\n\n.status.uploaded {\n  background: #fef3c7;\n  color: #78350f;\n}\n\n.status.published {\n  background: #d1fae5;\n  color: #065f46;\n}\n\n.status.error {\n  background: #fee2e2;\n  color: #991b1b;\n}\n\n.status.active {\n  background: #d1fae5;\n  color: #065f46;\n}\n\n.status.inactive {\n  background: #fee2e2;\n  color: #991b1b;\n}\n\n.badge {\n  padding: 4px 12px;\n  border-radius: 12px;\n  font-size: 11px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  display: inline-block;\n}\n\n.badge-superadmin {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);\n}\n\n.badge-admin {\n  background: #e0e7ff;\n  color: #4f46e5;\n}\n\n.password-status.set {\n  color: #16a34a;\n  font-weight: 600;\n}\n\n.password-status.not-set {\n  color: #b91c1c;\n  font-weight: 600;\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 20px;\n}\n\n.modal {\n  background: white;\n  border-radius: 8px;\n  width: 100%;\n  max-width: 500px;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n  border: 1px solid #e5e7eb;\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  background: white;\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: #1e293b;\n  font-weight: 600;\n  font-size: 18px;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 24px;\n  cursor: pointer;\n  color: #6b7280;\n  transition: color 0.2s ease;\n  width: 32px;\n  height: 32px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.close-btn:hover {\n  background: #f3f4f6;\n  color: #1f2937;\n}\n\n.modal-body {\n  padding: 24px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 6px;\n  font-weight: 500;\n  color: #374151;\n  font-size: 14px;\n}\n\n.form-group input {\n  width: 100%;\n  padding: 10px 14px;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  font-size: 14px;\n  transition: all 0.2s ease;\n  background: white;\n}\n\n.form-group input:focus {\n  outline: none;\n  border-color: #2563eb;\n  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 10px;\n  padding: 20px 24px;\n  border-top: 1px solid #e5e7eb;\n  background: #f9fafb;\n}\n\n.btn {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n  white-space: nowrap;\n}\n\n.btn-sm {\n  padding: 6px 12px;\n  font-size: 13px;\n  border-radius: 5px;\n}\n\n.btn-primary {\n  background: #2563eb;\n  color: white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.btn-primary:hover {\n  background: #1d4ed8;\n  box-shadow: 0 2px 6px rgba(37, 99, 235, 0.3);\n}\n\n.btn-secondary {\n  background: #64748b;\n  color: white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.btn-secondary:hover {\n  background: #475569;\n  box-shadow: 0 2px 6px rgba(100, 116, 139, 0.3);\n}\n\n.btn-success {\n  background: #16a34a;\n  color: white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.btn-success:hover {\n  background: #15803d;\n  box-shadow: 0 2px 6px rgba(22, 163, 74, 0.3);\n}\n\n.btn-danger {\n  background: #b91c1c;\n  color: white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.btn-danger:hover {\n  background: #991b1b;\n  box-shadow: 0 2px 6px rgba(185, 28, 28, 0.3);\n}\n\n.btn-info {\n  background: #06b6d4;\n  color: white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.btn-info:hover {\n  box-shadow: 0 2px 6px rgba(6, 182, 212, 0.3);\n}\n\n/* Outlined blue button (transparent background, blue border/text) */\n.btn-outline-blue {\n  background: transparent;\n  color: #2563eb;\n  border: 1px solid #2563eb;\n  padding: 6px 12px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: background 0.15s ease, color 0.15s ease;\n}\n.btn-outline-blue:hover {\n  background: rgba(37, 99, 235, 0.06);\n}\n\n.btn:disabled {\n  background: #e5e7eb;\n  color: #9ca3af;\n  cursor: not-allowed;\n  box-shadow: none;\n}\n\n.btn:disabled:hover {\n  background: #e5e7eb;\n  box-shadow: none;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 80px 40px;\n  color: #64748b;\n}\n\n.empty-icon {\n  font-size: 5rem;\n  margin-bottom: 24px;\n  opacity: 0.7;\n  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));\n}\n\ninput[type=\"checkbox\"] {\n  width: 16px;\n  height: 16px;\n}\n\n/* Icons */\n\n\n@media (max-width: 768px) {\n  .dashboard-container {\n    padding: 16px;\n  }\n  \n  .tabs {\n    flex-direction: column;\n  }\n  \n  .section-header {\n    flex-direction: column;\n    gap: 16px;\n    align-items: stretch;\n  }\n  \n  .filters-bar {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 12px;\n  }\n  \n  .filter-group {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 6px;\n  }\n  \n  .filter-input,\n  .filter-select {\n    width: 100%;\n    min-width: unset;\n  }\n  \n  .filter-buttons {\n    flex-wrap: wrap;\n  }\n  \n  .filter-stats {\n    margin-left: 0;\n    text-align: center;\n  }\n  \n  .actions {\n    justify-content: stretch;\n  }\n  \n  .upload-area {\n    padding: 40px 20px;\n  }\n  \n  .documents-table,\n  .partners-table {\n    display: block;\n    overflow-x: auto;\n    white-space: nowrap;\n  }\n  \n  .bulk-actions {\n    flex-direction: column;\n    gap: 12px;\n    align-items: stretch;\n  }\n  \n  .modal {\n    width: 100%;\n    margin: 20px;\n    max-width: calc(100vw - 40px);\n  }\n}\n\n/* Modern animations and effects */\n.tab-content {\n  animation: fadeInUp 0.4s ease-out;\n}\n\n.doc-filter {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.doc-filter .btn-small {\n  white-space: nowrap;\n  font-size: 13px;\n  padding: 8px 14px;\n}\n\n.doc-filter .btn-small.active {\n  background: #2563eb;\n  color: #ffffff;\n  border-color: #1e40af;\n  box-shadow: 0 2px 6px rgba(37,99,235,0.12);\n}\n\n.doc-filter .btn-small:focus {\n  outline: none;\n  box-shadow: 0 0 0 3px rgba(37,99,235,0.12);\n}\n\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.stat-card {\n  animation: slideInUp 0.6s ease-out;\n  animation-fill-mode: both;\n}\n\n.stat-card:nth-child(1) { animation-delay: 0.1s; }\n.stat-card:nth-child(2) { animation-delay: 0.2s; }\n.stat-card:nth-child(3) { animation-delay: 0.3s; }\n\n@keyframes slideInUp {\n  from {\n    opacity: 0;\n    transform: translateY(30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.documents-table tbody tr,\n.partners-table tbody tr {\n  animation: fadeInScale 0.3s ease-out;\n  animation-fill-mode: both;\n}\n\n.documents-table tbody tr:nth-child(odd),\n.partners-table tbody tr:nth-child(odd) {\n  animation-delay: 0.05s;\n}\n\n.documents-table tbody tr:nth-child(even),\n.partners-table tbody tr:nth-child(even) {\n  animation-delay: 0.1s;\n}\n\n@keyframes fadeInScale {\n  from {\n    opacity: 0;\n    transform: scale(0.98);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n/* Enhanced focus states */\n.form-group input:focus {\n  outline: none;\n  border-color: #2563eb;\n  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n}\n\n/* Smooth transitions for all interactive elements */\n.tab,\n.btn,\n.remove-btn,\n.close-btn,\n.form-group input,\n.documents-table tbody tr,\n.partners-table tbody tr,\n.stat-card {\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n/* Glass morphism effect for special elements */\n.section-header {\n  backdrop-filter: blur(10px);\n  background: rgba(248, 250, 252, 0.8);\n  border-bottom: 1px solid rgba(226, 232, 240, 0.5);\n}\n.btn-small {\n  padding: 8px 16px;\n  font-size: 12px;\n  border-radius: 8px;\n  margin-right: 6px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.btn-info {\n  background: #06b6d4;\n  color: white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n\n.btn-info:hover {\n  box-shadow: 0 2px 6px rgba(6, 182, 212, 0.3);\n}\n\n.btn-danger {\n  background: #b91c1c;\n  color: white;\n  border: 1px solid #b91c1c;\n}\n\n.btn-danger:hover {\n  background: #991b1b;\n  border-color: #7f1d1d;\n}\n\n.modal-large {\n  width: 900px;\n  max-width: 95vw;\n  max-height: 80vh;\n}\n\n.partners-table th:last-child,\n.partners-table td:last-child {\n  width: 220px;\n}\n\n@media (max-width: 768px) {\n  .dashboard-container {\n    padding: 12px;\n  }\n  \n  .stats-grid {\n    grid-template-columns: 1fr;\n    gap: 8px;\n    margin-bottom: 18px;\n  }\n\n  .stat-card {\n    padding: 8px;\n    gap: 6px;\n  }\n\n  .stat-icon {\n    font-size: 1.2rem;\n  }\n\n  .stat-value {\n    font-size: 1.1rem;\n    line-height: 1.1;\n  }\n\n  .stat-label {\n    font-size: 0.65rem;\n    opacity: 0.9;\n  }\n  \n  .stat-card::before {\n    height: 2px;\n    left: 12px;\n    right: 12px;\n  }\n  \n  /* Keep primary tabs on a single row on small screens */\n  .tabs {\n    flex-direction: row;\n    flex-wrap: nowrap;\n    gap: 8px;\n    overflow-x: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n\n  .tab {\n    text-align: center;\n    padding: 10px 14px;\n    flex: none;\n    white-space: nowrap;\n    font-size: 14px;\n  }\n  \n  .section-header {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 10px;\n  }\n\n  /* Keep header action buttons compact (don't stretch full width) */\n  .actions {\n    flex-direction: column;\n    gap: 8px;\n  }\n\n  .actions .btn {\n    width: auto;\n    display: inline-flex;\n    justify-content: center;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 8px;\n    align-items: center;\n  }\n\n  .header-actions .search-input-header {\n    flex: 1 1 auto;\n    min-width: 0;\n  }\n\n  .header-actions .btn {\n    width: auto;\n    padding: 8px 10px;\n  }\n  \n  \n  .upload-area {\n    padding: 40px 20px;\n  }\n  \n  .documents-table,\n  .partners-table {\n    display: block;\n    overflow-x: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n  \n  .documents-table th,\n  .documents-table td,\n  .partners-table th,\n  .partners-table td {\n    padding: 12px 10px;\n    font-size: 13px;\n  }\n  \n  .bulk-actions {\n    flex-direction: column;\n    align-items: stretch;\n  }\n  \n  .bulk-actions .btn {\n    width: 100%;\n    justify-content: center;\n  }\n  \n  .modal {\n    width: calc(100vw - 24px);\n    max-width: 100%;\n    margin: 12px;\n  }\n  \n  .modal-large {\n    width: calc(100vw - 24px);\n    max-width: 100%;\n  }\n  \n  .modal-header {\n    padding: 16px;\n    flex-wrap: wrap;\n  }\n  \n  .modal-header h3 {\n    font-size: 16px;\n  }\n  \n  .modal-body {\n    padding: 16px;\n    max-height: 60vh;\n    overflow-y: auto;\n  }\n  \n  .modal-footer {\n    padding: 16px;\n    flex-wrap: wrap;\n    gap: 8px;\n  }\n  \n  .modal-footer .btn {\n    flex: 1;\n    min-width: 120px;\n  }\n  \n  .stat-card {\n    padding: 12px;\n  }\n  \n  .action-buttons {\n    flex-direction: column;\n    gap: 6px;\n  }\n  \n  .action-buttons .btn-icon {\n    width: 100%;\n    margin-right: 0;\n  }\n}\n\n.btn-icon {\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  border: none;\n  background: transparent;\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  transition: background 0.15s ease;\n  margin-right: 4px;\n}\n\n.btn-icon:last-child {\n  margin-right: 0;\n}\n\n/* Make action buttons transparent; icons outlined black */\n.btn-edit,\n.btn-docs,\n.btn-delete,\n.btn-upload {\n  background: transparent;\n  color: inherit;\n  border: 1px solid #e5e7eb;\n  padding: 6px;\n  border-radius: 6px;\n}\n\n.btn-edit:hover,\n.btn-docs:hover,\n.btn-delete:hover,\n.btn-upload:hover {\n  background: rgba(0,0,0,0.04);\n}\n\n.btn-icon img {\n  display: inline-block;\n  vertical-align: middle;\n}\n\n  /* Responsive partner table -> card layout (only for small screens) */\n  @media (max-width: 768px) {\n    /* Tables to cards */\n    .partners-table thead,\n    .documents-table thead {\n      display: none;\n    }\n\n    .partners-table,\n    .documents-table {\n      display: block;\n    }\n\n    .partners-table tbody,\n    .documents-table tbody {\n      display: block;\n    }\n\n    .partners-table tbody tr,\n    .documents-table tbody tr {\n      display: block;\n      background: white;\n      margin-bottom: 12px;\n      border: 1px solid #e5e7eb;\n      border-radius: 8px;\n      padding: 12px;\n    }\n\n    .partners-table td,\n    .documents-table td {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 8px 0;\n      border: none;\n      text-align: right;\n    }\n\n    .partners-table td::before,\n    .documents-table td::before {\n      content: attr(data-label);\n      color: #64748b;\n      font-weight: 600;\n      text-transform: uppercase;\n      font-size: 11px;\n      margin-right: 12px;\n      text-align: left;\n      flex: 1;\n    }\n    \n    .documents-table td:first-child::before {\n      content: '';\n    }\n\n    .partners-table td:last-child,\n    .documents-table td:last-child {\n      display: flex;\n      justify-content: flex-end;\n      flex-wrap: wrap;\n      gap: 6px;\n    }\n    \n    .documents-table td:last-child::before {\n      display: none;\n    }\n\n    .action-buttons {\n      display: flex;\n      flex-direction: row;\n      gap: 6px;\n      width: 100%;\n      justify-content: flex-end;\n    }\n    \n    .action-buttons .btn {\n      flex: 1;\n      min-width: 0;\n      font-size: 12px;\n      padding: 8px 10px;\n    }\n\n    .search-input-header {\n      min-width: 0;\n      width: 100%;\n      font-size: 14px;\n      padding: 10px 12px;\n    }\n\n    .btn-icon {\n      width: 38px;\n      height: 38px;\n      padding: 8px;\n    }\n    \n    .btn-icon img {\n      width: 16px !important;\n      height: 16px !important;\n    }\n    \n    /* Document details responsive */\n    .detail-grid {\n      grid-template-columns: 1fr;\n      gap: 12px;\n    }\n    \n    .detail-section {\n      padding: 14px;\n    }\n    \n    .detail-header h4 {\n      font-size: 14px;\n    }\n    \n    /* Forms responsive */\n    .form-group input,\n    .form-group select {\n      font-size: 14px;\n      padding: 10px 12px;\n    }\n    \n    /* Upload area */\n    .upload-area {\n      padding: 30px 20px;\n    }\n    \n    .upload-content p {\n      font-size: 14px;\n    }\n    \n    /* File list */\n    .file-item {\n      padding: 10px 12px;\n    }\n    \n    .file-name {\n      font-size: 13px;\n    }\n    \n    .file-size {\n      font-size: 11px;\n    }\n    \n    /* Bulk actions */\n    .bulk-actions {\n      flex-direction: column;\n      align-items: stretch;\n      gap: 10px;\n    }\n    \n    .bulk-actions .btn {\n      width: 100%;\n    }\n    \n    /* Doc filter buttons */\n    .doc-filter {\n      width: 100%;\n      justify-content: stretch;\n    }\n    \n    .doc-filter .btn-small {\n      flex: 1;\n      text-align: center;\n    }\n    \n    /* Header actions */\n    .header-actions {\n      width: 100%;\n      flex-direction: column;\n    }\n    \n    .header-actions .btn {\n      width: 100%;\n    }\n    \n    /* Section header */\n    .section-header {\n      padding: 14px 16px;\n    }\n    \n    .section-header h3 {\n      font-size: 16px;\n    }\n    \n    .actions {\n      width: 100%;\n      flex-direction: column;\n    }\n    \n    .actions .btn {\n      width: 100%;\n      justify-content: center;\n    }\n  }\n\n.btn-delete {\n  color: white;\n}\n\n.btn-upload {\n  color: white;\n}\n\n/* Search input in header */\n.search-input-header {\n  padding: 0.5rem 1rem;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  min-width: 300px;\n  transition: all 0.2s;\n}\n\n.search-input-header:focus {\n  outline: none;\n  border-color: #06b6d4;\n  box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);\n}\n\n.header-actions {\n  display: flex;\n  gap: 1rem;\n  align-items: center;\n}\n\n/* Partner Selection Modal Styles */\n.modal-large {\n  max-width: 800px;\n}\n\n.partner-search {\n  position: relative;\n  margin-bottom: 1.5rem;\n}\n\n.partner-search input {\n  padding: 0.75rem 1rem 0.75rem 2.5rem;\n  font-size: 1rem;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  width: 100%;\n  transition: all 0.2s;\n}\n\n.partner-search input:focus {\n  outline: none;\n  border-color: #06b6d4;\n  box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);\n}\n\n.partner-search i {\n  position: absolute;\n  left: 1rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #9ca3af;\n}\n\n.file-partner-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.file-partner-item {\n  background: #f9fafb;\n  padding: 1rem;\n  border-radius: 8px;\n  border: 1px solid #e5e7eb;\n}\n\n.file-name {\n  font-weight: 500;\n  color: #374151;\n  margin-bottom: 0.75rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.file-name i {\n  color: #06b6d4;\n}\n\n.partner-selector {\n  position: relative;\n}\n\n.partner-select-btn {\n  width: 100%;\n  padding: 0.75rem 1rem;\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  text-align: left;\n  cursor: pointer;\n  transition: all 0.2s;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.partner-select-btn:hover {\n  border-color: #06b6d4;\n}\n\n.partner-select-btn.selected {\n  border-color: #06b6d4;\n  background: #f0fdfa;\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 0.25rem;\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  max-height: 250px;\n  overflow-y: auto;\n  z-index: 1000;\n  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n}\n\n/* Full-width partner list */\n.partner-list-full {\n  width: 100%;\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  max-height: 400px;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n\n.partner-list-item {\n  padding: 0.75rem 1rem;\n  border-bottom: 1px solid #f3f4f6;\n  cursor: pointer;\n}\n\n.partner-list-item:hover {\n  background: #f0fdfa;\n}\n\n.file-chip {\n  padding: 0.5rem 0.75rem;\n  border-radius: 20px;\n  border: 1px solid #e5e7eb;\n  background: white;\n  margin-right: 0.5rem;\n  cursor: pointer;\n}\n\n.file-chip.active {\n  background: #eefaf9;\n  border-color: #06b6d4;\n}\n\n.chips-row {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n  flex-wrap: wrap;\n}\n\n.chip-badge {\n  margin-left: 0.5rem;\n  font-size: 0.85rem;\n  color: #16a34a;\n}\n\n.dropdown-item {\n  padding: 0.75rem 1rem;\n  cursor: pointer;\n  transition: background 0.2s;\n  border-bottom: 1px solid #f3f4f6;\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover {\n  background: #f0fdfa;\n}\n\n.partner-info {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.partner-name {\n  font-weight: 500;\n  color: #374151;\n}\n\n.partner-email {\n  font-size: 0.875rem;\n  color: #6b7280;\n}\n\n.selected-partner {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  color: #16a34a;\n  font-weight: 500;\n}\n\n.empty-message {\n  text-align: center;\n  padding: 2rem;\n  color: #6b7280;\n}\n\n/* Ensure specific icons can be inverted to white */\n.icon-img-invert {\n  filter: brightness(0) invert(1) !important;\n}\n\n/* Document Details View Modal */\n.document-details {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.detail-section {\n  background: #f9fafb;\n  border-radius: 8px;\n  padding: 20px;\n  border: 1px solid #e5e7eb;\n}\n\n.detail-header {\n  margin-bottom: 16px;\n  padding-bottom: 12px;\n  border-bottom: 2px solid #e5e7eb;\n}\n\n.detail-header h4 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n  color: #1e293b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.detail-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 16px;\n}\n\n.detail-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.detail-label {\n  font-size: 12px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.detail-value {\n  font-size: 14px;\n  font-weight: 500;\n  color: #1e293b;\n  word-break: break-word;\n}\n\n.detail-value.amount {\n  font-size: 16px;\n  font-weight: 600;\n  color: #2563eb;\n}\n\n.status-badge {\n  display: inline-block;\n  padding: 4px 12px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.status-badge.published {\n  background: #d1fae5;\n  color: #065f46;\n}\n\n.status-badge.unpublished {\n  background: #fef3c7;\n  color: #78350f;\n}\n\n</style>"],"mappings":";;;;AAy4BA,SAASA,GAAG,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,KAAK,QAAQ,KAAI;AACpD,OAAOC,SAAS,MAAM,4BAA2B;AACjD,OAAOC,gBAAgB,MAAM,mCAAkC;AAC/D,OAAOC,WAAW,MAAM,8BAA6B;AACrD,SAASC,YAAY,QAAQ,eAAc;AAC3C,SAASC,oBAAoB,QAAQ,wBAAuB;AAC5D,OAAOC,GAAG,MAAM,iBAAgB;;;;;;;IAEhC,MAAMC,SAAS,GAAGH,YAAY,CAAC;IAC/B,MAAMI,iBAAiB,GAAGH,oBAAoB,CAAC;;IAE/C;IACA,MAAMI,IAAI,GAAGZ,GAAG,CAAC,IAAI;IACrB,MAAMa,KAAK,GAAGb,GAAG,CAAC,CAAC,CAAC;IACpB,MAAMc,SAAS,GAAGd,GAAG,CAAC,UAAU;;IAEhC;IACA,MAAMe,YAAY,GAAGb,QAAQ,CAAC,MAAM;MAClC,OAAOQ,SAAS,CAACE,IAAI,EAAEI,SAAS,KAAK,YAAW;IAClD,CAAC;;IAED;IACA,MAAMC,IAAI,GAAGf,QAAQ,CAAC,MAAM;MAC1B,MAAMgB,QAAQ,GAAG,CACf;QAAEC,EAAE,EAAE,UAAU;QAAEC,KAAK,EAAE;MAAW,CAAC,EACrC;QAAED,EAAE,EAAE,QAAQ;QAAEC,KAAK,EAAE;MAAW,CAAC,EACnC;QAAED,EAAE,EAAE,WAAW;QAAEC,KAAK,EAAE;MAAY,EACxC;;MAEA;MACA,IAAIL,YAAY,CAACM,KAAK,EAAE;QACtBH,QAAQ,CAACI,IAAI,CAAC;UAAEH,EAAE,EAAE,QAAQ;UAAEC,KAAK,EAAE;QAAiB,CAAC;QACvDF,QAAQ,CAACI,IAAI,CAAC;UAAEH,EAAE,EAAE,OAAO;UAAEC,KAAK,EAAE;QAAiB,CAAC;MACxD;MAEA,OAAOF,QAAO;IAChB,CAAC;;IAED;IACA,MAAMK,aAAa,GAAGvB,GAAG,CAAC,EAAE;IAC5B,MAAMwB,SAAS,GAAGxB,GAAG,CAAC,KAAK;IAC3B,MAAMyB,aAAa,GAAGzB,GAAG,CAAC,EAAE;IAC5B,MAAM0B,UAAU,GAAG1B,GAAG,CAAC,KAAK;;IAE5B;IACA,MAAM2B,eAAe,GAAG3B,GAAG,CAAC,EAAE;IAC9B,MAAM4B,aAAa,GAAG5B,GAAG,CAAC,KAAK;IAC/B,MAAM6B,iBAAiB,GAAG7B,GAAG,CAAC,EAAE;IAChC,MAAM8B,oBAAoB,GAAG9B,GAAG,CAAC,KAAK;;IAEtC;IACA,MAAM+B,iBAAiB,GAAG/B,GAAG,CAAC,EAAE;IAChC,MAAMgC,cAAc,GAAGhC,GAAG,CAAC,EAAE;IAC7B,MAAMiC,gBAAgB,GAAGjC,GAAG,CAAC,KAAK;IAClC,MAAMkC,UAAU,GAAGlC,GAAG,CAAC,KAAK;IAC5B;IACA,MAAMmC,YAAY,GAAGnC,GAAG,CAAC,KAAK;IAC9B,MAAMoC,uBAAuB,GAAGpC,GAAG,CAAC,KAAK;IACzC,MAAMqC,eAAe,GAAGrC,GAAG,CAAC,aAAa,CAAC,EAAC;IAC3C,MAAMsC,mBAAmB,GAAGtC,GAAG,CAAC,EAAE,CAAC,EAAC;IACpC,MAAMuC,qBAAqB,GAAGvC,GAAG,CAAC,EAAE,CAAC,EAAC;IACtC,MAAMwC,gBAAgB,GAAGxC,GAAG,CAAC,EAAE,CAAC,EAAC;IACjC,MAAMyC,cAAc,GAAGzC,GAAG,CAAC,EAAE,CAAC,EAAC;;IAE/B,MAAM0C,kBAAkB,GAAIrB,KAAK,IAAK;MACpCgB,eAAe,CAAChB,KAAK,GAAGA,KAAI;MAC5BsB,gBAAgB,CAAC;IACnB;;IAEA;IACA,MAAMC,sBAAsB,GAAG5C,GAAG,CAAC,IAAI;IACvC,MAAM6C,wBAAwB,GAAG7C,GAAG,CAAC,EAAE;IACvC,MAAM8C,eAAe,GAAG9C,GAAG,CAAC,KAAK;;IAEjC;IACA,MAAM+C,QAAQ,GAAG/C,GAAG,CAAC,EAAE;IACvB,MAAMgD,eAAe,GAAGhD,GAAG,CAAC,KAAK;IACjC,MAAMiD,kBAAkB,GAAGjD,GAAG,CAAC,EAAE;IACjC,MAAMkD,mBAAmB,GAAGlD,GAAG,CAAC,KAAK,CAAC,EAAC;IACvC,MAAMmD,qBAAqB,GAAGnD,GAAG,CAAC,KAAK,CAAC,EAAC;IACzC,MAAMoD,sBAAsB,GAAGpD,GAAG,CAAC,KAAK;IACxC,MAAMqD,eAAe,GAAGrD,GAAG,CAAC,KAAK;IACjC,MAAMsD,oBAAoB,GAAGtD,GAAG,CAAC,KAAK;IACtC,MAAMuD,cAAc,GAAGvD,GAAG,CAAC,KAAK;IAChC,MAAMwD,aAAa,GAAGxD,GAAG,CAAC,IAAI;IAC9B,MAAMyD,yBAAyB,GAAGzD,GAAG,CAAC,KAAK;IAC3C,MAAM0D,gBAAgB,GAAG1D,GAAG,CAAC,EAAE;IAC/B,MAAM2D,qBAAqB,GAAG3D,GAAG,CAAC,KAAK;IACvC,MAAM4D,eAAe,GAAG5D,GAAG,CAAC,IAAI;IAChC,MAAM6D,sBAAsB,GAAG7D,GAAG,CAAC,KAAK;IACxC,MAAM8D,SAAS,GAAG9D,GAAG,CAAC,IAAI;IAC1B,MAAM+D,UAAU,GAAG/D,GAAG,CAAC;MACrBgE,IAAI,EAAE,EAAE;MACRC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,SAAS,EAAE,EAAE;MACbC,MAAM,EAAE;IACV,CAAC;;IAED;IACA,MAAMC,MAAM,GAAGvE,GAAG,CAAC,EAAE;IACrB,MAAMwE,aAAa,GAAGxE,GAAG,CAAC,KAAK;IAC/B,MAAMyE,oBAAoB,GAAGzE,GAAG,CAAC,KAAK;IACtC,MAAM0E,aAAa,GAAG1E,GAAG,CAAC,KAAK;IAC/B,MAAM2E,4BAA4B,GAAG3E,GAAG,CAAC,KAAK;IAC9C,MAAM4E,gBAAgB,GAAG5E,GAAG,CAAC,KAAK;IAClC,MAAM6E,WAAW,GAAG7E,GAAG,CAAC,IAAI;IAC5B,MAAM8E,gBAAgB,GAAG9E,GAAG,CAAC,EAAE;IAC/B,MAAM+E,QAAQ,GAAG/E,GAAG,CAAC;MACnBgF,QAAQ,EAAE,EAAE;MACZf,KAAK,EAAE,EAAE;MACTG,QAAQ,EAAE;IACZ,CAAC;;IAED;IACA,MAAMa,SAAS,GAAGjF,GAAG,CAAC,EAAE;IACxB,MAAMkF,gBAAgB,GAAGlF,GAAG,CAAC,KAAK;IAClC,MAAMmF,gBAAgB,GAAGnF,GAAG,CAAC,EAAE;IAC/B,MAAMoF,gBAAgB,GAAGpF,GAAG,CAAC,EAAE;IAC/B,MAAMqF,qBAAqB,GAAGrF,GAAG,CAAC,EAAE;IACpC,MAAMsF,aAAa,GAAGtF,GAAG,CAAC,EAAE;IAC5B,MAAMuF,WAAW,GAAGvF,GAAG,CAAC,EAAE;IAC1B,MAAMwF,qBAAqB,GAAGxF,GAAG,CAAC,KAAK;IACvC,MAAMyF,gBAAgB,GAAGzF,GAAG,CAAC,IAAI;;IAEjC;IACA,MAAM0F,gBAAgB,GAAG1F,GAAG,CAAC,KAAK;IAClC,MAAM2F,YAAY,GAAG3F,GAAG,CAAC,EAAE;IAC3B,MAAM4F,cAAc,GAAG5F,GAAG,CAAC,EAAE;IAC7B,MAAM6F,aAAa,GAAG7F,GAAG,CAAC,IAAI;IAC9B,MAAM8F,iBAAiB,GAAG9F,GAAG,CAAC,QAAQ;IACtC,MAAM+F,cAAc,GAAG/F,GAAG,CAAC,KAAK;IAChC,IAAIgG,eAAe,GAAG,IAAG;IAEzB,MAAMC,WAAW,GAAGA,CAAC;MAAEC,KAAK,GAAG,eAAe;MAAEC,OAAO,GAAG,EAAE;MAAEC,MAAM,GAAG,IAAI;MAAEC,UAAU,GAAG,QAAQ;MAAEC,SAAS,GAAG;IAAK,CAAC,KAAK;MACzHX,YAAY,CAACtE,KAAK,GAAG6E,KAAI;MACzBN,cAAc,CAACvE,KAAK,GAAG8E,OAAM;MAC7BN,aAAa,CAACxE,KAAK,GAAG+E,MAAK;MAC3BN,iBAAiB,CAACzE,KAAK,GAAGgF,UAAS;MACnCL,eAAe,GAAGM,SAAQ;MAC1BP,cAAc,CAAC1E,KAAK,GAAG,KAAI;MAC3BqE,gBAAgB,CAACrE,KAAK,GAAG,IAAG;IAC9B;IAEA,MAAMkF,gBAAgB,GAAG,MAAAA,CAAA,KAAY;MACnC,IAAI,CAACP,eAAe,EAAE;QACpBN,gBAAgB,CAACrE,KAAK,GAAG,KAAI;QAC7B;MACF;MACA,IAAI;QACF0E,cAAc,CAAC1E,KAAK,GAAG,IAAG;QAC1B,MAAM2E,eAAe,CAAC;MACxB,CAAC,CAAC,OAAOQ,CAAC,EAAE;QACVC,OAAO,CAACC,KAAK,CAAC,sBAAsB,EAAEF,CAAC;MACzC,CAAC,SAAS;QACRT,cAAc,CAAC1E,KAAK,GAAG,KAAI;QAC3BqE,gBAAgB,CAACrE,KAAK,GAAG,KAAI;MAC/B;IACF;IAEA,MAAMsF,eAAe,GAAGA,CAAA,KAAM;MAC5BjB,gBAAgB,CAACrE,KAAK,GAAG,KAAI;MAC7B2E,eAAe,GAAG,IAAG;IACvB;;IAEA;IACA,MAAMY,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3BzE,YAAY,CAACd,KAAK,GAAG,IAAG;MACxB,IAAI;QACF,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAAC,cAAc;QAC7CjG,KAAK,CAACQ,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAAClG,KAAI;QAChCD,IAAI,CAACS,KAAK,GAAGX,SAAS,CAACE,IAAG;MAC5B,CAAC,CAAC,OAAO8F,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,6BAA6B,EAAEA,KAAK;QAClD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACRhE,YAAY,CAACd,KAAK,GAAG,KAAI;MAC3B;IACF;IAEA,MAAM6F,gBAAgB,GAAIC,KAAK,IAAK;MAClC,MAAMC,KAAK,GAAGC,KAAK,CAACC,IAAI,CAACH,KAAK,CAACI,MAAM,CAACH,KAAK;MAC3CI,QAAQ,CAACJ,KAAK;IAChB;IAEA,MAAMK,UAAU,GAAIN,KAAK,IAAK;MAC5BzF,UAAU,CAACL,KAAK,GAAG,KAAI;MACvB,MAAM+F,KAAK,GAAGC,KAAK,CAACC,IAAI,CAACH,KAAK,CAACO,YAAY,CAACN,KAAK;MACjDI,QAAQ,CAACJ,KAAK;IAChB;IAEA,MAAMI,QAAQ,GAAIJ,KAAK,IAAK;MAC1B,MAAMO,UAAU,GAAGP,KAAK,CAACQ,MAAM,CAACC,IAAI,IAClCA,IAAI,CAACZ,IAAI,KAAK,mEAAmE,IACjFY,IAAI,CAACZ,IAAI,KAAK,0BAA0B,IACxCY,IAAI,CAAC7D,IAAI,CAAC8D,QAAQ,CAAC,OAAO,CAAC,IAC3BD,IAAI,CAAC7D,IAAI,CAAC8D,QAAQ,CAAC,MAAM,CAC3B;MAEA,IAAIH,UAAU,CAACI,MAAM,KAAKX,KAAK,CAACW,MAAM,EAAE;QACtCpH,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;MACH;MAEA5E,aAAa,CAACF,KAAK,GAAG,CAAC,GAAGE,aAAa,CAACF,KAAK,EAAE,GAAGsG,UAAU;IAC9D;IAEA,MAAMK,UAAU,GAAIC,KAAK,IAAK;MAC5B1G,aAAa,CAACF,KAAK,CAAC6G,MAAM,CAACD,KAAK,EAAE,CAAC;IACrC;;IAEA;;IAEA,MAAME,gBAAgB,GAAGjI,QAAQ,CAAC,MAAM;MACtC,IAAIkI,QAAQ,GAAGrF,QAAQ,CAAC1B,KAAI;;MAE5B;MACA,IAAI6B,mBAAmB,CAAC7B,KAAK,KAAK,QAAQ,EAAE;QAC1C+G,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAACS,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,CAAC,IAAID,CAAC,CAACC,MAAM,KAAK,IAAI;MACrE,CAAC,MAAM,IAAIpF,mBAAmB,CAAC7B,KAAK,KAAK,UAAU,EAAE;QACnD+G,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAACS,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,CAAC,IAAID,CAAC,CAACC,MAAM,KAAK,KAAK;MACtE;;MAEA;MACA,IAAInF,qBAAqB,CAAC9B,KAAK,EAAE;QAC/B,MAAMkH,YAAY,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC;QACzCL,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAACS,CAAC,IAAI;UAC9B,IAAI,CAACA,CAAC,CAACK,SAAS,EAAE,OAAO,KAAI;UAC7B,MAAMrE,SAAS,GAAG,IAAImE,IAAI,CAACH,CAAC,CAACK,SAAS;UACtC,OAAOrE,SAAS,CAACoE,QAAQ,CAAC,CAAC,KAAKF,YAAW;QAC7C,CAAC;MACH;;MAEA;MACA,IAAItF,kBAAkB,CAAC5B,KAAK,EAAE;QAC5B,MAAMsH,KAAK,GAAG1F,kBAAkB,CAAC5B,KAAK,CAACuH,WAAW,CAAC;QACnDR,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAACS,CAAC,IAAI;UAC9B,MAAMrE,IAAI,GAAG,CAACqE,CAAC,CAACQ,IAAI,IAAIR,CAAC,CAACrE,IAAI,IAAI,EAAE,EAAE4E,WAAW,CAAC;UAClD,MAAM3E,KAAK,GAAG,CAACoE,CAAC,CAACS,KAAK,IAAIT,CAAC,CAACpE,KAAK,IAAI,EAAE,EAAE2E,WAAW,CAAC;UACrD,MAAMG,GAAG,GAAGC,MAAM,CAACX,CAAC,CAACY,GAAG,IAAIZ,CAAC,CAACa,SAAS,IAAI,EAAE;UAC7C,MAAM/E,KAAK,GAAG,CAACkE,CAAC,CAACc,KAAK,IAAId,CAAC,CAAClE,KAAK,IAAI,EAAE,EAAEyE,WAAW,CAAC;UAErD,OAAO5E,IAAI,CAACoF,QAAQ,CAACT,KAAK,CAAC,IACpB1E,KAAK,CAACmF,QAAQ,CAACT,KAAK,CAAC,IACrBI,GAAG,CAACK,QAAQ,CAACT,KAAK,CAAC,IACnBxE,KAAK,CAACiF,QAAQ,CAACT,KAAK;QAC7B,CAAC;MACH;MAEA,OAAOP,QAAO;IAChB,CAAC;;IAED;IACA,MAAMiB,iBAAiB,GAAGnJ,QAAQ,CAAC,MAAM;MACvC,IAAIkI,QAAQ,GAAGrG,iBAAiB,CAACV,KAAI;;MAErC;MACA,IAAIkB,qBAAqB,CAAClB,KAAK,EAAE;QAC/B+G,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAAC0B,GAAG,IAAIN,MAAM,CAACM,GAAG,CAACJ,SAAS,CAAC,KAAKF,MAAM,CAACzG,qBAAqB,CAAClB,KAAK,CAAC;MACjG;;MAEA;MACA,IAAImB,gBAAgB,CAACnB,KAAK,EAAE;QAC1B,MAAMkI,QAAQ,GAAG,IAAIf,IAAI,CAAChG,gBAAgB,CAACnB,KAAK;QAChDkI,QAAQ,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;QAC5BpB,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAAC0B,GAAG,IAAI;UAChC,MAAMG,OAAO,GAAG,IAAIjB,IAAI,CAACc,GAAG,CAACI,UAAU,IAAIJ,GAAG,CAACK,OAAO;UACtDF,OAAO,CAACD,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;UAC3B,OAAOC,OAAO,IAAIF,QAAO;QAC3B,CAAC;MACH;MAEA,IAAI9G,cAAc,CAACpB,KAAK,EAAE;QACxB,MAAMuI,MAAM,GAAG,IAAIpB,IAAI,CAAC/F,cAAc,CAACpB,KAAK;QAC5CuI,MAAM,CAACJ,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG;QAC/BpB,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAAC0B,GAAG,IAAI;UAChC,MAAMG,OAAO,GAAG,IAAIjB,IAAI,CAACc,GAAG,CAACI,UAAU,IAAIJ,GAAG,CAACK,OAAO;UACtD,OAAOF,OAAO,IAAIG,MAAK;QACzB,CAAC;MACH;;MAEA;MACA,IAAItH,mBAAmB,CAACjB,KAAK,EAAE;QAC7B,MAAMsH,KAAK,GAAGrG,mBAAmB,CAACjB,KAAK,CAACuH,WAAW,CAAC;QACpDR,QAAQ,GAAGA,QAAQ,CAACR,MAAM,CAAC0B,GAAG,IAAI;UAChC,MAAMO,QAAQ,GAAG,CAACP,GAAG,CAACO,QAAQ,IAAIP,GAAG,CAACQ,YAAY,IAAI,EAAE,EAAElB,WAAW,CAAC;UACtE,OAAOiB,QAAQ,CAACT,QAAQ,CAACT,KAAK;QAChC,CAAC;MACH;MAEA,OAAOP,QAAO;IAChB,CAAC;IAED,MAAM2B,oBAAoB,GAAIC,OAAO,IAAK;MACxCpH,sBAAsB,CAACvB,KAAK,GAAG2I,OAAO,CAACf,GAAE;MACzCpG,wBAAwB,CAACxB,KAAK,GAAG2I,OAAO,CAACnB,IAAG;MAC5CtH,aAAa,CAACF,KAAK,GAAG,EAAC;MACvBI,aAAa,CAACJ,KAAK,GAAG,EAAC;MACvByB,eAAe,CAACzB,KAAK,GAAG,IAAG;IAC7B;IAEA,MAAM4I,gBAAgB,GAAGA,CAAA,KAAM;MAC7BnH,eAAe,CAACzB,KAAK,GAAG,KAAI;MAC5BE,aAAa,CAACF,KAAK,GAAG,EAAC;MACvBI,aAAa,CAACJ,KAAK,GAAG,EAAC;MACvBuB,sBAAsB,CAACvB,KAAK,GAAG,IAAG;MAClCwB,wBAAwB,CAACxB,KAAK,GAAG,EAAC;IACpC;IAEA,MAAM6I,qBAAqB,GAAG,MAAAA,CAAA,KAAY;MACxC,IAAI3I,aAAa,CAACF,KAAK,CAAC0G,MAAM,KAAK,CAAC,IAAI,CAACnF,sBAAsB,CAACvB,KAAK,EAAE;MAEvEG,SAAS,CAACH,KAAK,GAAG,IAAG;MACrB,MAAM8I,QAAQ,GAAG,IAAIC,QAAQ,CAAC;;MAE9B;MACA,MAAMC,UAAU,GAAG,EAAC;;MAEpB;MACA9I,aAAa,CAACF,KAAK,CAACiJ,OAAO,CAAEzC,IAAI,IAAK;QACpCsC,QAAQ,CAACI,MAAM,CAAC,OAAO,EAAE1C,IAAI;QAC7BwC,UAAU,CAAC/I,IAAI,CAACsB,sBAAsB,CAACvB,KAAK;MAC9C,CAAC;;MAED;MACA8I,QAAQ,CAACI,MAAM,CAAC,YAAY,EAAEC,IAAI,CAACC,SAAS,CAACJ,UAAU,CAAC;MAExD,IAAI;QACF,MAAMxD,QAAQ,GAAG,MAAMpG,GAAG,CAACiK,IAAI,CAAC,qBAAqB,EAAEP,QAAQ,EAAE;UAC/DQ,OAAO,EAAE;YACP,cAAc,EAAE;UAClB;QACF,CAAC;QAEDlJ,aAAa,CAACJ,KAAK,GAAG,CACpB,GAAGwF,QAAQ,CAACE,IAAI,CAAC6D,OAAO,CAACC,GAAG,CAACC,CAAC,KAAK;UAAE,GAAGA,CAAC;UAAEC,OAAO,EAAE;QAAK,CAAC,CAAC,CAAC,EAC5D,GAAGlE,QAAQ,CAACE,IAAI,CAACiE,MAAM,CAACH,GAAG,CAACrE,CAAC,KAAK;UAAE,GAAGA,CAAC;UAAEuE,OAAO,EAAE;QAAM,CAAC,CAAC,EAC7D;QAEApK,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAEU,QAAQ,CAACE,IAAI,CAACZ;QACzB,CAAC;QAED5E,aAAa,CAACF,KAAK,GAAG,EAAC;QACvBsB,gBAAgB,CAAC;;QAEjB;QACA,MAAMsI,eAAe,GAAG;UACtBhC,GAAG,EAAErG,sBAAsB,CAACvB,KAAK;UACjCwH,IAAI,EAAEhG,wBAAwB,CAACxB;QACjC;QACA4I,gBAAgB,CAAC;QACjB,MAAMiB,oBAAoB,CAACD,eAAe;MAE5C,CAAC,CAAC,OAAOvE,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK;QAC9C/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE,0BAA0B,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;QACvF,CAAC;MACH,CAAC,SAAS;QACR3E,SAAS,CAACH,KAAK,GAAG,KAAI;MACxB;IACF;IAEA,MAAMsB,gBAAgB,GAAG,MAAAA,CAAA,KAAY;MACnCV,gBAAgB,CAACZ,KAAK,GAAG,IAAG;MAC5B,IAAI;QACF,MAAM8J,QAAQ,GAAG9I,eAAe,CAAChB,KAAK,KAAK,aAAa,GAAG,2BAA2B,GAAG,yBAAwB;QACjH,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAACqE,QAAQ;QACvCpJ,iBAAiB,CAACV,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAACA,IAAG;QAC3C/E,cAAc,CAACX,KAAK,GAAG,EAAC;MAC1B,CAAC,CAAC,OAAOqF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,6BAA6B,EAAEA,KAAK;QAClD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACRlE,gBAAgB,CAACZ,KAAK,GAAG,KAAI;MAC/B;IACF;;IAEA;IACA,MAAM+J,oBAAoB,GAAI5E,CAAC,IAAK;MAClC1E,oBAAoB,CAACT,KAAK,GAAG,KAAI;MACjC,MAAM+F,KAAK,GAAGC,KAAK,CAACC,IAAI,CAACd,CAAC,CAACkB,YAAY,CAACN,KAAK,CAAC,CAACQ,MAAM,CAACyD,CAAC,IACrDA,CAAC,CAACrH,IAAI,CAAC8D,QAAQ,CAAC,OAAO,CAAC,IAAIuD,CAAC,CAACrH,IAAI,CAAC8D,QAAQ,CAAC,MAAM,CACpD;MACAnG,eAAe,CAACN,KAAK,GAAG,CAAC,GAAGM,eAAe,CAACN,KAAK,EAAE,GAAG+F,KAAK;IAC7D;IAEA,MAAMkE,0BAA0B,GAAI9E,CAAC,IAAK;MACxC,MAAMY,KAAK,GAAGC,KAAK,CAACC,IAAI,CAACd,CAAC,CAACe,MAAM,CAACH,KAAK;MACvCzF,eAAe,CAACN,KAAK,GAAG,CAAC,GAAGM,eAAe,CAACN,KAAK,EAAE,GAAG+F,KAAK;MAC3DZ,CAAC,CAACe,MAAM,CAAClG,KAAK,GAAG,EAAE,EAAC;IACtB;IAEA,MAAMkK,oBAAoB,GAAItD,KAAK,IAAK;MACtCtG,eAAe,CAACN,KAAK,CAAC6G,MAAM,CAACD,KAAK,EAAE,CAAC;IACvC;IAEA,MAAMuD,eAAe,GAAG,MAAAA,CAAA,KAAY;MAClC,IAAI7J,eAAe,CAACN,KAAK,CAAC0G,MAAM,KAAK,CAAC,EAAE;MAExCnG,aAAa,CAACP,KAAK,GAAG,IAAG;MACzB,MAAM8I,QAAQ,GAAG,IAAIC,QAAQ,CAAC;MAE9BzI,eAAe,CAACN,KAAK,CAACiJ,OAAO,CAACzC,IAAI,IAAI;QACpCsC,QAAQ,CAACI,MAAM,CAAC,OAAO,EAAE1C,IAAI;MAC/B,CAAC;MAED,IAAI;QACF,MAAMhB,QAAQ,GAAG,MAAMpG,GAAG,CAACiK,IAAI,CAAC,0BAA0B,EAAEP,QAAQ,EAAE;UACpEQ,OAAO,EAAE;YACP,cAAc,EAAE;UAClB;QACF,CAAC;QAED9I,iBAAiB,CAACR,KAAK,GAAG,CACxB,GAAGwF,QAAQ,CAACE,IAAI,CAAC6D,OAAO,CAACC,GAAG,CAACC,CAAC,KAAK;UACjC,GAAGA,CAAC;UACJC,OAAO,EAAE,IAAI;UACblB,QAAQ,EAAEiB,CAAC,CAACjB,QAAQ,IAAIiB,CAAC,CAACW,QAAQ;UAClCC,WAAW,EAAEZ,CAAC,CAACY;QACjB,CAAC,CAAC,CAAC,EACH,GAAG7E,QAAQ,CAACE,IAAI,CAACiE,MAAM,CAACH,GAAG,CAACrE,CAAC,KAAK;UAChC,GAAGA,CAAC;UACJuE,OAAO,EAAE,KAAK;UACdlB,QAAQ,EAAErD,CAAC,CAACqD,QAAQ,IAAIrD,CAAC,CAACiF;QAC5B,CAAC,CAAC,EACJ;QAEA,MAAME,YAAY,GAAG9E,QAAQ,CAACE,IAAI,CAAC6D,OAAO,CAAC7C,MAAK;QAChD,MAAM6D,UAAU,GAAG/E,QAAQ,CAACE,IAAI,CAACiE,MAAM,CAACjD,MAAK;QAE7C,IAAI4D,YAAY,GAAG,CAAC,EAAE;UACpBhL,iBAAiB,CAACqG,eAAe,CAAC;YAChCC,IAAI,EAAE,SAAS;YACfd,OAAO,EAAE,sBAAsBwF,YAAY;UAC7C,CAAC;QACH;QAEA,IAAIC,UAAU,GAAG,CAAC,EAAE;UAClBjL,iBAAiB,CAACqG,eAAe,CAAC;YAChCC,IAAI,EAAE,OAAO;YACbd,OAAO,EAAE,WAAWyF,UAAU;UAChC,CAAC;QACH;QAEAjK,eAAe,CAACN,KAAK,GAAG,EAAC;QACzBsB,gBAAgB,CAAC;MAEnB,CAAC,CAAC,OAAO+D,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,iCAAiC,EAAEA,KAAK;QACtD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE,mBAAmB,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;QAChF,CAAC;MACH,CAAC,SAAS;QACRvE,aAAa,CAACP,KAAK,GAAG,KAAI;MAC5B;IACF;IAEA,MAAMwK,eAAe,GAAG,MAAOC,OAAO,IAAK;MACzC,IAAI;QACF,MAAMrL,GAAG,CAACiK,IAAI,CAAC,uBAAuB,EAAE;UACtCqB,QAAQ,EAAE,CAACD,OAAO;QACpB,CAAC;QAEDnL,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;QAEDxD,gBAAgB,CAAC;QACjBiE,QAAQ,CAAC;MAEX,CAAC,CAAC,OAAOF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEA,KAAK;QACzC/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH;IACF;IAEA,MAAM6F,wBAAwB,GAAG,MAAAA,CAAA,KAAY;MAC3C,IAAIhK,cAAc,CAACX,KAAK,CAAC0G,MAAM,KAAK,CAAC,EAAE;MAEvC7F,UAAU,CAACb,KAAK,GAAG,IAAG;MACtB,IAAI;QACF,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACiK,IAAI,CAAC,uBAAuB,EAAE;UACvDqB,QAAQ,EAAE/J,cAAc,CAACX;QAC3B,CAAC;QAEDV,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAEU,QAAQ,CAACE,IAAI,CAACZ;QACzB,CAAC;QAEDxD,gBAAgB,CAAC;QACjBiE,QAAQ,CAAC;MAEX,CAAC,CAAC,OAAOF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEA,KAAK;QACzC/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACRjE,UAAU,CAACb,KAAK,GAAG,KAAI;MACzB;IACF;IAEA,MAAM4K,mBAAmB,GAAG,MAAAA,CAAA,KAAY;MACtC,MAAMC,WAAW,GAAGnK,iBAAiB,CAACV,KAAK,CAACwJ,GAAG,CAACsB,KAAK,IAAIC,UAAU,CAACD,KAAK,CAAC;MAC1EnK,cAAc,CAACX,KAAK,GAAG6K,WAAU;MACjC,MAAMF,wBAAwB,CAAC;IACjC;IAEA,MAAMK,iBAAiB,GAAG,MAAOP,OAAO,IAAK;MAC3C,IAAI,CAACA,OAAO,EAAE;QACZnL,iBAAiB,CAACqG,eAAe,CAAC;UAAEC,IAAI,EAAE,OAAO;UAAEd,OAAO,EAAE;QAAqC,CAAC;QAClG;MACF;MAEAF,WAAW,CAAC;QACVC,KAAK,EAAE,mBAAmB;QAC1BC,OAAO,EAAE,+FAA+F;QACxGC,MAAM,EAAE,kBAAkB;QAC1BC,UAAU,EAAE,QAAQ;QACpBC,SAAS,EAAE,MAAAA,CAAA,KAAY;UACrB,IAAI;YACF,MAAM7F,GAAG,CAACiK,IAAI,CAAC,yBAAyB,EAAE;cACxCqB,QAAQ,EAAE,CAACD,OAAO;YACpB,CAAC;YAEDnL,iBAAiB,CAACqG,eAAe,CAAC;cAChCC,IAAI,EAAE,SAAS;cACfd,OAAO,EAAE;YACX,CAAC;YAEDxD,gBAAgB,CAAC;YACjBiE,QAAQ,CAAC;UAEX,CAAC,CAAC,OAAOF,KAAK,EAAE;YACdD,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEA,KAAK;YAChD/F,iBAAiB,CAACqG,eAAe,CAAC;cAChCC,IAAI,EAAE,OAAO;cACbd,OAAO,EAAE,4BAA4B,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;YACzF,CAAC;YACD,MAAMO,KAAI;UACZ;QACF;MACF,CAAC;IACH;IAEA,MAAM4F,cAAc,GAAG,MAAOR,OAAO,IAAK;MACxC,IAAI,CAACA,OAAO,EAAE;QACZnL,iBAAiB,CAACqG,eAAe,CAAC;UAAEC,IAAI,EAAE,OAAO;UAAEd,OAAO,EAAE;QAAqC,CAAC;QAClG;MACF;MAEAF,WAAW,CAAC;QACVC,KAAK,EAAE,oBAAoB;QAC3BC,OAAO,EAAE,+CAA+C;QACxDC,MAAM,EAAE,SAAS;QACjBC,UAAU,EAAE,QAAQ;QACpBC,SAAS,EAAE,MAAAA,CAAA,KAAY;UACrB,IAAI;YACF,MAAM7F,GAAG,CAAC8L,MAAM,CAAC,iBAAiBT,OAAO,EAAE;YAE3CnL,iBAAiB,CAACqG,eAAe,CAAC;cAChCC,IAAI,EAAE,SAAS;cACfd,OAAO,EAAE;YACX,CAAC;YAEDxD,gBAAgB,CAAC;YACjBiE,QAAQ,CAAC;UAEX,CAAC,CAAC,OAAOF,KAAK,EAAE;YACdD,OAAO,CAACC,KAAK,CAAC,kBAAkB,EAAEA,KAAK;YACvC/F,iBAAiB,CAACqG,eAAe,CAAC;cAChCC,IAAI,EAAE,OAAO;cACbd,OAAO,EAAE,6BAA6B,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;YAC1F,CAAC;YACD,MAAMO,KAAI;UACZ;QACF;MACF,CAAC;IACH;;IAEA;IACA,MAAM8F,WAAW,GAAIxC,OAAO,IAAK;MAC/BxG,aAAa,CAACnC,KAAK,GAAG;QACpB4H,GAAG,EAAEe,OAAO,CAACf,GAAG;QAChBjF,IAAI,EAAEgG,OAAO,CAACnB,IAAI;QAClB5E,KAAK,EAAE+F,OAAO,CAAClB,KAAK;QACpB5E,QAAQ,EAAE8F,OAAO,CAACyC,QAAQ;QAC1BtI,KAAK,EAAE6F,OAAO,CAACb,KAAK,IAAI,EAAE;QAC1B9E,SAAS,EAAE2F,OAAO,CAACtB,SAAS,GAAGsB,OAAO,CAACtB,SAAS,CAACgE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;QACnEpI,MAAM,EAAE0F,OAAO,CAAC1B,MAAM,KAAK,CAAC;QAC5BqE,WAAW,EAAE;MACf;MACArJ,oBAAoB,CAACjC,KAAK,GAAG,IAAG;IAClC;IAEA,MAAMuL,aAAa,GAAG,MAAAA,CAAA,KAAY;MAChCrJ,cAAc,CAAClC,KAAK,GAAG,IAAG;MAC1B,IAAI;QACF,MAAMwL,UAAU,GAAG;UACjB7I,IAAI,EAAER,aAAa,CAACnC,KAAK,CAAC2C,IAAI;UAC9BC,KAAK,EAAET,aAAa,CAACnC,KAAK,CAAC4C,KAAK;UAChCC,QAAQ,EAAEV,aAAa,CAACnC,KAAK,CAAC6C,QAAQ;UACtCC,KAAK,EAAEX,aAAa,CAACnC,KAAK,CAAC8C,KAAK;UAChCE,SAAS,EAAEb,aAAa,CAACnC,KAAK,CAACgD,SAAS,IAAI,IAAI;UAChDC,MAAM,EAAEd,aAAa,CAACnC,KAAK,CAACiD,MAAM,GAAG,CAAC,GAAG;QAC3C;QAEA,IAAId,aAAa,CAACnC,KAAK,CAACsL,WAAW,EAAE;UACnCE,UAAU,CAACzI,QAAQ,GAAGZ,aAAa,CAACnC,KAAK,CAACsL,WAAU;QACtD;QAEA,MAAMlM,GAAG,CAACqM,GAAG,CAAC,mBAAmBtJ,aAAa,CAACnC,KAAK,CAAC4H,GAAG,EAAE,EAAE4D,UAAU;QAEtElM,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;QAED7C,oBAAoB,CAACjC,KAAK,GAAG,KAAI;QACjCmC,aAAa,CAACnC,KAAK,GAAG,IAAG;QACzB0L,YAAY,CAAC;MAEf,CAAC,CAAC,OAAOrG,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,6BAA6B,EAAEA,KAAK;QAClD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE,8BAA8B,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;QAC3F,CAAC;MACH,CAAC,SAAS;QACR5C,cAAc,CAAClC,KAAK,GAAG,KAAI;MAC7B;IACF;IAEA,MAAM2L,aAAa,GAAG,MAAOhD,OAAO,IAAK;MACvC/D,WAAW,CAAC;QACVC,KAAK,EAAE,mBAAmB;QAC1BC,OAAO,EAAE,4CAA4C6D,OAAO,CAACnB,IAAI,kCAAkC;QACnGzC,MAAM,EAAE,SAAS;QACjBC,UAAU,EAAE,QAAQ;QACpBC,SAAS,EAAE,MAAAA,CAAA,KAAY;UACrB,IAAI;YACF,MAAM7F,GAAG,CAAC8L,MAAM,CAAC,mBAAmBvC,OAAO,CAACf,GAAG,EAAE;YAEjDtI,iBAAiB,CAACqG,eAAe,CAAC;cAChCC,IAAI,EAAE,SAAS;cACfd,OAAO,EAAE;YACX,CAAC;YAED4G,YAAY,CAAC;YACbnG,QAAQ,CAAC;UAEX,CAAC,CAAC,OAAOF,KAAK,EAAE;YACdD,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEA,KAAK;YAChD/F,iBAAiB,CAACqG,eAAe,CAAC;cAChCC,IAAI,EAAE,OAAO;cACbd,OAAO,EAAE,4BAA4B,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;YACzF,CAAC;YACD,MAAMO,KAAI;UACZ;QACF;MACF,CAAC;IACH;IAEA,MAAMwE,oBAAoB,GAAG,MAAOlB,OAAO,IAAK;MAC9CxG,aAAa,CAACnC,KAAK,GAAG2I,OAAM;MAC5B5H,uBAAuB,CAACf,KAAK,GAAG,IAAG;MACnC,IAAI;QACF,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAAC,mBAAmBkD,OAAO,CAACf,GAAG,YAAY;QACzEvF,gBAAgB,CAACrC,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAACkG,SAAQ;QAC/CxJ,yBAAyB,CAACpC,KAAK,GAAG,IAAG;MACvC,CAAC,CAAC,OAAOqF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,6BAA6B,EAAEA,KAAK;QAClD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACR/D,uBAAuB,CAACf,KAAK,GAAG,KAAI;MACtC;IACF;IAEA,MAAM6L,UAAU,GAAI5D,GAAG,IAAK;MAC1B;MACA,OAAOA,GAAG,CAAC6D,OAAO,IAAI7D,GAAG,CAACK,OAAO,IAAIL,GAAG,CAACI,UAAU,IAAIJ,GAAG,CAAC8D,WAAW,IAAI9D,GAAG,CAAC+D,aAAa,IAAI/D,GAAG,CAACgE,WAAW,IAAIhE,GAAG,CAACiE,WAAW,IAAIjE,GAAG,CAACkE,OAAO,IAAIlE,GAAG,CAACmE,OAAO,IAAInE,GAAG,CAACoE,SAAS,IAAI,IAAG;IACzL;IAEA,MAAMC,WAAW,GAAIrE,GAAG,IAAK;MAC3B,IAAI,CAACA,GAAG,EAAE,OAAO,KAAI;MACrB,IAAIA,GAAG,CAACgE,WAAW,IAAIhE,GAAG,CAACiE,WAAW,EAAE,OAAO,IAAG;MAClD,IAAI,OAAOjE,GAAG,CAACsE,SAAS,KAAK,WAAW,EAAE,OAAOC,OAAO,CAACvE,GAAG,CAACsE,SAAS;MACtE,IAAI,OAAOtE,GAAG,CAACwE,SAAS,KAAK,WAAW,EAAE,OAAOD,OAAO,CAACvE,GAAG,CAACwE,SAAS;MACtE,IAAIxE,GAAG,CAACyE,MAAM,EAAE;QACd,IAAI;UACF,OAAO/E,MAAM,CAACM,GAAG,CAACyE,MAAM,CAAC,CAACnF,WAAW,CAAC,CAAC,CAACQ,QAAQ,CAAC,KAAK;QACxD,CAAC,CAAC,OAAO5C,CAAC,EAAE;UACV;QAAA;MAEJ;MACA,OAAO,KAAI;IACb;IAEA,MAAMwH,sBAAsB,GAAG,MAAO1E,GAAG,IAAK;MAC5C,MAAMnI,EAAE,GAAGiL,UAAU,CAAC9C,GAAG,CAAC,IAAIA,GAAG,CAACwC,OAAO,IAAIxC,GAAG,CAAC2E,OAAO,IAAI3E,GAAG,CAAC4E,UAAU,IAAI5E,GAAG,CAACP,GAAE;MACpF,IAAI,CAAC5H,EAAE,EAAE;MACT,IAAI;QACF,MAAMV,GAAG,CAACiK,IAAI,CAAC,uBAAuB,EAAE;UAAEqB,QAAQ,EAAE,CAAC5K,EAAE;QAAE,CAAC;QAC1DR,iBAAiB,CAACqG,eAAe,CAAC;UAAEC,IAAI,EAAE,SAAS;UAAEd,OAAO,EAAE;QAAuB,CAAC;QACtF;QACA,MAAM+E,oBAAoB,CAAC1H,aAAa,CAACnC,KAAK;QAC9CuF,QAAQ,CAAC;MACX,CAAC,CAAC,OAAOF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,uCAAuC,EAAEA,KAAK;QAC5D/F,iBAAiB,CAACqG,eAAe,CAAC;UAAEC,IAAI,EAAE,OAAO;UAAEd,OAAO,EAAE;QAA8B,CAAC;MAC7F;IACF;IAEA,MAAMgI,4BAA4B,GAAI7E,GAAG,IAAK;MAC5C,MAAMwE,SAAS,GAAGH,WAAW,CAACrE,GAAG;MACjCrD,WAAW,CAAC;QACVC,KAAK,EAAE4H,SAAS,GAAG,iCAAiC,GAAG,kBAAkB;QACzE3H,OAAO,EAAE2H,SAAQ,GACb,uFAAsF,GACtF,0CAA0C;QAC9C1H,MAAM,EAAE,SAAS;QACjBC,UAAU,EAAE,QAAQ;QACpBC,SAAS,EAAE,MAAAA,CAAA,KAAY;UACrB,MAAM8H,qBAAqB,CAAC9E,GAAG;QACjC;MACF,CAAC;IACH;IAEA,MAAM8E,qBAAqB,GAAG,MAAO9E,GAAG,IAAK;MAC3C,MAAMnI,EAAE,GAAGiL,UAAU,CAAC9C,GAAG,CAAC,IAAIA,GAAG,CAACwC,OAAO,IAAIxC,GAAG,CAAC2E,OAAO,IAAI3E,GAAG,CAAC4E,UAAU,IAAI5E,GAAG,CAACP,GAAE;MACpF,IAAI,CAAC5H,EAAE,EAAE;MACT,IAAI;QACF;QACA,MAAMkN,KAAK,GAAGV,WAAW,CAACrE,GAAG;QAC7B,MAAMgF,GAAG,GAAG,iBAAiBnN,EAAE,EAAE,IAAIkN,KAAK,GAAG,aAAa,GAAG,EAAE;QAC/D,MAAM5N,GAAG,CAAC8L,MAAM,CAAC+B,GAAG;QACpB3N,iBAAiB,CAACqG,eAAe,CAAC;UAAEC,IAAI,EAAE,SAAS;UAAEd,OAAO,EAAE;QAAkB,CAAC;QACjF,MAAM+E,oBAAoB,CAAC1H,aAAa,CAACnC,KAAK;QAC9CuF,QAAQ,CAAC;MACX,CAAC,CAAC,OAAOF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,qCAAqC,EAAEA,KAAK;QAC1D/F,iBAAiB,CAACqG,eAAe,CAAC;UAAEC,IAAI,EAAE,OAAO;UAAEd,OAAO,EAAE;QAA4B,CAAC;MAC3F;IACF;IAEA,MAAMoI,eAAe,GAAGA,CAAA,KAAM;MAC5B,IAAIvM,cAAc,CAACX,KAAK,CAAC0G,MAAM,KAAKsB,iBAAiB,CAAChI,KAAK,CAAC0G,MAAM,IAAIsB,iBAAiB,CAAChI,KAAK,CAAC0G,MAAM,GAAG,CAAC,EAAE;QACxG/F,cAAc,CAACX,KAAK,GAAG,EAAC;MAC1B,CAAC,MAAM;QACLW,cAAc,CAACX,KAAK,GAAGgI,iBAAiB,CAAChI,KAAK,CAACwJ,GAAG,CAACsB,KAAK,IAAIC,UAAU,CAACD,KAAK,CAAC;MAC/E;IACF;IAEA,MAAMqC,YAAY,GAAG,MAAO1C,OAAO,IAAK;MACtC,IAAI;QACFjI,sBAAsB,CAACxC,KAAK,GAAG,IAAG;QAClCsC,qBAAqB,CAACtC,KAAK,GAAG,IAAG;QAEjC,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAAC,iBAAiBgF,OAAO,EAAE;QACzDlI,eAAe,CAACvC,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAACA,IAAG;QACzCjD,SAAS,CAACzC,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAACjD,SAAQ;MAC1C,CAAC,CAAC,OAAO4C,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEA,KAAK;QACjD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;QACDxC,qBAAqB,CAACtC,KAAK,GAAG,KAAI;MACpC,CAAC,SAAS;QACRwC,sBAAsB,CAACxC,KAAK,GAAG,KAAI;MACrC;IACF;IAEA,MAAMoN,gBAAgB,GAAG,MAAO3C,OAAO,IAAK;MAC1C,IAAI;QACF,MAAMjF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAAC,iBAAiBgF,OAAO,WAAW,EAAE;UAClE4C,YAAY,EAAE;QAChB,CAAC;;QAED;QACA,MAAMC,kBAAkB,GAAG9H,QAAQ,CAAC8D,OAAO,CAAC,qBAAqB,CAAC,IAAI9D,QAAQ,CAAC8D,OAAO,CAAC,qBAAqB;QAC5G,IAAIc,QAAQ,GAAGmD,kBAAkB,CAAChL,eAAe,CAACvC,KAAK,CAAC,IAAI,eAAc;QAC1E,IAAIsN,kBAAkB,EAAE;UACtB;UACA,MAAME,iBAAiB,GAAGF,kBAAkB,CAACG,KAAK,CAAC,mCAAmC;UACtF,IAAID,iBAAiB,IAAIA,iBAAiB,CAAC,CAAC,CAAC,EAAE;YAC7C,IAAI;cACF;cACA,MAAME,CAAC,GAAGF,iBAAiB,CAAC,CAAC,CAAC,CAACG,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,WAAW,EAAE,EAAE;cAC7DxD,QAAQ,GAAGyD,kBAAkB,CAACH,CAAC,CAACE,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;YACnD,CAAC,CAAC,OAAOzI,CAAC,EAAE;cACV;YAAA;UAEJ,CAAC,MAAM;YACL,MAAM2I,aAAa,GAAGR,kBAAkB,CAACG,KAAK,CAAC,uCAAuC;YACtF,IAAIK,aAAa,IAAIA,aAAa,CAAC,CAAC,CAAC,EAAE;cACrC1D,QAAQ,GAAG0D,aAAa,CAAC,CAAC;YAC5B;UACF;QACF;QACA;QACA,IAAI,CAAC1D,QAAQ,IAAIA,QAAQ,KAAK,GAAG,EAAE;UACjCA,QAAQ,GAAG2D,qBAAqB,CAACxL,eAAe,CAACvC,KAAK;QACxD;;QAEA;QACA,MAAMiN,GAAG,GAAGe,MAAM,CAACC,GAAG,CAACC,eAAe,CAAC,IAAIC,IAAI,CAAC,CAAC3I,QAAQ,CAACE,IAAI,CAAC,CAAC;QAChE,MAAM0I,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG;QACvCF,IAAI,CAACG,IAAI,GAAGtB,GAAE;QACdmB,IAAI,CAACI,YAAY,CAAC,UAAU,EAAEpE,QAAQ;QACtCiE,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,IAAI;QAC9BA,IAAI,CAACO,KAAK,CAAC;QACXP,IAAI,CAACQ,MAAM,CAAC;QACZZ,MAAM,CAACC,GAAG,CAACY,eAAe,CAAC5B,GAAG;QAE9B3N,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,CAAC,OAAOO,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEA,KAAK;QACzC/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH;IACF;IAEA,MAAM4G,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B/J,eAAe,CAAC3B,KAAK,GAAG,IAAG;MAC3B,IAAI;QACF,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAAC,iBAAiB;QAChD/D,QAAQ,CAAC1B,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAACA,IAAG;MACpC,CAAC,CAAC,OAAOL,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEA,KAAK;QACjD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACRnD,eAAe,CAAC3B,KAAK,GAAG,KAAI;MAC9B;IACF;IAEA,MAAM8O,aAAa,GAAG,MAAAA,CAAA,KAAY;MAChC9M,eAAe,CAAChC,KAAK,GAAG,IAAG;MAC3B,IAAI;QACF,MAAMZ,GAAG,CAACiK,IAAI,CAAC,iBAAiB,EAAE3G,UAAU,CAAC1C,KAAK;QAElD,IAAI8E,OAAO,GAAG,wBAAuB;QAErCxF,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAEA;QACX,CAAC;QAED/C,sBAAsB,CAAC/B,KAAK,GAAG,KAAI;QACnC0C,UAAU,CAAC1C,KAAK,GAAG;UAAE2C,IAAI,EAAE,EAAE;UAAEC,KAAK,EAAE,EAAE;UAAEC,QAAQ,EAAE,EAAE;UAAEC,KAAK,EAAE,EAAE;UAAEC,QAAQ,EAAE,EAAE;UAAEC,SAAS,EAAE,EAAE;UAAEC,MAAM,EAAE;QAAK;QAC7GyI,YAAY,CAAC;QACbnG,QAAQ,CAAC;MAEX,CAAC,CAAC,OAAOF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEA,KAAK;QAChD/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE,4BAA4B,IAAIO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAIO,KAAK,CAACP,OAAO;QACzF,CAAC;MACH,CAAC,SAAS;QACR9C,eAAe,CAAChC,KAAK,GAAG,KAAI;MAC9B;IACF;;IAEA;IACA,MAAM+O,cAAc,GAAIC,KAAK,IAAK;MAChC,IAAIA,KAAK,KAAK,CAAC,EAAE,OAAO,SAAQ;MAChC,IAAIA,KAAK,IAAI,IAAI,IAAIC,KAAK,CAACC,MAAM,CAACF,KAAK,CAAC,CAAC,EAAE,OAAO,GAAE;MACpD,MAAMG,CAAC,GAAGD,MAAM,CAACF,KAAK;MACtB,MAAMI,CAAC,GAAG,IAAG;MACb,MAAMC,KAAK,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;MACxC,MAAMC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,GAAG,CAACN,CAAC,CAAC,GAAGI,IAAI,CAACE,GAAG,CAACL,CAAC,CAAC;MAC9C,MAAMM,GAAG,GAAGH,IAAI,CAACI,GAAG,CAACJ,IAAI,CAACK,GAAG,CAACN,CAAC,EAAE,CAAC,CAAC,EAAED,KAAK,CAAC3I,MAAM,GAAG,CAAC;MACrD,OAAOmJ,UAAU,CAAC,CAACV,CAAC,GAAGI,IAAI,CAACO,GAAG,CAACV,CAAC,EAAEM,GAAG,CAAC,EAAEK,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGV,KAAK,CAACK,GAAG;IACxE;;IAEA;;IAEA,MAAMM,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI,CAACtQ,YAAY,CAACM,KAAK,EAAE;MAEzBmD,aAAa,CAACnD,KAAK,GAAG,IAAG;MACzB,IAAI;QACF,MAAMwF,QAAQ,GAAG,MAAMpG,GAAG,CAACqG,GAAG,CAAC,eAAe;QAC9CvC,MAAM,CAAClD,KAAK,GAAGwF,QAAQ,CAACE,IAAI,CAACxC,MAAK;MACpC,CAAC,CAAC,OAAOmC,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEA,KAAK;QAC/C/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACR3B,aAAa,CAACnD,KAAK,GAAG,KAAI;MAC5B;IACF;IAEA,MAAMiQ,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAI,CAACvM,QAAQ,CAAC1D,KAAK,CAAC2D,QAAQ,IAAI,CAACD,QAAQ,CAAC1D,KAAK,CAAC4C,KAAK,IAAI,CAACc,QAAQ,CAAC1D,KAAK,CAAC+C,QAAQ,EAAE;QACjFzD,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;QACD;MACF;MAEAzB,aAAa,CAACrD,KAAK,GAAG,IAAG;MACzB,IAAI;QACF,MAAMZ,GAAG,CAACiK,IAAI,CAAC,eAAe,EAAE3F,QAAQ,CAAC1D,KAAK;QAE9CV,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;QAED1B,oBAAoB,CAACpD,KAAK,GAAG,KAAI;QACjC0D,QAAQ,CAAC1D,KAAK,GAAG;UAAE2D,QAAQ,EAAE,EAAE;UAAEf,KAAK,EAAE,EAAE;UAAEG,QAAQ,EAAE;QAAG;QAEzD,MAAMiN,UAAU,CAAC;MACnB,CAAC,CAAC,OAAO3K,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK;QAC9C/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAEO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAI;QAC5C,CAAC;MACH,CAAC,SAAS;QACRzB,aAAa,CAACrD,KAAK,GAAG,KAAI;MAC5B;IACF;IAEA,MAAMkQ,4BAA4B,GAAIC,KAAK,IAAK;MAC9C3M,WAAW,CAACxD,KAAK,GAAGmQ,KAAI;MACxB1M,gBAAgB,CAACzD,KAAK,GAAG,EAAC;MAC1BsD,4BAA4B,CAACtD,KAAK,GAAG,IAAG;IAC1C;IAEA,MAAMoQ,mBAAmB,GAAG,MAAAA,CAAA,KAAY;MACtC,IAAI,CAAC3M,gBAAgB,CAACzD,KAAK,IAAIyD,gBAAgB,CAACzD,KAAK,CAAC0G,MAAM,GAAG,CAAC,EAAE;QAChEpH,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;QACD;MACF;MAEAvB,gBAAgB,CAACvD,KAAK,GAAG,IAAG;MAC5B,IAAI;QACF,MAAMZ,GAAG,CAACqM,GAAG,CAAC,iBAAiBjI,WAAW,CAACxD,KAAK,CAAC0H,GAAG,WAAW,EAAE;UAC/D3E,QAAQ,EAAEU,gBAAgB,CAACzD;QAC7B,CAAC;QAEDV,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;QAEDxB,4BAA4B,CAACtD,KAAK,GAAG,KAAI;QACzCyD,gBAAgB,CAACzD,KAAK,GAAG,EAAC;QAC1BwD,WAAW,CAACxD,KAAK,GAAG,IAAG;MACzB,CAAC,CAAC,OAAOqF,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,sBAAsB,EAAEA,KAAK;QAC3C/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAE;QACX,CAAC;MACH,CAAC,SAAS;QACRvB,gBAAgB,CAACvD,KAAK,GAAG,KAAI;MAC/B;IACF;IAEA,MAAMqQ,kBAAkB,GAAIF,KAAK,IAAK;MACpCvL,WAAW,CAAC;QACVC,KAAK,EAAE,wBAAwB;QAC/BC,OAAO,EAAE,kDAAkDqL,KAAK,CAACxM,QAAQ,IAAI;QAC7E2M,WAAW,EAAE,SAAS;QACtBrL,SAAS,EAAEA,CAAA,KAAMsL,WAAW,CAACJ,KAAK;MACpC,CAAC;IACH;IAEA,MAAMI,WAAW,GAAG,MAAOJ,KAAK,IAAK;MACnC,IAAI;QACF,MAAM/Q,GAAG,CAAC8L,MAAM,CAAC,iBAAiBiF,KAAK,CAACzI,GAAG,EAAE;QAE7CpI,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,SAAS;UACfd,OAAO,EAAE;QACX,CAAC;QAED,MAAMkL,UAAU,CAAC;MACnB,CAAC,CAAC,OAAO3K,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK;QAC9C/F,iBAAiB,CAACqG,eAAe,CAAC;UAChCC,IAAI,EAAE,OAAO;UACbd,OAAO,EAAEO,KAAK,CAACG,QAAQ,EAAEE,IAAI,EAAEZ,OAAO,IAAI;QAC5C,CAAC;MACH;IACF;;IAEA;;IAEA,MAAM0L,aAAa,GAAIxQ,KAAK,IAAK;MAC/B,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,KAAK,EAAE,EAAE,OAAO,IAAG;MAC7C;MACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;QAC7B;QACA,OAAOA,KAAK,GAAG,IAAI,GAAGA,KAAK,GAAG,IAAI,GAAGA,KAAI;MAC3C;MACA;MACA,IAAI,OAAO,CAACyQ,IAAI,CAAC9I,MAAM,CAAC3H,KAAK,CAAC,CAAC,EAAE;QAC/B,MAAM0Q,CAAC,GAAGC,QAAQ,CAAC3Q,KAAK,EAAE,EAAE;QAC5B,OAAO0Q,CAAC,GAAG,IAAI,GAAGA,CAAC,GAAG,IAAI,GAAGA,CAAA;MAC/B;MACA;MACA,IAAI,OAAO1Q,KAAK,KAAK,QAAQ,IAAI,gDAAgD,CAACyQ,IAAI,CAACzQ,KAAK,CAAC,EAAE;QAC7F;QACA,MAAM4Q,GAAG,GAAG5Q,KAAK,CAAC4N,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,GAAG,GAAE;QAC5D,MAAMiD,SAAS,GAAG1J,IAAI,CAAC2J,KAAK,CAACF,GAAG;QAChC,OAAO3B,KAAK,CAAC4B,SAAS,CAAC,GAAG,IAAI,GAAGA,SAAQ;MAC3C;MACA;MACA,MAAME,MAAM,GAAG5J,IAAI,CAAC2J,KAAK,CAAC9Q,KAAK;MAC/B,OAAOiP,KAAK,CAAC8B,MAAM,CAAC,GAAG,IAAI,GAAGA,MAAK;IACrC;IAEA,MAAMC,UAAU,GAAIC,IAAI,IAAK;MAC3B,MAAMC,EAAE,GAAGV,aAAa,CAACS,IAAI;MAC7B,IAAI,CAACC,EAAE,EAAE,OAAO,EAAC;MACjB,OAAO,IAAI/J,IAAI,CAAC+J,EAAE,CAAC,CAACC,kBAAkB,CAAC,OAAO,EAAE;QAAEC,QAAQ,EAAE;MAAgB,CAAC;IAC/E;IAEA,MAAMC,cAAc,GAAIJ,IAAI,IAAK;MAC/B,MAAMC,EAAE,GAAGV,aAAa,CAACS,IAAI;MAC7B,IAAI,CAACC,EAAE,EAAE,OAAO,EAAC;MACjB,OAAO,IAAI/J,IAAI,CAAC+J,EAAE,CAAC,CAACI,cAAc,CAAC,OAAO,EAAE;QAC1CF,QAAQ,EAAE,eAAe;QACzBG,IAAI,EAAE,SAAS;QACfC,KAAK,EAAE,SAAS;QAChBC,GAAG,EAAE,SAAS;QACdC,IAAI,EAAE,SAAS;QACfC,MAAM,EAAE;MACV,CAAC;IACH;IAEA,MAAMC,YAAY,GAAGA,CAACC,QAAQ,EAAEC,MAAM,KAAK;MACzC,IAAI,CAACD,QAAQ,IAAI,CAACC,MAAM,EAAE,OAAO,GAAE;MACnC,MAAM7L,IAAI,GAAG,IAAIkB,IAAI,CAAC0K,QAAQ,CAAC,CAACV,kBAAkB,CAAC,OAAO;MAC1D,MAAMY,EAAE,GAAG,IAAI5K,IAAI,CAAC2K,MAAM,CAAC,CAACX,kBAAkB,CAAC,OAAO;MACtD,OAAO,GAAGlL,IAAI,MAAM8L,EAAE,EAAC;IACzB;;IAEA;IACA,MAAMC,cAAc,GAAIC,MAAM,IAAK;MACjC,IAAIA,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAKC,SAAS,EAAE,OAAO,GAAE;MACtD,OAAO,IAAIC,IAAI,CAACC,YAAY,CAAC,OAAO,EAAE;QAAEC,qBAAqB,EAAE,CAAC;QAAEC,qBAAqB,EAAE;MAAE,CAAC,CAAC,CAACC,MAAM,CAACN,MAAM;IAC7G;;IAEA;IACA,MAAMlH,UAAU,GAAID,KAAK,IAAK;MAC5B,IAAI,CAACA,KAAK,EAAE,OAAO,IAAG;MACtB,OAAOA,KAAK,CAAClD,GAAG,IAAIkD,KAAK,CAACpD,GAAG,IAAIoD,KAAK,CAAChL,EAAE,IAAIgL,KAAK,CAAC8B,OAAO,IAAI,IAAG;IACnE;;IAEA;IACA,MAAMW,kBAAkB,GAAItF,GAAG,IAAK;MAClC,IAAI,CAACA,GAAG,EAAE,OAAO,GAAE;MACnB,MAAMtF,IAAI,GAAGsF,GAAG,CAACO,QAAQ,IAAIP,GAAG,CAACuK,QAAQ,IAAIvK,GAAG,CAACQ,YAAY,IAAIR,GAAG,CAACwK,YAAY,IAAIxK,GAAG,CAACmC,QAAQ,IAAInC,GAAG,CAACyK,gBAAe;MACxH,IAAI/P,IAAI,IAAIgF,MAAM,CAAChF,IAAI,CAAC,CAACgL,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE,OAAOhL,IAAG;MAClD,OAAOoL,qBAAqB,CAAC9F,GAAG;IAClC;;IAEA;IACA,MAAM8F,qBAAqB,GAAI9F,GAAG,IAAK;MACrC,IAAI,CAACA,GAAG,EAAE,OAAO,eAAc;MAC/B,MAAM0K,KAAK,GAAG,EAAC;MACf,MAAM/M,IAAI,GAAGqC,GAAG,CAACrC,IAAI,IAAIqC,GAAG,CAAC2K,IAAI,IAAI,EAAC;MACtC,MAAMjK,OAAO,GAAGV,GAAG,CAAC4K,WAAW,IAAI5K,GAAG,CAACoC,WAAW,IAAIpC,GAAG,CAACT,IAAI,IAAIS,GAAG,CAACtF,IAAI,IAAI,EAAC;MAC/E,MAAM+E,GAAG,GAAGO,GAAG,CAACP,GAAG,IAAIO,GAAG,CAACL,GAAG,IAAIK,GAAG,CAACnI,EAAE,IAAI,EAAC;MAE7C,IAAI8F,IAAI,EAAE+M,KAAK,CAAC1S,IAAI,CAAC0H,MAAM,CAAC/B,IAAI,CAAC;MACjC,IAAI+C,OAAO,EAAEgK,KAAK,CAAC1S,IAAI,CAAC0H,MAAM,CAACgB,OAAO,CAAC;MACvC,IAAIjB,GAAG,EAAEiL,KAAK,CAAC1S,IAAI,CAAC,IAAIyH,GAAG,EAAE;;MAE7B;MACA,MAAMzB,IAAI,GAAGgC,GAAG,CAACkE,OAAO,IAAIlE,GAAG,CAACmE,OAAO,IAAInE,GAAG,CAAC6K,UAAU,IAAI,IAAG;MAChE,MAAMf,EAAE,GAAG9J,GAAG,CAAC8K,OAAO,IAAI9K,GAAG,CAAC+K,OAAO,IAAI/K,GAAG,CAACgL,UAAU,IAAI,IAAG;MAC9D,IAAIhN,IAAI,IAAI8L,EAAE,EAAE;QACd,MAAM/H,CAAC,GAAGwG,aAAa,CAACvK,IAAI;QAC5B,MAAMiN,CAAC,GAAG1C,aAAa,CAACuB,EAAE;QAC1B,IAAI/H,CAAC,IAAIkJ,CAAC,EAAE;UACV,MAAMC,EAAE,GAAG,IAAIhM,IAAI,CAAC6C,CAAC;UACrB,MAAMoJ,EAAE,GAAG,IAAIjM,IAAI,CAAC+L,CAAC;UACrB,MAAMG,EAAE,GAAG,GAAGF,EAAE,CAACG,WAAW,CAAC,CAAC,GAAG3L,MAAM,CAACwL,EAAE,CAAC/L,QAAQ,CAAC,CAAC,GAAC,CAAC,CAAC,CAACmM,QAAQ,CAAC,CAAC,EAAC,GAAG,CAAC,EAAC;UACzE,MAAMC,EAAE,GAAG,GAAGJ,EAAE,CAACE,WAAW,CAAC,CAAC,GAAG3L,MAAM,CAACyL,EAAE,CAAChM,QAAQ,CAAC,CAAC,GAAC,CAAC,CAAC,CAACmM,QAAQ,CAAC,CAAC,EAAC,GAAG,CAAC,EAAC;UACzEZ,KAAK,CAAC1S,IAAI,CAAC,GAAGoT,EAAE,IAAIG,EAAE,EAAE;QAC1B;MACF;MAEA,IAAIpJ,QAAQ,GAAGuI,KAAK,CAACc,IAAI,CAAC,KAAK;MAC/B,IAAI,CAACrJ,QAAQ,EAAEA,QAAQ,GAAG,WAAW1C,GAAG,GAAG,IAAIA,GAAG,EAAE,GAAG,EAAE,EAAC;MAC1D;MACA0C,QAAQ,GAAGA,QAAQ,CAACwD,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC,CAACD,IAAI,CAAC;MACtD;MACA,IAAI,CAAC,eAAe,CAAC8C,IAAI,CAACrG,QAAQ,CAAC,EAAEA,QAAQ,IAAI,OAAM;MACvD,OAAOA,QAAO;IAChB;IAEA,MAAMsJ,cAAc,GAAIC,MAAM,IAAK;MACjC,MAAMC,MAAM,GAAG;QACbC,QAAQ,EAAE,UAAU;QACpBpH,SAAS,EAAE,aAAa;QACxBpH,KAAK,EAAE;MACT;MACA,OAAOuO,MAAM,CAACD,MAAM,CAAC,IAAIA,MAAK;IAChC;;IAEA;IACA,MAAMG,eAAe,GAAGA,CAAA,KAAM;MAC5B,IAAIrU,SAAS,CAACO,KAAK,KAAK,WAAW,EAAE;QACnCsB,gBAAgB,CAAC;MACnB,CAAC,MAAM,IAAI7B,SAAS,CAACO,KAAK,KAAK,UAAU,EAAE;QACzC0L,YAAY,CAAC;MACf,CAAC,MAAM,IAAIjM,SAAS,CAACO,KAAK,KAAK,QAAQ,IAAIN,YAAY,CAACM,KAAK,EAAE;QAC7DgQ,UAAU,CAAC;MACb;IACF;;IAEA;IACApR,SAAS,CAAC,MAAM;MACd2G,QAAQ,CAAC;MACTuO,eAAe,CAAC;MAChB;MACA,KAAK9B,cAAc,CAAC,CAAC;IACvB,CAAC;;IAED;IACAlT,KAAK,CAACW,SAAS,EAAEqU,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}