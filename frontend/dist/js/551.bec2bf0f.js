"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[551],{7551:function(e,a,s){s.r(a),s.d(a,{default:function(){return A}});s(4114);var l=s(6768),o=s(5130),t=s(4232),r=s(144),n=s(1387),i=s(1675),u=s(14),d=s(3966);const p={class:"login-page"},c={class:"container"},v={class:"login-card"},k={class:"role-selector"},g={class:"input-group"},m=["placeholder"],h={key:0,class:"error-text"},w={class:"input-group"},b={class:"password-field"},y=["type"],L={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},f={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},C={key:0,class:"error-text"},x=["disabled"],E={key:0,class:"loader"},_={key:0,class:"forgot-link"};var X={__name:"LoginPage",setup(e){const a=(0,n.rd)(),s=(0,u.n)(),X=(0,d.i)(),R=(0,r.KR)(!1),K=(0,r.KR)(!1),A=(0,r.KR)("partner"),M=(0,r.Kh)({login:"",password:""}),Q=(0,r.KR)({}),F=()=>{Q.value={};const e=M.login.trim(),a=M.password.trim();return e||(Q.value.login="admin"===A.value?"Имя пользователя обязательно":"Логин или email обязателен"),a||(Q.value.password="Пароль обязателен"),0===Object.keys(Q.value).length},O=async()=>{if(F()){R.value=!0;try{const e="admin"===A.value?"/auth/admin/login":"/auth/login",l="admin"===A.value?{username:M.login.trim(),password:M.password.trim()}:{login:M.login.trim(),password:M.password.trim()};await s.login(e,l),"admin"===s.user.role?a.push("/admin"):a.push("/dashboard"),X.addNotification({type:"success",message:"Успешный вход в систему!"})}catch(e){console.error("Ошибка входа:",e);let a="Ошибка входа в систему";401===e.response?.status?a="Неверные учетные данные":403===e.response?.status?a=e.response.data?.message||"Доступ запрещен":429===e.response?.status?a=e.response.data?.message||"Слишком много попыток входа":e.response?.data?.message&&(a=e.response.data.message),X.addNotification({type:"error",message:a})}finally{R.value=!1}}};return(e,a)=>{const s=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("div",c,[(0,l.Lk)("div",v,[a[8]||(a[8]=(0,l.Lk)("div",{class:"brand"},[(0,l.Lk)("h1",null,"FREEDOM GROUP"),(0,l.Lk)("p",null,"Партнерская система")],-1)),(0,l.Lk)("form",{onSubmit:(0,o.D$)(O,["prevent"]),class:"login-form"},[(0,l.Lk)("div",k,[(0,l.Lk)("button",{type:"button",onClick:a[0]||(a[0]=e=>A.value="partner"),class:(0,t.C4)(["role-option",{active:"partner"===A.value}])}," Партнер ",2),(0,l.Lk)("button",{type:"button",onClick:a[1]||(a[1]=e=>A.value="admin"),class:(0,t.C4)(["role-option",{active:"admin"===A.value}])}," Администратор ",2)]),(0,l.Lk)("div",g,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>M.login=e),type:"text",required:"",placeholder:"admin"===A.value?"Имя пользователя":"Логин или email",class:(0,t.C4)([{error:Q.value.login},"input-field"])},null,10,m),[[o.Jo,M.login]]),Q.value.login?((0,l.uX)(),(0,l.CE)("div",h,(0,t.v_)(Q.value.login),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",w,[(0,l.Lk)("div",b,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>M.password=e),type:K.value?"text":"password",required:"",placeholder:"Пароль",class:(0,t.C4)([{error:Q.value.password},"input-field"])},null,10,y),[[o.hp,M.password]]),(0,l.Lk)("button",{type:"button",onClick:a[4]||(a[4]=e=>K.value=!K.value),class:"password-toggle"},[K.value?((0,l.uX)(),(0,l.CE)("svg",L,[...a[5]||(a[5]=[(0,l.Lk)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),(0,l.Lk)("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):((0,l.uX)(),(0,l.CE)("svg",f,[...a[6]||(a[6]=[(0,l.Lk)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),(0,l.Lk)("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])]),Q.value.password?((0,l.uX)(),(0,l.CE)("div",C,(0,t.v_)(Q.value.password),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("button",{type:"submit",disabled:R.value,class:"login-btn"},[R.value?((0,l.uX)(),(0,l.CE)("span",E)):(0,l.Q3)("",!0),(0,l.eW)(" "+(0,t.v_)(R.value?"Вход...":"Войти"),1)],8,x),"partner"===A.value?((0,l.uX)(),(0,l.CE)("div",_,[(0,l.bF)(s,{to:"/forgot-password"},{default:(0,l.k6)((()=>[...a[7]||(a[7]=[(0,l.eW)("Забыли пароль?",-1)])])),_:1})])):(0,l.Q3)("",!0)],32)])]),(0,l.bF)(i.A)])}}},R=s(1241);const K=(0,R.A)(X,[["__scopeId","data-v-56f2aab9"]]);var A=K}}]);
//# sourceMappingURL=551.bec2bf0f.js.map